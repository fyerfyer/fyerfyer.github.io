<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"fyerfyer.github.io.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":2,"unescape":true,"preload":false}}</script><script src="/js/config.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">


    <meta name="description" content="fyerfyer&apos;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="fyerfyer">
<meta property="og:url" content="https://fyerfyer.github.io.com/page/7/index.html">
<meta property="og:site_name" content="fyerfyer">
<meta property="og:description" content="fyerfyer&apos;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="fyerfyer">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://fyerfyer.github.io.com/page/7/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/7/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>fyerfyer</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="&#x5207;&#x6362;&#x5BFC;&#x822A;&#x680F;" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">fyerfyer</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Hello! Nice to meet you!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="&#x641C;&#x7D22;" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>&#x9996;&#x9875;</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>&#x5173;&#x4E8E;</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>&#x5206;&#x7C7B;</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>&#x5F52;&#x6863;</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>&#x641C;&#x7D22;
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="&#x641C;&#x7D22;..." spellcheck="false" type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          &#x6587;&#x7AE0;&#x76EE;&#x5F55;
        </li>
        <li class="sidebar-nav-overview">
          &#x7AD9;&#x70B9;&#x6982;&#x89C8;
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fyerfyer" src="/images/head.png">
  <p class="site-author-name" itemprop="name">fyerfyer</p>
  <div class="site-description" itemprop="description">fyerfyer&apos;s blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">109</span>
          <span class="site-state-item-name">&#x65E5;&#x5FD7;</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">&#x5206;&#x7C7B;</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/fyerfyer" title="GitHub &#x2192; https://github.com/fyerfyer" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/fuy60703@gmail.com" title="E-Mail &#x2192; fuy60703@gmail.com" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="&#x8FD4;&#x56DE;&#x9876;&#x90E8;">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/" class="post-title-link" itemprop="url">10.7.&#x5BF9;&#x5BF9;&#x8C61;&#x7684;&#x5904;&#x7406;&#x2014;&#x2014;&#x64CD;&#x7EB5;&#x5BF9;&#x8C61;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-26 20:15:43" itemprop="dateCreated datePublished" datetime="2024-04-26T20:15:43+08:00">2024-04-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:58:26" itemprop="dateModified" datetime="2024-06-03T15:58:26+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-10-Code-Generator/" itemprop="url" rel="index"><span itemprop="name">Module 10.Code Generator</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>489</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="107handling-objects-manipulation"><span class="math inline">\(10.7.\)</span>Handling Objects: Manipulation</span></h1>
<h3><span id="1compiling-method-calls">1.Compiling method calls</span></h3>
<ul>
<li>In compiler, we are going to translate the OO method calls into
<strong>procedural style language</strong> like VM language or machine
language, they don&apos;t understand what an object is.</li>
</ul>
<p>&#x2003;&#x2003;In order to do this:</p>
<ul>
<li>We can <strong>treat the object as the first, implicit
argument</strong>. We push it onto the stack, because we want it to
<strong>be the first argument on which the method is going to
operate</strong>.</li>
</ul>
<p><img src="/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/image-5.png"></p>
<ol type="1">
<li>We <code>push</code> the object into the stack.</li>
<li>We <code>push</code> enough arguments into the stack.</li>
<li>We <code>call</code> the method.</li>
</ol>
<p>&#x2003;&#x2003;When we say &quot;put the object onto the stack&quot;, we don&apos;t care what the
object is, we are only interested in its <em>base address</em>.</p>
<h3><span id="2compiling-methods">2.Compiling methods</span></h3>
<p>&#x2003;&#x2003;Methods are used to operate on the object which refers to as
<code>THIS</code>. Therefore, each method&apos;s code needs to <strong>access
to the object&apos;s <code>field</code> variables</strong>.</p>
<p>&#x2003;&#x2003;In the previous unit, we know that we can access the <span class="math inline">\(ith\)</span> <code>field</code> by
<code>THIS i</code>. However, before we use <code>THIS</code>, we have
to anchor it on the proper address on the RAM first, so we also need
<code>pointer</code>.</p>
<p><img src="/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/image-6.png"></p>
<p>&#x2003;&#x2003;Let&apos;s take the <code>distance</code> method as an example:</p>
<ol type="1">
<li>The method is compiled within a class, so we will <strong>compile
the class variables</strong>, namely <code>x, y, pointCount</code>. This
will end up generating no code.</li>
<li>Both the method declaration and variable declaration generate no
code, either. Instead, the compiler <strong>creates the symbol table of
the subroutine</strong> and <strong>populates it within the
<code>this</code> object as well as the explicit variables that is found
in the parameter list and the variable declaration.</strong></li>
<li>We can anticipate that the method will want to operate on the
current object, so we need to generate code that will <strong>anchor
this on the correct address in memory</strong>. And we know that the
current object address is <code>argument 0</code>, so we do
<code>push argument 0</code> and <code>pop pointer 0</code> to let
<code>THIS</code> pointer to contain the address of the current
object.</li>
</ol>
<p>&#x2003;&#x2003;When the <code>distance</code> method completes execution and
terminates, control will return to the caller. The compiled code of the
caller is as below:</p>
<p><img src="/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/image-7.png"></p>
<ul>
<li>We know that the method returns a value on the top of stack, so we
remove it and put it into <code>d</code>.</li>
</ul>
<h3><span id="3void-methodcompilation">3.<code>void</code> method
compilation</span></h3>
<p><img src="/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/image-8.png"></p>
<p>&#x2003;&#x2003;The <code>void</code> doesn&apos;t expect to get a return value, while
according to the rules of the game, we must return a value. As a result,
we:</p>
<ol type="1">
<li>To obey the rule, we <strong>generate code at the end of each method
that returns a value</strong>.</li>
<li>Since we have nothing to return, we <code>push constant 0</code>,
which is a dummy value and then <code>return</code>.</li>
</ol>
<p>&#x2003;&#x2003;But now the compiled code faces a slight problem: the stack
contains uncessary value and we want to get rid of it.</p>
<ol start="3" type="1">
<li>To do this, we simply <code>pop temp 0</code>.</li>
</ol>
<p><img src="/2024/04/26/10-7-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%93%8D%E7%BA%B5%E5%AF%B9%E8%B1%A1/image-9.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/" class="post-title-link" itemprop="url">10.6.&#x5BF9;&#x5BF9;&#x8C61;&#x7684;&#x5904;&#x7406;&#x2014;&#x2014;&#x6784;&#x9020;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-25 20:15:43" itemprop="dateCreated datePublished" datetime="2024-04-25T20:15:43+08:00">2024-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:56:21" itemprop="dateModified" datetime="2024-06-03T15:56:21+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-10-Code-Generator/" itemprop="url" rel="index"><span itemprop="name">Module 10.Code Generator</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>664</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="106handling-objects-construction"><span class="math inline">\(10.6.\)</span>Handling Objects: Construction</span></h1>
<p><img src="/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/image.png"></p>
<ul>
<li>What we have here is two completely separate compilation units. We
are facing the challenge of compiling the caller class and the callee
class.</li>
</ul>
<h3><span id="1high-level-of-objectconstruction">1.High level of object
construction</span></h3>
<ul>
<li>When we do <code>var Point p1</code>, the compiler will end up
generating code on <strong>some location in the stack which is going to
be initialized to 0</strong>.</li>
<li>When we call the constructor, the compiled code will end up
<strong>creating the object proper on the heap</strong>.</li>
<li>The two class running together will end up <strong>taking the base
address of the newly created object</strong> and <strong>storing it in
what we assign previously the p1 variable</strong>.</li>
</ul>
<h3><span id="2the-callerss-side">2.The callers&apos;s side</span></h3>
<p><img src="/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/image-1.png"></p>
<ul>
<li><p>Whenever the compiler encounters a variable declaration, it
<strong>generates no code whatsover</strong>. The only thing the
compiler does is it <strong>update the relevant symbol table</strong>.
Because we are now compiling code that resides in a certain subroutine,
we will end up <strong>updating the symbol table of the
subroutine</strong>.</p></li>
<li><p><code>Point.new(2, 3)</code> is a call to some subroutine, so we
handle it just like other subroutine. We push the two arguments and
<code>call Point.new</code></p></li>
<li><p>The calling code assumes that when the constructor will execute,
it will end up <strong>allocating some space on the RAM</strong> for the
newly constructed object. It will also take the base address of this
space on the RAM and <strong>return it to the caller</strong>.</p></li>
<li><p>So we <strong><code>pop</code> the topmost value of the stack
into <code>p1</code></strong>, because we want <code>p1</code> to point
at the base address of this object.</p></li>
</ul>
<h3><span id="3resulting-impact">3.Resulting impact</span></h3>
<p><img src="/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/image-2.png"></p>
<ul>
<li>Only when we call the constructors will we actually create the
objects on RAM.</li>
<li>Object construction is a <strong>two-stage affair that happens both
during compile time and run time</strong>.</li>
</ul>
<h3><span id="4the-big-picture-ofconstructors">4.The big picture of
constructors</span></h3>
<p><img src="/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/image-3.png"></p>
<p>&#x2003;&#x2003;A constructor is typically designed to do at least two things:</p>
<ol type="1">
<li><strong>Arrange some place</strong> on RAM for the new object.</li>
<li><strong>Assign certain values</strong> to the fields of the newly
constructed object.</li>
</ol>
<p>&#x2003;&#x2003;To do this, the constructor must have access to the object&apos;s
fields:</p>
<ul>
<li>We can <strong>manipulate <code>THIS</code> segment</strong> to
manipulate the object that the constructor juct created.</li>
<li>To access <code>THIS</code> segment, we first <strong>anchor it
properly on the right address in the RAM</strong> using
<code>pointer</code> segment.</li>
</ul>
<h3><span id="5compiling-constuctor">5.Compiling constuctor</span></h3>
<ol type="1">
<li>The first thing we meet is the constructor signature. The compiler
will generate no code whatsover. The only thing it will do is <strong>it
will create the subroutine symbol table</strong> and <strong>record in
it two variables <code>ax</code> and <code>ay</code> which are both
arguments </strong></li>
</ol>
<p>&#x2003;&#x2003;Then comes the question: how much space is needed?</p>
<ol start="2" type="1">
<li>The compiler can <strong>consult the class level symbol
table</strong> and realize that objects of the point class requires two
words only, <code>x</code> and <code>y</code>.</li>
</ol>
<p>&#x2003;&#x2003;Then how do we find such a free memory block on RAM?</p>
<ol start="3" type="1">
<li><p>The <em>operating system</em> supplies a function called
<code>alloc</code>, if you provide <code>alloc(x)</code> with a certain
argument, it will <strong>find a memory block on the RAM</strong> and
<strong>return the base address of it.</strong> The memory block has two
important properties:</p>
<ol type="1">
<li>It&apos;s <code>x</code> words long.</li>
<li>It&apos;s free, no one needs it now, so the constructor can safely use
it.</li>
</ol></li>
</ol>
<p><img src="/2024/04/25/10-6-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E6%9E%84%E9%80%A0/image-4.png"></p>
<ol type="1">
<li>We <code>push 2</code>, because we <strong>need 2 words to store the
arguments</strong>.</li>
<li>We want to push <code>THIS</code> into the stack, we need 1 word, so
we <code>call Memory.alloc 1</code>.</li>
<li>As usual, we anchor <code>THIS</code> at the base address:
<code>pop pointer 0</code>.</li>
</ol>
<blockquote>
<p>If we do <code>pop pointer 0</code>, we are going to align the
virtual segment ot the object we currently constructed on the RAM. We do
this because I know that with very high likelihood the next commands in
the constructor will want to access the fields of the newly created
object.</p>
</blockquote>
<ol start="4" type="1">
<li>Since <code>THIS</code> is anchored on the right endness, to
<code>return</code>, we simply do <code>push pointer 0</code>. And when
the caller of constructor do <code>pop pointer 0</code>, it can
successfully get the address of the newly created object.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/22/10-5-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E5%BA%95%E5%B1%82%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/22/10-5-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E5%BA%95%E5%B1%82%E7%89%B9%E6%80%A7/" class="post-title-link" itemprop="url">10.5.&#x5BF9;&#x5BF9;&#x8C61;&#x7684;&#x5904;&#x7406;&#x2014;&#x2014;&#x5E95;&#x5C42;&#x7279;&#x6027;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-22 20:15:43" itemprop="dateCreated datePublished" datetime="2024-04-22T20:15:43+08:00">2024-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:52:40" itemprop="dateModified" datetime="2024-06-03T15:52:40+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-10-Code-Generator/" itemprop="url" rel="index"><span itemprop="name">Module 10.Code Generator</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>401</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="105handling-objects-low-levelaspects"><span class="math inline">\(10.5.\)</span>Handling Objects: Low-level
Aspects</span></h1>
<p><img src="/2024/04/22/10-5-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E5%BA%95%E5%B1%82%E7%89%B9%E6%80%A7/image.png"></p>
<h3><span id="1handling-objects">1.Handling objects</span></h3>
<p>&#x2003;&#x2003;Let&apos;s review how we handle <code>local</code> and
<code>argument</code> first:</p>
<p><img src="/2024/04/22/10-5-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E5%BA%95%E5%B1%82%E7%89%B9%E6%80%A7/image-1.png"></p>
<ul>
<li><p>The first five words in the RAM are used as <strong>pointer that
hold the current value of the stack pointer, namely the base address of
the <code>local</code>, <code>argument</code>, <code>this</code>,
<code>that</code></strong>.</p></li>
<li><p>The VM implementation also allocates a certain area on RAM to
hold the global stack which <strong>keeps the working stack of the
currentlt running VM functions</strong> and all the working stack and
memory segments of the functions that wait to for the current function
to terminate, namely the functions which <strong>are on the calling
chain</strong>.</p></li>
<li><p>The VM implementation recalls the location of these segments of
the stack by <strong>using the two pointers <code>LCL</code> and
<code>ARG</code></strong>. It records the base address of this segment
in the <code>LCL</code>.</p></li>
</ul>
<p>&#x2003;&#x2003;Then how can we use the same architecture to represent object and
array data?</p>
<ol type="1">
<li>We use a different area altogether on the RAM called
<em><code>heap</code></em>.</li>
<li>On the <code>heap</code>, we recall the data of all the objects and
the arrays that the current program seeks to manipulate.</li>
</ol>
<p><img src="/2024/04/22/10-5-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E5%BA%95%E5%B1%82%E7%89%B9%E6%80%A7/image-2.png"></p>
<p>&#x2003;&#x2003;As opposed to the <code>local</code> and <code>argument</code>
segments which have only one of each to worry about, here you may have
many objects on the heap. So before we access an object using
<code>this</code> segment, we have to tell the system <strong>to which
object are we actually referring</strong>?</p>
<ul>
<li>The implementation of <code>this</code> location is first
<strong>use the pointer <code>this</code> and
<code>that</code></strong>.</li>
<li>Before we use the two segments, we <strong>first have to use the
<code>pointer</code> segment</strong> to <strong>tell the system where
we want to align <code>this</code> and <code>that</code> on the
RAM</strong>.</li>
</ul>
<blockquote>
<p>We had to provide a mechanism to anchor this and that on the
particular object and array the code has to operate on and we are using
this virtual segment pointer for this purpose.</p>
</blockquote>
<p>&#x2003;&#x2003;Now, suppose we want to access RAM words 8000, 8001, 8002... We can
achieve this by the following VM code:</p>
<p><img src="/2024/04/22/10-5-%E5%AF%B9%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86-%E5%BA%95%E5%B1%82%E7%89%B9%E6%80%A7/image-3.png"></p>
<ul>
<li>Once we set <code>THIS</code> pointer to a particular address,
<strong><code>THIS</code>can be used as if it&apos;s anchored exactly on the
8000th address in RAM</strong>. Given this desired mapping, we can use
command related to <code>THIS</code>.</li>
<li><code>push this 0</code> will <strong>take the value which is
currently located in <code>RAM 8000</code> onto the stack</strong>.</li>
<li><code>pop this 0</code> will <strong>take something off the stack
and put it into <code>RAM 8000</code></strong>.</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/20/10-4-%E5%AF%B9%E6%8E%A7%E5%88%B6%E6%B5%81%E7%9A%84%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/20/10-4-%E5%AF%B9%E6%8E%A7%E5%88%B6%E6%B5%81%E7%9A%84%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">10.4.&#x5BF9;&#x63A7;&#x5236;&#x6D41;&#x7684;&#x5904;&#x7406;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-20 19:15:43" itemprop="dateCreated datePublished" datetime="2024-04-20T19:15:43+08:00">2024-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:44:11" itemprop="dateModified" datetime="2024-06-03T15:44:11+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-10-Code-Generator/" itemprop="url" rel="index"><span itemprop="name">Module 10.Code Generator</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>77</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="114handling-flow-of-control"><span class="math inline">\(11.4.\)</span>Handling Flow of Control</span></h1>
<p><img src="/2024/04/20/10-4-%E5%AF%B9%E6%8E%A7%E5%88%B6%E6%B5%81%E7%9A%84%E5%A4%84%E7%90%86/image.png"></p>
<ul>
<li>The <code>not</code> operation will <strong>turn the expression into
a boolean value</strong>, thus make out code simpler and tighter.</li>
<li>The compiler generates these labels automatically.</li>
</ul>
<p><img src="/2024/04/20/10-4-%E5%AF%B9%E6%8E%A7%E5%88%B6%E6%B5%81%E7%9A%84%E5%A4%84%E7%90%86/image-1.png"></p>
<p>&#x2003;&#x2003;In a program, we may have multiple <code>if</code> and
<code>while</code>statements, to deal we this, we only have to assure
that <strong>the compiler generates unique labels</strong>.</p>
<p>&#x2003;&#x2003;Also the <code>if</code> and <code>while</code> statements may be
nested. That is , <strong>the compiler employs a highly recursive
compilation</strong>.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">10.2.&#x5BF9;&#x53D8;&#x91CF;&#x7684;&#x5904;&#x7406;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-20 09:15:43" itemprop="dateCreated datePublished" datetime="2024-04-20T09:15:43+08:00">2024-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:36:13" itemprop="dateModified" datetime="2024-06-03T15:36:13+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-10-Code-Generator/" itemprop="url" rel="index"><span itemprop="name">Module 10.Code Generator</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>756</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>3 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="112handling-variables"><span class="math inline">\(11.2\)</span>Handling Variables</span></h1>
<h3><span id="1program-compilation">1.Program compilation</span></h3>
<p>&#x2003;&#x2003;Remember that the VM language doesn&apos;t have symbolic variables, it
only has <code>local</code>, <code>this</code> and so on. In order to
resolve this pseudocode into final executable VM code, we have to
<strong>map these symbolic variables on what is called <em>virtual
memory segments</em></strong>. And to do this, we:</p>
<ul>
<li>need the <strong>variable properties</strong>.</li>
<li>also have to know <strong>the index of the variable of its
kind</strong>(first, second, etc.).</li>
</ul>
<p>&#x2003;&#x2003;And the properties of variables include:</p>
<ul>
<li><p><em>name</em>: It&apos;s an identifier.</p></li>
<li><p><em>type</em>: <code>int</code>, <code>char</code>,
<code>boolean</code> and <strong>all class name</strong>.</p></li>
<li><p><em>kind</em>: There are two kinds of variables, and we view them
separately:</p>
<ul>
<li><em>class level</em>: <code>field</code>, <code>static</code>
variables.</li>
<li><em>subroutine level</em>: <code>argument</code> and
<code>local</code> variables.</li>
</ul></li>
<li><p><em>scope</em>, which is the region of the code in which it is
recognized.</p></li>
</ul>
<h3><span id="2symbol-table">2.Symbol table</span></h3>
<p>&#x2003;&#x2003;We handle the property of variables using a <em>symbol
table</em>:</p>
<p><img src="/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/image.png"></p>
<ul>
<li>A method is always designed to operate on the current object which
is called <code>this</code>. Therefore, the symbol table of method
<strong>always begins with <code>this</code> entry</strong>, which
represents the properties of current object.</li>
<li><code>this</code> is always treated as <code>argument 0</code></li>
<li>The type of current object is <strong>the name of the class to which
this subroutine belongs</strong>.</li>
</ul>
<p>&#x2003;&#x2003;The class level symbol table can be reset each time we begin to
compile a new class, for <strong>classes are standalone compilation
unity</strong>. Something similar happens when we compile
subroutines.</p>
<p>&#x2003;&#x2003;The code writer is going to encounter all sorts of variable
declaration commands, of which in Jack we have three:
<code>local</code>, <code>field</code> and <code>static</code>.</p>
<p>&#x2003;&#x2003;Then it&apos;s going to elucidate all important properties of the
declared variables, and <strong>add the information to the respective
symbol table</strong>. It generates no code whatsoever beyond updating
the symbol tables.</p>
<ul>
<li>If we are defining a <code>field</code> or a <code>static</code>
variable, the code writer will add a new row to the end of the class
level symbol table.</li>
<li>If we are defining <code>local</code> or <code>argument</code>, the
code writer will update the symbol table of the subroutine which is
currently being compiled.</li>
<li>Arguments are being defined as <strong>part of the parameter list of
the method&apos;s signature</strong>. When the code writer goes through the
parameter list, it adds the respective lines to the subroutine&apos;s symbol
table.</li>
</ul>
<p><img src="/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/image-1.png"></p>
<p>&#x2003;&#x2003;What about using variables within the context of expressions or
statements. Take <code>let dx = x - other.getX();</code> as an
example:</p>
<ul>
<li><p>For each variable in the code, we <strong>look up this variable
in the subroutine level symbol table</strong>.</p>
<ul>
<li>If we find it there, we know which property we have to use.</li>
<li>If don&apos;t, we revert to <strong>looking it up in the class level
symbol table</strong>.</li>
<li>If don&apos;t either, we can conclude that the variable is undefined and
throw an error message.</li>
</ul></li>
</ul>
<p>&#x2003;&#x2003;How can the statements be translated into VM code? Take
<code>let y = y +dy</code> for example:</p>
<ol type="1">
<li>In the process of generating code, the code generator will look up
the respective table.</li>
<li>It finds out that <strong><code>y</code> stands for the second
<code>field</code> of the current object</strong>, so it will be
translated into <code>this 1</code></li>
<li><code>dy</code> stands for the second <code>local</code> variable,
so it will be translated into <code>local 1</code></li>
</ol>
<p><img src="/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/image-2.png"></p>
<p><img src="/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/image-3.png"></p>
<h3><span id="3handling-variables-ingeneral">3.Handling variables in
general</span></h3>
<p>&#x2003;&#x2003;High level of programming languages vary in terms of:</p>
<ul>
<li>variable types</li>
<li>variable kinds</li>
<li>nested scoping rules</li>
</ul>
<p>&#x2003;&#x2003;And the symbol table generation and usage we discussed right now
can be easily entended to handle any number of possible variables types
and kinds.</p>
<p>&#x2003;&#x2003;Some languages, like Java, feature <em>unlimited scoping</em>. this
means that whenever you define a block of code with a pair of curly
brackets, you can define variables within this code which are recognized
only within that block. <code>x</code> in this scope doesn&apos;t mean the
same as <code>x</code> in that block.</p>
<p>&#x2003;&#x2003;To represent the information in our symbol table mechanism, we use
<strong>a linked list of symbol tables</strong>:</p>
<ul>
<li>When start compiling the class, we first create an linked list.</li>
<li>The first symbol table we add to the list is the class level symbol
table.</li>
<li>When we start compiling a method, we create the method symbol table
like before.</li>
<li>Whenever we have another scoping region, we <strong>add another
symbol table to the linked list</strong>.</li>
</ul>
<p><img src="/2024/04/20/10-2-%E5%AF%B9%E5%8F%98%E9%87%8F%E7%9A%84%E5%A4%84%E7%90%86/image-4.png"></p>
<p>&#x2003;&#x2003;When you encounter some variable <code>x</code> in the code we:</p>
<ol type="1">
<li>Look up <code>x</code> in the current scope, which is also the first
table.</li>
<li>If fail, we move to the next symbol table.</li>
<li>We simply go on downstream until we get to the class level symbol
table.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/20/10-3-%E5%AF%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/20/10-3-%E5%AF%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">10.3.&#x5BF9;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x5904;&#x7406;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-20 09:15:43" itemprop="dateCreated datePublished" datetime="2024-04-20T09:15:43+08:00">2024-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:39:49" itemprop="dateModified" datetime="2024-06-03T15:39:49+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-10-Code-Generator/" itemprop="url" rel="index"><span itemprop="name">Module 10.Code Generator</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>397</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="113handling-expression"><span class="math inline">\(11.3.\)</span>Handling Expression</span></h1>
<h3><span id="1expressions-definitionreview">1.Expressions definition
review</span></h3>
<p><img src="/2024/04/20/10-3-%E5%AF%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/image-5.png"></p>
<h3><span id="2parse-tree">2.Parse tree</span></h3>
<p><img src="/2024/04/20/10-3-%E5%AF%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/image-6.png"></p>
<ul>
<li><em>infix</em>: that&apos;s sort of ingrained into our brains in
elementary school.</li>
<li><em>prefix</em>: that&apos;s what we do when we define functions: we put
the function name and then a list of operands or parameters or
arguments.</li>
<li><em>postfix</em>: that&apos;s closely related to the stack machine. Say
we want to do an <code>add</code> operation, we <code>push x</code>,
<code>push y</code> and finally <code>pop</code>, this is exactly
postfix.</li>
</ul>
<h3><span id="3generating-code-forexpressions">3.Generating code for
expressions</span></h3>
<p>&#x2003;&#x2003;In high level language like Java, we declare expressions in infix,
and the target language, so our compiler has to translate from infix to
postfix. Here are two ways to do this:</p>
<p><img src="/2024/04/20/10-3-%E5%AF%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/image-7.png"></p>
<ol type="1">
<li>We generate a parse tree through the infix expression.</li>
<li>The parser takes the source code and produces XML code from it.</li>
<li>We go through every node in the parse tree in a certain order.</li>
</ol>
<p>&#x2003;&#x2003;To convert the parse tree into the VM code, we use the
<em>deep-first tree traversal algorithm</em>:</p>
<ul>
<li>We go all the way down, and when we hit a terminal leaf, we process
it.</li>
</ul>
<p>&#x2003;&#x2003;However, the parse tree we have may be gigantic, so it may be
better not to have the side effect. We will use the following code
generation algorithm instead:</p>
<p><img src="/2024/04/20/10-3-%E5%AF%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/image-8.png"></p>
<ul>
<li>Whatever is the mapping of <code>x</code> is dictated by the symbol
table which is always in the background of the co-generation
algorithms.</li>
</ul>
<p>&#x2003;&#x2003;The nice thing about this algorithm is that not only does it
<strong>capture the semantics of the input expression</strong>, it also
<strong>computes the value of this expression</strong>. That is, in the
runtime the value of the expression is going to be placed on the
stack.</p>
<h3><span id="4from-parsing-to-codegeneration">4.From parsing to code
generation</span></h3>
<p>&#x2003;&#x2003;In the previous project, we develop a Jack Analyzer that generate
static XML code, but in this part, the XML is completely irrelevant now.
Instead, we generate actual executable VM code. And there are some
general guidelines on what has to be done:</p>
<ul>
<li>We have <strong>operator priority</strong> in some operation, such
as mathematics operations (however, Jack doesn&apos;t have this). Since the
compiler will ignore it, we ourselves must take this into
consideration.</li>
<li>Once we have parenthesis in Jack, we have to take operator priority
into consideration. We have to make the code write algorithm work in the
proper order as dictated by the parenthesis.</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/19/9-9-%E5%88%86%E6%9E%90%E5%99%A8%E5%AE%9E%E7%8E%B0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/19/9-9-%E5%88%86%E6%9E%90%E5%99%A8%E5%AE%9E%E7%8E%B0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">9.9.&#x5206;&#x6790;&#x5668;&#x5B9E;&#x73B0;&#x7B14;&#x8BB0;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-19 09:12:43" itemprop="dateCreated datePublished" datetime="2024-04-19T09:12:43+08:00">2024-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:31:22" itemprop="dateModified" datetime="2024-06-03T15:31:22+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-9-Syntax-Analyze/" itemprop="url" rel="index"><span itemprop="name">Module 9.Syntax Analyze</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>607</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="99&#x5206;&#x6790;&#x5668;&#x5B9E;&#x73B0;&#x7B14;&#x8BB0;"><span class="math inline">\(9.9.\)</span>&#x5206;&#x6790;&#x5668;&#x5B9E;&#x73B0;&#x7B14;&#x8BB0;</span></h1>
<h3><span id="1&#x5206;&#x8BCD;&#x5668;">1.&#x5206;&#x8BCD;&#x5668;</span></h3>
<p>&#x2003;&#x2003;&#x5B9E;&#x73B0;&#x5206;&#x8BCD;&#x5668;&#xFF0C;&#x5BB9;&#x6613;&#x60F3;&#x5230;&#x5148;&#x6309;&#x7167;token&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ch == <span class="string">&apos;&quot;&apos;</span>)</span><br><span class="line"><span class="keyword">if</span> (Character.isDigit(ch))</span><br><span class="line"><span class="keyword">if</span> (isSymbol(ch))</span><br><span class="line"><span class="keyword">for</span> (String keywordName : keyword)</span><br><span class="line"><span class="keyword">else</span></span><br></pre></td></tr></table></figure>
<p>&#x2003;&#x2003;&#x4F46;&#x662F;&#xFF0C;&#x6709;&#x65F6;&#x5173;&#x952E;&#x8BCD;&#x4F1A;&#x6DF7;&#x6742;&#x5728;&#x6807;&#x8BC6;&#x7B26;&#x4E2D;&#xFF0C;&#x5BFC;&#x81F4;&#x5206;&#x8BCD;&#x9519;&#x8BEF;&#x3002;&#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x5728;&#x5904;&#x7406;&#x5B8C;&#x5173;&#x952E;&#x8BCD;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5F15;&#x5165;&#x4E00;&#x4E9B;<strong>&#x8BED;&#x6CD5;&#x6A21;&#x5F0F;</strong>&#xFF0C;&#x5BF9;&#x4E00;&#x4E9B;&#x7279;&#x4F8B;<strong>&#x4F18;&#x5148;&#x5904;&#x7406;</strong>&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x610F;&#x5916;&#x60C5;&#x51B5;&#x7684;&#x51FA;&#x73B0;&#xFF1A;</p>
<ol type="1">
<li>&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (keywordName.equals(<span class="string">&quot;class&quot;</span>)) {</span><br><span class="line">    <span class="type">String</span> <span class="variable">classname</span> <span class="operator">=</span> line.substring(<span class="number">0</span>, line.indexOf(<span class="string">&quot;{&quot;</span>));</span><br><span class="line">    currentClass = classname;</span><br><span class="line">    writer.write(identifierVal(classname));</span><br><span class="line">    writer.newLine();</span><br><span class="line">    token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">    tokenLine.add(identifierVal(classname));</span><br><span class="line">    stringCollection.add(classname);</span><br><span class="line">    line = line.substring(classname.length());</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol start="2" type="1">
<li>&#x53D8;&#x91CF;&#x7684;&#x58F0;&#x660E;&#xFF1A;</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isVarDec(keywordName)) {</span><br><span class="line">    <span class="comment">// The first is type declaration</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">tag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (String s : type) {</span><br><span class="line">        <span class="keyword">if</span> (line.indexOf(s) == <span class="number">0</span>) {</span><br><span class="line">            tag = <span class="literal">true</span>;</span><br><span class="line">            writer.write(keywordVal(s));</span><br><span class="line">            writer.newLine();</span><br><span class="line">            token.add(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            tokenLine.add(keywordVal(s));</span><br><span class="line">            stringCollection.add(s);</span><br><span class="line">            line = line.substring(s.length());</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!tag) {</span><br><span class="line">        <span class="keyword">for</span> (String s : className) {</span><br><span class="line">            <span class="keyword">if</span> (line.indexOf(s) == <span class="number">0</span>) {</span><br><span class="line">                writer.write(identifierVal(s));</span><br><span class="line">                writer.newLine();</span><br><span class="line">                token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">                tokenLine.add(identifierVal(s));</span><br><span class="line">                stringCollection.add(s);</span><br><span class="line">                line = line.substring(s.length());</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Then comes the varName</span></span><br><span class="line">    String varName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (line.contains(<span class="string">&quot;,&quot;</span>) &amp;&amp; line.indexOf(<span class="string">&quot;,&quot;</span>) &lt; line.indexOf(<span class="string">&quot;;&quot;</span>)) {</span><br><span class="line">        varName = line.substring(<span class="number">0</span>, line.indexOf(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">        writer.write(identifierVal(varName));</span><br><span class="line">        writer.newLine();</span><br><span class="line">        token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">        tokenLine.add(identifierVal(varName));</span><br><span class="line">        stringCollection.add(varName);</span><br><span class="line">        line = line.substring(varName.length());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// We need to consider if there exists a &apos;,&apos;</span></span><br><span class="line">        <span class="keyword">while</span> (line.charAt(<span class="number">0</span>) == <span class="string">&apos;,&apos;</span>) {</span><br><span class="line">            writer.write(identifierVal(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">            writer.newLine();</span><br><span class="line">            token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">            tokenLine.add(identifierVal(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">            stringCollection.add(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            line = line.substring(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (line.contains(<span class="string">&quot;,&quot;</span>) &amp;&amp; line.indexOf(<span class="string">&quot;,&quot;</span>) &lt; line.indexOf(<span class="string">&quot;;&quot;</span>)) {</span><br><span class="line">                varName = line.substring(<span class="number">0</span>, line.indexOf(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                varName = line.substring(<span class="number">0</span>, line.indexOf(<span class="string">&quot;;&quot;</span>));</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            writer.write(identifierVal(varName));</span><br><span class="line">            writer.newLine();</span><br><span class="line">            token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">            tokenLine.add(identifierVal(varName));</span><br><span class="line">            stringCollection.add(varName);</span><br><span class="line">            line = line.substring(varName.length());</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        writer.write(identifierVal(<span class="string">&quot;;&quot;</span>));</span><br><span class="line">        writer.newLine();</span><br><span class="line">        token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">        tokenLine.add(identifierVal(<span class="string">&quot;;&quot;</span>));</span><br><span class="line">        stringCollection.add(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">        line = line.substring(<span class="number">1</span>);</span><br><span class="line">    } <span class="keyword">else</span> { <span class="comment">// No &apos;,&apos;, just &apos;;&apos;</span></span><br><span class="line">        varName = line.substring(<span class="number">0</span>, line.indexOf(<span class="string">&quot;;&quot;</span>));</span><br><span class="line">        writer.write(identifierVal(varName));</span><br><span class="line">        writer.newLine();</span><br><span class="line">        token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">        tokenLine.add(identifierVal(varName));</span><br><span class="line">        stringCollection.add(varName);</span><br><span class="line">        line = line.substring(varName.length());</span><br><span class="line"></span><br><span class="line">        writer.write(identifierVal(<span class="string">&quot;;&quot;</span>));</span><br><span class="line">        writer.newLine();</span><br><span class="line">        token.add(<span class="string">&quot;symbol&quot;</span>);</span><br><span class="line">        tokenLine.add(identifierVal(<span class="string">&quot;;&quot;</span>));</span><br><span class="line">        stringCollection.add(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">        line = line.substring(<span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol start="3" type="1">
<li>&#x51FD;&#x6570;&#x7684;&#x58F0;&#x660E;&#xFF1A;</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSubroutineDec(keywordName)) {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">tag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (String s : type) {</span><br><span class="line">        <span class="keyword">if</span> (line.indexOf(s) == <span class="number">0</span>) {</span><br><span class="line">            tag = <span class="literal">true</span>;</span><br><span class="line">            writer.write(keywordVal(s));</span><br><span class="line">            writer.newLine();</span><br><span class="line">            token.add(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            tokenLine.add(keywordVal(s));</span><br><span class="line">            stringCollection.add(s);</span><br><span class="line">            line = line.substring(s.length());</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!tag) {</span><br><span class="line">        <span class="keyword">for</span> (String s : className) {</span><br><span class="line">            <span class="keyword">if</span> (line.indexOf(s) == <span class="number">0</span>) {</span><br><span class="line">                writer.write(identifierVal(s));</span><br><span class="line">                writer.newLine();</span><br><span class="line">                token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">                tokenLine.add(identifierVal(s));</span><br><span class="line">                stringCollection.add(s);</span><br><span class="line">                line = line.substring(s.length());</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">varName</span> <span class="operator">=</span> line.substring(<span class="number">0</span>, line.indexOf(<span class="string">&quot;(&quot;</span>));</span><br><span class="line">    funcCollection.add(currentClass + <span class="string">&quot;.&quot;</span> + varName);</span><br><span class="line">    writer.write(identifierVal(varName));</span><br><span class="line">    writer.newLine();</span><br><span class="line">    token.add(<span class="string">&quot;identifier&quot;</span>);</span><br><span class="line">    tokenLine.add(identifierVal(varName));</span><br><span class="line">    stringCollection.add(varName);</span><br><span class="line">    line = line.substring(varName.length());</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3><span id="2&#x5206;&#x6790;&#x5668;">2.&#x5206;&#x6790;&#x5668;</span></h3>
<p>&#x2003;&#x2003;&#x5728;&#x5206;&#x6790;&#x5668;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7ECF;&#x5206;&#x8BCD;&#x5668;&#x5904;&#x7406;&#x8FC7;&#x7684;&#x6587;&#x4EF6;&#x6765;&#x6784;&#x5EFA;&#x6700;&#x7EC8;&#x7684;.xml&#x6587;&#x4EF6;&#x3002;&#x7531;&#x4E8E;&#x5BF9;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x751F;&#x6210;&#x591A;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x5229;&#x7528;<code>ArrayList&lt;String&gt;</code>&#x6765;&#x5B58;&#x50A8;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x4EA7;&#x751F;&#x7684;&#x8BED;&#x53E5;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x5176;&#x4ED6;&#x5B50;&#x5143;&#x7D20;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;<strong>&#x5728;&#x8C03;&#x7528;&#x5904;&#x7406;&#x5B50;&#x5143;&#x7D20;&#x7684;&#x65B9;&#x6CD5;&#x3001;&#x5F97;&#x5230;&#x5B50;&#x5143;&#x7D20;&#x7684;&#x5206;&#x6790;&#x4EE3;&#x7801;&#x540E;&#xFF0C;&#x52A0;&#x5165;&#x8BE5;&#x5143;&#x7D20;&#x7684;<code>ArrayList</code>&#x5373;&#x53EF;</strong>&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<strong>&#x9012;&#x5F52;</strong>&#x8C03;&#x7528;&#x6765;&#x5B8C;&#x6210;&#x5BF9;&#x7A0B;&#x5E8F;&#x7684;&#x5206;&#x6790;</p>
<p>&#x2003;&#x2003;&#x4EE5;<code>class</code>&#x7684;&#x5206;&#x6790;&#x4E3A;&#x4F8B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5199;&#x51FA;&#x4EE5;&#x4E0B;&#x7684;&#x4EE3;&#x7801;&#x6846;&#x67B6;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;String&gt; <span class="title function_">compileClass</span><span class="params">()</span> {</span><br><span class="line">    ArrayList&lt;String&gt; class_ = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    class_.add(<span class="string">&quot;&lt;class&gt;&quot;</span>);</span><br><span class="line">    ......</span><br><span class="line"></span><br><span class="line">    <span class="comment">//call method recursively</span></span><br><span class="line">    class_.addAll(compileClassVar());</span><br><span class="line">    class_.addAll(compileSubroutineDec());</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">    class_.add(<span class="string">&quot;&lt;/class&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> class_;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/16/9-5-%E8%A7%A3%E6%9E%90%E5%99%A8%E9%80%BB%E8%BE%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/16/9-5-%E8%A7%A3%E6%9E%90%E5%99%A8%E9%80%BB%E8%BE%91/" class="post-title-link" itemprop="url">9.5.&#x89E3;&#x6790;&#x5668;&#x903B;&#x8F91;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-16 17:17:43" itemprop="dateCreated datePublished" datetime="2024-04-16T17:17:43+08:00">2024-04-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:27:03" itemprop="dateModified" datetime="2024-06-03T15:27:03+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-9-Syntax-Analyze/" itemprop="url" rel="index"><span itemprop="name">Module 9.Syntax Analyze</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>482</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="95parserlogic"><span class="math inline">\(9.5.\)</span>Parser
Logic</span></h1>
<h3><span id="1parsing-logic">1.Parsing logic</span></h3>
<p>&#x2003;&#x2003;In order to carry out parsing, we are going to build a
<code>CompilationEngine</code> class which consist of <strong>a set of
methods, one method for every non-terminal rule</strong>.</p>
<p><img src="/2024/04/16/9-5-%E8%A7%A3%E6%9E%90%E5%99%A8%E9%80%BB%E8%BE%91/image.png"></p>
<ul>
<li>The code of each <code>compilexxx</code> method follows the
right-hand side of the rule xxx</li>
<li>Each <code>compilexxx</code> method is responsible for
<strong>advancing</strong> and <strong>handling its own part of the
input</strong>.</li>
</ul>
<p>&#x2003;&#x2003;To illustrate this, let&apos;s focus on one of these methods
<code>compileWhileStatement</code>:</p>
<p><img src="/2024/04/16/9-5-%E8%A7%A3%E6%9E%90%E5%99%A8%E9%80%BB%E8%BE%91/image-1.png"></p>
<ol type="1">
<li><p>We <strong>follow the right-hand side of the rule</strong>, and
parse the input it dictates.</p>
<ul>
<li>In <code>whileStatement</code>, it says we should expect to see the
token <code>while</code>. If we find it in the input, we record the
fact. Then the left parenthesis, and so on and so forth,</li>
<li>At some point we will get a non-terminal rule like
<code>expression</code>, then we go to next step:</li>
</ul></li>
<li><p>If the right-hand side specifies a non-terminal rule
<code>xxx</code>, we call the corresponding method
<code>compilexxx</code></p></li>
<li><p>We do this recursively untile we exhaust the input.</p></li>
</ol>
<p>&#x2003;&#x2003;And to initialize this process, we:</p>
<ol type="1">
<li>Advance the tokenizer.</li>
<li>Call <code>compileWhileStatement</code>.</li>
</ol>
<h3><span id="2parser-design">2.Parser design</span></h3>
<p>&#x2003;&#x2003;We also take the <code>compileWhileStatement</code> as an
example:</p>
<ol type="1">
<li>If we look at the grammar, we first see that you should see a
<code>while</code> , so we <strong>call a method
<code>eat(&apos;while&apos;)</code></strong>, which means you should expect now to
eat the <code>while</code> token.</li>
<li>We do the same thing <code>eat(&apos;(&apos;)</code>.</li>
<li>We meet a non-terminal rule <code>expression</code>, so we call
<code>compileExpression();</code></li>
<li>And so on and so forth...</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class CompilationEngine { </span><br><span class="line">	</span><br><span class="line">	compileWhileStatement() { </span><br><span class="line">		eat(&apos;while&#x2019;);</span><br><span class="line">		eat(&apos;(&apos;);  </span><br><span class="line">		compileExpression(); </span><br><span class="line">		eat(&apos;)&apos;);</span><br><span class="line">		...</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x2003;&#x2003;When it comes to <code>eat</code> method:</p>
<ul>
<li>It&apos;s a private method.</li>
<li>It says <strong>you should expect to see the given string</strong>,
if not, you should <strong>throw an error</strong>.</li>
<li>Otherwise, simply <strong>advance the input</strong>.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eat(string) {</span><br><span class="line">	if (currentToken &lt;&gt; string) </span><br><span class="line">		error...</span><br><span class="line">	else</span><br><span class="line">		advance...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3><span id="3some-observationabout-grammars-and-parsing">3.Some observation
about grammars and parsing</span></h3>
<ul>
<li><p><em>LL grammar</em>: It&apos;s a grammar that <strong>can be parsed by
a recursive descent algorithm parser without backtracking</strong>.</p>
<ul>
<li>When you make a decision that what you have is a <code>while</code>
statement, you don&apos;t have to kind of retract your progress and find out
a mistake.</li>
</ul></li>
<li><p><em>LL(k) parser</em>: It&apos;s an LL parser that needs to look ahead
at most k tokens before you know which rule you are dealing with.</p>
<ul>
<li>The grammar we saw so far is <em>LL1</em>, because <strong>once we
have a particular token in hand like <code>let</code>, we immediately
know which rule we have to invoke</strong>.</li>
<li>There are also things that don&apos;t belong to LL1, like English. For
example, when we meet a token word &quot;lift&quot;, we still have no idea what we
should do with it. A verb? A noun? We have to look more tokens
downstream to know which rule to use. In this process, we may need to
backtrack and reconsider some of the rules we have to use...</li>
</ul></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/16/10-4-%E8%A7%A3%E6%9E%90%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/16/10-4-%E8%A7%A3%E6%9E%90%E6%A0%91/" class="post-title-link" itemprop="url">9.4.&#x89E3;&#x6790;&#x6811;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-16 12:17:43" itemprop="dateCreated datePublished" datetime="2024-04-16T12:17:43+08:00">2024-04-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:22:19" itemprop="dateModified" datetime="2024-06-03T15:22:19+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-9-Syntax-Analyze/" itemprop="url" rel="index"><span itemprop="name">Module 9.Syntax Analyze</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>196</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="94parsetree"><span class="math inline">\(9.4.\)</span>Parse
Tree</span></h1>
<h3><span id="1parse-tree-introduction">1.Parse tree introduction</span></h3>
<p>&#x2003;&#x2003;In this part we are going to be specific about the grammatical
structure. Take the sentence &quot;the dog ate my homework&quot; for example,
here&apos;s the grammatical structure of it:</p>
<p><img src="/2024/04/16/10-4-%E8%A7%A3%E6%9E%90%E6%A0%91/image.png"></p>
<p>&#x2003;&#x2003;It&apos;s recorded using a <em>parse tree</em>. The tree is a recursive
structure, and the grammatical structure of the inputs are
<strong>recursive</strong>, too.</p>
<ul>
<li>The <code>sentence</code> consists of two lower-level sub parse
tree.</li>
<li>We continue to expanding the tree until get to the boundary of the
tree, called <em>leaves</em> or <em>terminal nodes</em>. In the case of
lexical analysis, they are <strong>the tokens from which the input is
constructed</strong>.</li>
</ul>
<p>&#x2003;&#x2003;Then let&apos;s move to Jack. Take the input
<code>while (count &lt; 100) {let count = count + 1;}</code> for
example:</p>
<p><img src="/2024/04/16/10-4-%E8%A7%A3%E6%9E%90%E6%A0%91/image-1.png"></p>
<blockquote>
<p>The notion of a parse tree is an obstruct artifact that sits
somewhere above all these nice diagrams. And this diagram here is just
one way to describe this parse tree.</p>
</blockquote>
<p>&#x2003;&#x2003;To motivate this, let&apos;s focus on some subset of the prase tree:</p>
<p><img src="/2024/04/16/10-4-%E8%A7%A3%E6%9E%90%E6%A0%91/image-2.png"></p>
<p>&#x2003;&#x2003;Another way of describing the same parse tree can be <em>XML
format</em>:</p>
<p><img src="/2024/04/16/10-4-%E8%A7%A3%E6%9E%90%E6%A0%91/image-3.png"></p>
<ul>
<li>In XML, we describe the structure of data using <em>markup
tags</em>.</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/04/16/10-3-%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/16/10-3-%E8%AF%AD%E6%B3%95/" class="post-title-link" itemprop="url">9.3.&#x8BED;&#x6CD5;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-04-16 09:17:43" itemprop="dateCreated datePublished" datetime="2024-04-16T09:17:43+08:00">2024-04-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 15:18:56" itemprop="dateModified" datetime="2024-06-03T15:18:56+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/" itemprop="url" rel="index"><span itemprop="name">The Elements of Computer System</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/The-Elements-of-Computer-System/Module-9-Syntax-Analyze/" itemprop="url" rel="index"><span itemprop="name">Module 9.Syntax Analyze</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>340</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="93grammars"><span class="math inline">\(9.3.\)</span>Grammars</span></h1>
<h3><span id="1grammar-introduction">1.Grammar introduction</span></h3>
<p>&#x2003;&#x2003;In the previous unit, we gain the ability to think about the
program as a set of tokens, but the effect that we have a set of valid
tokens doesn&apos;t imply that we have a valid program. <strong>It&apos;s not only
the tokens that are important, the order of the tokens is critically
important as well</strong>.</p>
<p>&#x2003;&#x2003;And the artifact that <strong>defines in what order we can put
tokens together legibly</strong> is referred to as <em>grammar</em>.</p>
<ul>
<li>A grammar is a set of rules, describing how tokens can be combined
to create valid language constructs</li>
</ul>
<p>&#x2003;&#x2003;Take the English language as an example:</p>
<p><img src="/2024/04/16/10-3-%E8%AF%AD%E6%B3%95/image.png"></p>
<p>&#x2003;&#x2003;It&apos;s just a subset of English language, but is sufficiently rich to
support plenty of inputs. Consider the sentence &quot;The dog ate my
homework&quot;:</p>
<ul>
<li>&apos;The&apos; is a det and &apos;dog&apos; is a noun, so the sentence begins with a
noun phrase.</li>
<li>&apos;ate&apos; is a verb and &apos;my homework&apos; is once again a noun phrase, so
this subsentence is a verb phrase.</li>
<li>Taken together, we have a noun phrase followed by a verb phrase,
therefore we have a legitimate sentence.</li>
</ul>
<p>&#x2003;&#x2003;In this example, we notice that grammar is indeed made of a set of
rules. And these rules fall into two broad categories:</p>
<ol type="1">
<li><em>Terminal rule</em>: Its right-hand side consists of constants
only.</li>
<li><em>Non-terminal rule</em>: Its right-hand side consists of names of
other rules, and probably constants.</li>
</ol>
<h3><span id="2jack-grammar">2.Jack grammar</span></h3>
<p>&#x2003;&#x2003;Let&apos;s focus on a subset of Jack language in which we have three
possible statements: <code>if</code>, <code>while</code>,
<code>let</code>:</p>
<p><img src="/2024/04/16/10-3-%E8%AF%AD%E6%B3%95/image-1.png"></p>
<ul>
<li>We use <code>*</code> to indicate 0 or more.</li>
<li>We use <code>|</code> to denote choice.</li>
<li>We use <code>?</code> to denote 0 or 1.</li>
</ul>
<p>&#x2003;&#x2003;And the process of <strong>determining if a given input conforms to
a grammar</strong> is called <em>prasing</em>.</p>
<p>&#x2003;&#x2003;Notice that in the process of doing this confirmation, we also
<strong>uncover the entire grammatical structure of the given
input</strong>, because we analyze how the input corresponds to the
various components of the rule.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="&#x4E0A;&#x4E00;&#x9875;" aria-label="&#x4E0A;&#x4E00;&#x9875;" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&#x2026;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&#x2026;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" title="&#x4E0B;&#x4E00;&#x9875;" aria-label="&#x4E0B;&#x4E00;&#x9875;" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">



  <div class="copyright">
    &#xA9; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">fyerfyer</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>&#x7AD9;&#x70B9;&#x603B;&#x5B57;&#x6570;&#xFF1A;</span>
    <span title="&#x7AD9;&#x70B9;&#x603B;&#x5B57;&#x6570;">86k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>&#x7AD9;&#x70B9;&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
    <span title="&#x7AD9;&#x70B9;&#x9605;&#x8BFB;&#x65F6;&#x957F;">5:12</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="&#x603B;&#x8BBF;&#x5BA2;&#x91CF;">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="&#x603B;&#x8BBF;&#x95EE;&#x91CF;">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">&#x7531; <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> &amp; <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> &#x5F3A;&#x529B;&#x9A71;&#x52A8;
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script src="/js/third-party/comments/livere.js"></script>

</body>
</html>
