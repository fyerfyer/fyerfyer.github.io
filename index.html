<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"fyerfyer.github.io.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":2,"unescape":true,"preload":false}}</script><script src="/js/config.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">


    <meta name="description" content="fyerfyer&apos;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="fyerfyer">
<meta property="og:url" content="https://fyerfyer.github.io.com/index.html">
<meta property="og:site_name" content="fyerfyer">
<meta property="og:description" content="fyerfyer&apos;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="fyerfyer">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://fyerfyer.github.io.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>fyerfyer</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="&#x5207;&#x6362;&#x5BFC;&#x822A;&#x680F;" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">fyerfyer</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Hello! Nice to meet you!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="&#x641C;&#x7D22;" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>&#x9996;&#x9875;</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>&#x5173;&#x4E8E;</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>&#x5206;&#x7C7B;</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>&#x5F52;&#x6863;</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>&#x641C;&#x7D22;
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="&#x641C;&#x7D22;..." spellcheck="false" type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          &#x6587;&#x7AE0;&#x76EE;&#x5F55;
        </li>
        <li class="sidebar-nav-overview">
          &#x7AD9;&#x70B9;&#x6982;&#x89C8;
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fyerfyer" src="/images/head.png">
  <p class="site-author-name" itemprop="name">fyerfyer</p>
  <div class="site-description" itemprop="description">fyerfyer&apos;s blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">114</span>
          <span class="site-state-item-name">&#x65E5;&#x5FD7;</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">&#x5206;&#x7C7B;</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/fyerfyer" title="GitHub &#x2192; https://github.com/fyerfyer" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/fuy60703@gmail.com" title="E-Mail &#x2192; fuy60703@gmail.com" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="&#x8FD4;&#x56DE;&#x9876;&#x90E8;">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/06/14/4-1-Caches/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/14/4-1-Caches/" class="post-title-link" itemprop="url">4.1.Caches</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-06-14 08:36:22" itemprop="dateCreated datePublished" datetime="2024-06-14T08:36:22+08:00">2024-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-15 15:07:48" itemprop="dateModified" datetime="2024-06-15T15:07:48+08:00">2024-06-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">CS61C Great Ideas in Computer Architecture</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/Module-4-Cache/" itemprop="url" rel="index"><span itemprop="name">Module 4.Cache</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>2.9k</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>11 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="41caches"><span class="math inline">\(4.1.\)</span>Caches</span></h1>
<h3><span id="1-some-concepts-amp-libraryanalogy">1. Some concepts &amp; Library
analogy</span></h3>
<blockquote>
<p>Suppose you were a student writing a term paper on important
historical developments in computer hardware. You are sitting at a desk
in a library with a collection of books that you have pulled from the
shelves and are examining. You find that several of the important
computers that you need to write about are described in the books you
have, but there is nothing about the EDSAC. Therefore, you go back to
the shelves and look for an additional book. You find a book on early
British computers that covers the EDSAC. Once you have a good selection
of books on the desk in front of you, there is a high probability that
<strong>many of the topics you need can be found in them, and you may
spend most of your time just using the books on the desk without
returning to the shelves</strong>. Having several books on the desk in
front of you saves time compared to having only one book there and
constantly having to go back to the shelves to return it and take out
another.</p>
<p>The same principle allows us to create the illusion of a large memory
that we can access as fast as a very small memory. Just as you did not
need to access all the books in the library at once with equal
probability, <strong>a program does not access all of its code or data
at once with equal probability</strong>. Otherwise,it would be
impossible to make most memory accesses fast and still have large memory
in computers, just as it would be impossible for you to fit all the
library books on your desk and still find what you wanted quickly.</p>
</blockquote>
<p>&#x2003;&#x2003;The above line illustrates the <em>principel of locality</em>.
There are two kinds of localities:</p>
<ul>
<li><p>Temporal locality(locality in time): <strong>If an item is
referenced, it will tend to be referenced again soon.</strong> (If you
recently brought a book to your desk to look at, you will probably need
to look at it again soon.)</p></li>
<li><p>Spatial locality (locality in space): <strong>If an item is
referenced, items whose addresses are close by will tend to be
referenced soon.</strong> (For example, when you brought out the book on
early English computers to learn about the EDSAC, you also noticed that
there was another book shelved next to it about early mechanical
computers, so you likewise brought back that book and, later on, found
something useful in that book.)</p></li>
</ul>
<p>&#x2003;&#x2003;We take advantage of the principle of locality by implementing the
memory as a <em>memory hierarchy</em>. It contains multiple levels, but
<strong>data are copied between only two adjacent levels at a
time</strong>.</p>
<p><img src="/2024/06/14/4-1-Caches/image.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-1.png"></p>
<blockquote>
<p>The faster memories are <strong>more expensive per bit</strong> than
the slower and thus are <strong>smaller</strong>.</p>
</blockquote>
<p><img src="/2024/06/14/4-1-Caches/image-2.png"></p>
<ul>
<li>If <strong>the data requested by the processor appear in some block
in the upper level</strong>, it&apos;s called a <em>hit</em>(like you find a
book on your desk). Else it&apos;s called a <em>miss</em>.</li>
</ul>
<p><img src="/2024/06/14/4-1-Caches/image-28.png"></p>
<h3><span id="2memory-technologies">2.Memory technologies</span></h3>
<p><img src="/2024/06/14/4-1-Caches/image-3.png"></p>
<h3><span id="3caches-basics">3.Caches basics</span></h3>
<h4><span id="adirect-mapped-structure">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Direct-mapped structure</span></h4>
<p>&#x2003;&#x2003;For each word, we can assign a location in cache based on the
<em>address</em> of the word in memory, and this is called
<strong>direct-mapped</strong>.</p>
<p>&#x2003;&#x2003;The struction uses this mapping to find a block:</p>
<p><span class="math display">\[
(blockAddress)\mod (numberOfBlockInCache)
\]</span></p>
<ul>
<li>We add a set of <em>tags</em> to the cache to judge if the data in
the cache corresponds to a requested word. The tag needs to contain
<strong>the upper portion of the address</strong>:</li>
</ul>
<p><img src="/2024/06/14/4-1-Caches/image-4.png"></p>
<ul>
<li><p>We add a <em>valid bit</em> to <strong>indicate whether an entry
contains a valid address</strong>. If the bit isn&apos;s set, there cannot be
a match for this block.</p></li>
<li><p>A <em>cache index</em> is used to <strong>select the
block</strong>.</p></li>
</ul>
<p><img src="/2024/06/14/4-1-Caches/image-5.png"></p>
<p>&#x2003;&#x2003;The digit capacity of tage field and the total number of bits in
the struction can be calculated by the following steps:</p>
<p><img src="/2024/06/14/4-1-Caches/image-6.png"></p>
<h4><span id="bdealing-with-missing-rate">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Dealing with missing rate</span></h4>
<ul>
<li><p><strong>Larger blocks exploit spatial locality to lower miss
rates</strong>. This is because larger blocks <strong>contain more
adjacent data</strong>, taking advantage of locality of reference,
making it more likely that programs will hit the cache when they access
the data.</p></li>
<li><p>However, the miss rate may go up eventually if <strong>the block
size becomes a significant fraction of the cache size</strong>, for
<strong>there will be a great deal of competition for those
blocks</strong>. As a result, a block will be bumped out of the cache
before its words are accessed.</p></li>
<li><p>Also, enlarging the block size makes the <em>miss penalty</em>
larger.</p>
<ul>
<li><p>The miss penalty is determined by <strong>the time required to
fetch the block from the next lower level of the hierarchy and load it
into the cache</strong>.</p></li>
<li><p>The time to fetch the block has two parts: <strong>the latency to
the first word</strong> and <strong>the transfer time for the rest of
the block</strong>.</p></li>
</ul></li>
</ul>
<h3><span id="4handling-cache-misses">4.Handling cache misses</span></h3>
<p>&#x2003;&#x2003;The cache miss handling is done in collaboration with the
<em>process control unit</em> and with a separate <em>controller</em>
that initiates the memory access and refills the cache.</p>
<ul>
<li>The control unit in cache must detect a miss and process the miss by
fetching the requested data from memory. If the cache reports a hit, it
uses the data as usual.</li>
</ul>
<p>&#x2003;&#x2003;To handle the <em>instruction misses</em>, we need to:</p>
<ol type="1">
<li><p>Send the original PC value to the memory. It equals to
<code>PC-4</code>.</p></li>
<li><p>Instruct main memory to perform a read and wait for the memory to
complete its access.</p></li>
<li><p>Write the cache entry, putting the data from memory in the data
portion of the entry, writing the upper bits of the address(from the
ALU)into the tag field, and turning the valid bit on.</p></li>
<li><p><strong>Restart the instruction execution at the first
step</strong>, which will refetch the instruction, this time
<strong>finding it in the cache</strong>.</p></li>
</ol>
<h3><span id="5handling-writes">5.Handling writes</span></h3>
<h4><span id="awrite-through">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Write-through</span></h4>
<p>&#x2003;&#x2003;One simple way to deal with write hit is <strong>always to write
the data into both the memory and the cache</strong>. However, the write
to main memory takes a long time, thus reduce the performance.</p>
<p>&#x2003;&#x2003;One solution is to use a <em>write buffer</em>. It <strong>stores
the data while they are waiting to be written to memory</strong>.</p>
<ul>
<li><p>After writing the data into the cache and the write buffer, the
processor continues execution.</p></li>
<li><p>When a write to main memory completes, the entry in the write
buffer is freed.</p></li>
<li><p>If the write buffer is full when the processor reaches a write,
the processor must <strong>stall until there&apos;s an empty position in the
buffer</strong>.</p></li>
</ul>
<h4><span id="bwrite-back">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Write-back</span></h4>
<p>&#x2003;&#x2003;When a write occurs, the new value is written only to the block in
the cache. The modified block is written to the lower level of the
hierarchy when <strong>it&apos;s replaced</strong>. This scheme is called
<em>write-back</em>. It can improve performance especially if
<strong>processors can generate writes faster than writes can be handled
by the main memory</strong>.</p>
<ul>
<li><p>In the write-through process, we can simply overwrite the block.
But in a write-back process, if we overwrite a block <strong>before we
knew whether the store had hit the cache</strong>, we may destroy the
contents of the block which isn&apos;t backed up. To avoid this, we take the
two methods:</p>
<ul>
<li><p>We use two cycles, one to <strong>check for hit</strong> and one
to <strong>perform the write</strong>.</p></li>
<li><p>Or we can use a <em>store buffer</em> to hold the data. When it&apos;s
used, the processor does the cache lookup and <strong>places the data in
the store buffer during the normal cache access cycle</strong>. The new
data <strong>are written from the store buffer into the cache on the
next unused cache access cycle</strong>.</p></li>
</ul></li>
</ul>
<blockquote>
<p>By comparison, we can always use one cycle to do writing in
write-through process. We read the tag and write the data portion of the
selected block. If the tag matches the address of the current block, the
processor continues normally, since the correct block has been updated.
Otherwise, the processor <strong>generates a write miss to fetch the
rest of the block corresponding to that address</strong>.</p>
</blockquote>
<p>&#x2003;&#x2003;Many write-back caches also include <em>write buffers</em> that are
used to <strong>reduce the miss penalty when a miss replaces a modified
block</strong>. In such a case, <strong>the modified block is moved to a
write-back buffer associated with the cache</strong> while the requested
block is read from memory. The write-back buffer is later written back
to memory.</p>
<blockquote>
<p>The main idea is not to touch the main memory as much as
possible.</p>
</blockquote>
<p><img src="/2024/06/14/4-1-Caches/image-11.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-20.png"></p>
<h4><span id="cwrite-allocate-amp-nowrite-allocate">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Write-allocate &amp; No
write-allocate</span></h4>
<p>&#x2003;&#x2003;In write-through process, to deal with the write miss, we
<strong>allocate a block in the cache called write allocate</strong>.
The block is fetched from memory and then the appropriate portion of the
block is overwritten.</p>
<blockquote>
<p>This reduces the number of accesses to main memory and increases the
speed of access.</p>
</blockquote>
<p>&#x2003;&#x2003;Another strategy is to update the portion of the block <strong>in
memory but not put it in the cache</strong>. This is because sometimes
we need to write in the entire blocks of data, and in such situation
writing in cache is unnecessary.</p>
<p><img src="/2024/06/14/4-1-Caches/image-21.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-22.png"></p>
<blockquote>
<p>Since write-through strategy ensures the consistence between memory
and cache, if we use write-allocate strategy, the cache will contain
reduntant data block, which makes cache management more difficult.</p>
<p>And for write-back, this ensures the data consistence.</p>
</blockquote>
<h4><span id="danexample">&#x2003;&#x2003;<span class="math inline">\(d.\)</span>An
example</span></h4>
<p><img src="/2024/06/14/4-1-Caches/image-7.png"></p>
<p>&#x2003;&#x2003;In this design, the steps for reading request are as follows:</p>
<ol type="1">
<li><p>Send the address to the appropriate cache.</p></li>
<li><p>If the cache signal hit, the requested word is available on the
data lines. A <em>block index</em> field is used to control the
multiplexor to select the required word from the 16 words in the indexed
block.</p></li>
<li><p>If the cache signals miss, <strong>we send the address to the
main memory. When the memory returns with the data</strong>, we write it
into the cache and then read it to fulfill the request.</p></li>
</ol>
<h3><span id="6cache-performanceimprovement">6.Cache performance
improvement</span></h3>
<p>&#x2003;&#x2003;There are two different techniques to improve cache performance.
One focuses on reducing the miss rate by <strong>reducing the
probability that two distinct memory blocks will contend for the same
cache location</strong>. The other reduces the miss penalty by
<strong>adding an additional level to the hierarchy</strong>. The second
technique is called <em>multilevel caching</em>.</p>
<h4><span id="amore-flexible-placement-of-blocks">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>More flexible placement of blocks</span></h4>
<ul>
<li><p><em>Fully associative</em>: In this scheme, a block can be placed
in <strong>any location in the cache</strong>, that is, <strong>the
block may be associated with any entry in the cache</strong>.</p>
<ul>
<li><p>To find a given block in a fully-associative cache, <strong>all
the entries in the cache must be searched</strong>.</p></li>
<li><p>This process is done <strong>in parallel with a comparator
associated with each cache entry</strong>. This comparators
significantly increase the hardware cost, so the scheme only suits for
caches with small numbers of blocks.</p></li>
</ul></li>
<li><p><em>Set associative</em>: In this scheme, there are a fixed
number of locations where each block can be placed. An <em>n-way set
associative</em> cache consists of a number of sets, each of which has
<span class="math inline">\(n\)</span> blocks.</p></li>
</ul>
<p><img src="/2024/06/14/4-1-Caches/image-8.png"></p>
<p>&#x2003;&#x2003;The advantage of increasing the degree of associativity is that
<strong>it usually decrease the miss rate</strong>. However, there&apos;s
little further improvement in going to rather higher associativity.</p>
<h4><span id="blocating-a-block-in-the-cache">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Locating a block in the cache</span></h4>
<p>&#x2003;&#x2003;Let&apos;s first take a block in a set-associative cache for
example:</p>
<p><img src="/2024/06/14/4-1-Caches/image-9.png"></p>
<ul>
<li><p>The <em>tag</em> is checked to see <strong>if it matches the
block address from the processor</strong>.</p></li>
<li><p>The <em>index</em> is used to <strong>select the set containing
the address of interest</strong>.</p></li>
<li><p>All the tags in the selected set are searched <strong>in
parallel</strong>.</p></li>
</ul>
<p>&#x2003;&#x2003;In a direct-mapped cache, only a single comparator is needed, and
we access the cache simply by indexing. In a <em>four-way
set-associative</em> cache, four comparators are needed, together with a
<strong>4-to-1 multiplexor to choose among the four potential
sets</strong>. The cache access consists of indexing the appropriate set
and then searching the tags of the set.</p>
<p><img src="/2024/06/14/4-1-Caches/image-10.png"></p>
<p>&#x2003;&#x2003;The choice among these three scheme depends on <strong>the cost of
a miss</strong> versus <strong>the cost of implementing
associativity</strong>.</p>
<h4><span id="cchoosing-which-block-to-replace">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Choosing which block to replace</span></h4>
<p>&#x2003;&#x2003;There are two primary strategies for replacement in set-associative
or fully associative caches:</p>
<ul>
<li><p><em>Random</em>: Candidate blocks are randomly selected, possibly
using some hardware assistance.</p></li>
<li><p><em>Least recently used</em>(LRU): The block replaced is the one
that has been unused for the longest time.</p></li>
</ul>
<p>&#x2003;&#x2003;In practice, LRU is too costly to implement for hierarchies with
more than a small degree of associativity, since <strong>tracking the
usage information is expensive</strong>.</p>
<h5><span id="iapproximate-lru">&#x2003;&#x2003;<span class="math inline">\(i.\)</span>Approximate LRU</span></h5>
<p><img src="/2024/06/14/4-1-Caches/image-23.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-24.png"></p>
<h4><span id="dmultilevel-caches">&#x2003;&#x2003;<span class="math inline">\(d.\)</span>Multilevel caches</span></h4>
<p>&#x2003;&#x2003;To close the gap between the fast clock rates of processors and the
long time to access DRAMs, most microprocessors support <strong>an
addition level of caching</strong>.</p>
<ul>
<li><p>The second-level cache is normally on the chip, and is access
<strong>whenever a miss occurs in the primary cache</strong>.</p></li>
<li><p>If the second-level cache contains the desired data, the miss
penalty for the first-level cache will be <strong>the access time of the
second-level cache</strong>, which is much less time.</p></li>
</ul>
<p>&#x2003;&#x2003;The design considerations for a primary and secondary cache are
different. This two-level structure allows the primary cache to focus on
<strong>minimizing hit time</strong> to yield a shorter clock cycle or
fewer pipeline stages, while allowing the second cache to focus on
<strong>miss rate</strong> to reduce the penalty of long memory access
times.</p>
<ul>
<li><p>The primary cache is <strong>smaller</strong>, and may use
<strong>a smaller block size</strong> to go with the smaller cache size
and reduce miss penalty.</p></li>
<li><p>The second cache will be <strong>much larger than in a
single-level cache</strong>. It also use higher associativity than the
primary cache, both for reducing the miss rates.</p></li>
</ul>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-41.png"></p>
<h3><span id="7three-cs">7.Three Cs</span></h3>
<p>&#x2003;&#x2003;In the hierarchy model, all misses are classified into one of three
categories:</p>
<ul>
<li><p>Compulsory misses: These are cache misses caused by <strong>the
first access to a block that has never been in the cache</strong>. These
are also called cold-start misses.</p></li>
<li><p>Capacity misses: These are cache misses caused when <strong>the
cache cannot contain all the blocks needed during execution of a
program</strong>. Capacity misses occur <strong>when blocks are replaced
and then later retrieved</strong>.</p></li>
<li><p>Conflict misses: These are cache misses that occur in
set-associative or direct-mapped caches when <strong>multiple blocks
compete for the same set</strong>. These cache misses are also called
collision misses.</p></li>
</ul>
<hr>
<ul>
<li><p>Increasing associativity reduces conflict misses, but
associativity may <strong>slow access time</strong>, leading to lower
overall performance.</p></li>
<li><p>Capacity misses can be reduced by enlarging the cache(so
second-level caches is large). Meanwhile, when we make the cache larger,
we must also be careful about <strong>increasing the access
time</strong>(so the first-level caches is small).</p></li>
<li><p>Since compulsory misses are generated by the first reference to a
block, we can simple increase the block size to reduce the block
number.</p></li>
</ul>
<h3><span id="8using-fsm-to-control-acache">8.Using FSM to control a
cache</span></h3>
<h4><span id="afinite-state-machines">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Finite-State Machines</span></h4>
<p>&#x2003;&#x2003;A FSM consists of a set of states and directions on how to change
states.</p>
<ul>
<li><p>The directions are defined by a <em>next-state function</em>,
which maps the current state and the inputs to a new state.</p></li>
<li><p>Each state of FSM specifies a set of outputs that are asserted
when the machine is in this state.</p></li>
<li><p>A FSM can be implemented with a temporary register that
<strong>holds the current state</strong> and <strong>a block of
combinatinoal logic</strong> that determines both the data-path signals
to be asserted and the next state.</p></li>
</ul>
<p><img src="/2024/06/14/4-1-Caches/image-12.png"></p>
<h4><span id="bcontroller">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Controller</span></h4>
<p><img src="/2024/06/14/4-1-Caches/image-13.png"></p>
<ul>
<li><p><em>Ideal</em>: This state <strong>waits for a valid read or
write request from the processor</strong>, which <strong>moves the FSM
to the Compare Tag state</strong>.</p></li>
<li><p><em>Compare Tag</em>: This state tests to see <strong>if the
requested read or write is a hit or a miss</strong>. The index portion
of the address <strong>selects the tag to be compared</strong>. If the
data in the cache block referred to by the index portion of the address
are valid, and the tag portion of the address matches the tag, then it
is a hit. Either the data are read from the selected word if it is a
load or written to the selected word if it is a store. The Cache Ready
signal is then set. <strong>If it is a write,the dirty bit is set to
1</strong>. Note that a write hit also sets the valid bit and the tag
field; while it seems unnecessary, it is included because the tag is a
single memory, so <strong>to change the dirty bit we likewise need to
change the valid and tag fields</strong>. If it is a hit and the block
is valid, the FSM <strong>returns to the idle state</strong>. A miss
<strong>first updates the cache tag</strong> and then goes either to the
Write-Back state, if the block at this location has dirty bit value of
1, or to the Allocate state if it is 0.</p></li>
<li><p><em>Write-Back</em>: This state writes the 128-bit block to
memory using <strong>the address composed from the tag and cache
index</strong>. We remain in this state waiting for the Ready signal
from memory. When the memory write is complete, the FSM <strong>goes to
the Allocate state</strong>.</p></li>
<li><p><em>Allocate</em>: The new block <strong>is fetched from
memory</strong>. We <strong>remain in this state waiting for the Ready
signal from memory</strong>. When the memory read is complete, the FSM
goes to the Compare Tag state.</p></li>
</ul>
<h3><span id="9fully-associative-cacheintroduction">9.Fully associative cache
introduction</span></h3>
<p><img src="/2024/06/14/4-1-Caches/image-14.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-15.png"></p>
<h3><span id="10direct-mapped-cacheintroduction">10.Direct-mapped cache
introduction</span></h3>
<p><img src="/2024/06/14/4-1-Caches/image-16.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-17.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-29.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-30.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-31.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-32.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-33.png"></p>
<h3><span id="11set-associativeintroduction">11.Set-associative
introduction</span></h3>
<p><img src="/2024/06/14/4-1-Caches/image-18.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-19.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-34.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-35.png"></p>
<h3><span id="12fully-associativeintroduction">12.Fully-associative
introduction</span></h3>
<p><img src="/2024/06/14/4-1-Caches/image-25.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-26.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-27.png"></p>
<h3><span id="13analyzing-cache-performance">13.Analyzing cache performance</span></h3>
<p><img src="/2024/06/14/4-1-Caches/image-36.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-37.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-38.png"></p>
<hr>
<p><img src="/2024/06/14/4-1-Caches/image-39.png"></p>
<p><img src="/2024/06/14/4-1-Caches/image-40.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/06/07/3-5-Pipelined-Datapath-and-Control/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/07/3-5-Pipelined-Datapath-and-Control/" class="post-title-link" itemprop="url">3.5.Pipelined Datapath and Control</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-06-07 11:36:22" itemprop="dateCreated datePublished" datetime="2024-06-07T11:36:22+08:00">2024-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-15 17:54:39" itemprop="dateModified" datetime="2024-06-15T17:54:39+08:00">2024-06-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">CS61C Great Ideas in Computer Architecture</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/Module-3-Program-Process/" itemprop="url" rel="index"><span itemprop="name">Module 3.Program Process</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>3.4k</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>12 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="35pipelined-datapath-and-control"><span class="math inline">\(3.5.\)</span>Pipelined Datapath and Control</span></h1>
<h3><span id="1some-point">1.Some point</span></h3>
<ul>
<li><p>All the instructions go from left to right through the datapath
except the write-back stage and the selection of the next value of PC,
and they never move backward.</p>
<ul>
<li>So the first right-to-left flow of data can lead to data hazards
while the second leads to control hazards.</li>
</ul></li>
<li><p>One way to show what happens in pipelined execution is to pretend
that each instruction has its own datapath, and then to place these
datapaths on a timeline to show their relationship:</p></li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image.png"></p>
<p>&#x2003;&#x2003;All instructions advance during each clock cycle from one pipeline
register to the next.</p>
<h3><span id="2pipeline-registers">2.Pipeline registers</span></h3>
<ul>
<li><p>A separate pipeline register is redundant to the state that is
updated. For example, a load instruction will place its result in one of
the 32 registers, and any later instruction that needs that data will
<strong>simply read the appropriate register</strong>.</p>
<ul>
<li>Every instruction updates PC, and the PC can be thought of as a
pipeline register: one <strong>that feeds the IF stage of the
pipeline</strong>.</li>
</ul></li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-1.png"></p>
<p>&#x2003;&#x2003;We use the command <code>ld</code> to illustrate the pipe stage
that is active in each stage:</p>
<ol type="1">
<li><em>Instruction fetch</em>: The PC is saved in the IF/ID pipeline
register in case it&apos;s needed later for an instruction. This stage occurs
<strong>before the instruction is identified</strong>.</li>
</ol>
<blockquote>
<p>The computer cannot know which type of instruction is being fetched,
so it must <strong>prepare for any instruction, passing potentially
needed information down the pipeline</strong>.</p>
</blockquote>
<ol start="2" type="1">
<li><em>Instruction decode and register file read</em>: Both the two
read value and sign-extended immediate are stored in the ID/EX pipeline
register, along with PC address.</li>
</ol>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-2.png"></p>
<ol start="3" type="1">
<li><em>Execute/address calculation</em>: It reads the information from
the ID/EX pipeline register and add then using ALU. The result is placed
in EX/MEM pipeline register.</li>
</ol>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-3.png"></p>
<ol start="4" type="1">
<li><em>Memory access</em>: It uses the data from EX/MEM register and
loads the data into MEM/WB pipeline register.</li>
</ol>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-4.png"></p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-5.png"></p>
<ol start="5" type="1">
<li><em>Write back</em>: There&apos;s nothing to do in this stage.</li>
</ol>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-6.png"></p>
<p>&#x2003;&#x2003;From the analysis above, we can get some key point:</p>
<ul>
<li><p>The information must be placed in a pipeline register, otherwise,
<strong>the information is lost when the next instruction enters that
pipeline stage</strong>.</p></li>
<li><p>Each logical component of the datapath(ALU, data memory, etc),
can be used <strong>only within a single pipeline stage</strong>. That
is, <strong>each pipeline register can only be used by one phase in one
clock cycle</strong>, which ensures that <strong>no more than one
instruction can access the same hardware resources simultaneously in one
clock cycle</strong>, thus avoiding structural dangers.</p></li>
</ul>
<p>&#x2003;&#x2003;We know that the instruction in IF/ID pipeline register supplies
the writer register number, but the instruction fetch procedure occurs
after the <code>ld</code> instruction(because it is conducted before an
instruction is identified, so only when we complete the <code>ld</code>
instruction will this step be done)! Hence, we need to <strong>preserve
the distination register number in the <code>ld</code>
instruction</strong>. The <code>ld</code> must pass the register number
from ID/EX through EX/MEM to the MEM/WB pipeline register for use in the
WB stage.</p>
<h3><span id="3data-hazards-amp-forwarding">3.Data hazards &amp; forwarding</span></h3>
<h4><span id="adatahazards">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Data
hazards</span></h4>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-7.png"></p>
<h4><span id="bdetact-hazards">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Detact hazards</span></h4>
<p>&#x2003;&#x2003;We first introduce a notation: we use &quot;ID/EX.RegisterRs1&quot; to refer
to the number of 1 register whose value is found in the pipeline
register ID/EX.</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-8.png"></p>
<p>&#x2003;&#x2003;Using this notation, the two pairs of hazard conditions are:</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-9.png"></p>
<ul>
<li>The <code>sub-and</code> is a type 1a hazard:</li>
</ul>
<p><span class="math display">\[
MEM/WB.RegisterRd=ID/EX.RegisterRs2=x2
\]</span></p>
<ul>
<li><p>The <code>sub-or</code> is a type 2a hazard.</p></li>
<li><p>There&apos;s no data hazard between <code>sub</code> and
<code>sd</code> because <strong><code>sd</code> reads <code>x2</code>
the clock cycle after <code>sub</code> writes
<code>x2</code></strong>.</p></li>
</ul>
<blockquote>
<p>Pay attention to the clock cycle, not the name!!!</p>
</blockquote>
<p>&#x2003;&#x2003;One way to detact the hazards is simple <strong>check if the
<code>RegWrite</code> signal is active</strong>. This can be done by
<strong>examing the <code>WB</code> control field of the pipeline
register during the <code>EX</code> and <code>MEM</code>
stages</strong>.</p>
<blockquote>
<p>Recall that RISC-V requires that <code>x0</code> is taken as an
oprand value of 0, if an instruction in the pipeline has <code>x0</code>
as its destination, we want to <strong>avoid forwarding its possibly
nonzero value</strong>.</p>
</blockquote>
<h4><span id="csolution">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Solution</span></h4>
<p>&#x2003;&#x2003;If we can take the inputs to the ALU <strong>from any pipeline
register rather than just ID/EX</strong>, then we can forward the
correct data.</p>
<p>&#x2003;&#x2003;By <strong>adding multiplexors to the input of the ALU, and with
the proper controls</strong>, we can run the pipeline at full speed in
the presence of these data hazards:</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-10.png"></p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-11.png"></p>
<blockquote>
<p>Before forwarding, the ID/EX register has no need to include space to
hold the rs1 and rs2 fields, so they are added to ID/EX.</p>
</blockquote>
<h4><span id="ddetailed-detection-ampresolution">&#x2003;&#x2003;<span class="math inline">\(d.\)</span>Detailed detection &amp;
resolution</span></h4>
<ul>
<li><p>EX hazard:</p>
<ul>
<li>If there&apos;s a write operation and a load operation at the same time,
and the loaded object is under writting, then there&apos;s an EX hazard:</li>
</ul></li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-12.png"></p>
<p>&#x2003;&#x2003;This case forwards the result from the previous instruction to
either input of the ALU instead of the pipeline register EX/MEM</p>
<ul>
<li><p>MEM hazard</p>
<ul>
<li>If the writting part is just loaded.</li>
</ul></li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-13.png"> <img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-14.png"></p>
<blockquote>
<p>What happens when a register is read and written in the same clock
cycle? We assume that <strong>the write is in the first half of the
clock cycle and the read is in the second half</strong>, so the read
delivers what is written. As is the case for many implementations of
register files, we have no data hazard in this case.</p>
<p>As mentioned above, there is no hazard in the WB stage, because
<strong>we assume that the register file supplies the correct
result</strong> if the instruction in the ID stage reads the same
register written by the instruction in the WB stage.</p>
</blockquote>
<p>&#x2003;&#x2003;One complication occurs when we all read and write to a same
register:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add x1 x1 x2</span><br><span class="line">add x1 x1 x3</span><br><span class="line">add x1 x1 x4</span><br></pre></td></tr></table></figure>
<p>&#x2003;&#x2003;In this case, <strong>the result should be forwarded from the MEM
stage, because the MEM stage is the more recent result</strong>. Thus,
the control for the MEM should be:</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-15.png"></p>
<blockquote>
<p>Why <code>not EX/MEM.RegisterRd = ID/EX.RegisterRs1</code>? Because
if this is true, then <strong>the instruction of EX/MEM should be
written back into the register</strong>(because it&apos;s the most current),
and it will cover the result of MEM/WB. So we take EX/MEM first.</p>
</blockquote>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-16.png"></p>
<h4><span id="estalls">&#x2003;&#x2003;<span class="math inline">\(e.\)</span>Stalls</span></h4>
<p>&#x2003;&#x2003;One case where forwarding cannot help is when <strong>an
instruction tries to read a register following a load instruction that
writes the same register</strong>:</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-17.png"></p>
<blockquote>
<p>The RAM is used by <code>add</code> before it&apos;s updated, and it won&apos;t
be updated until the <code>lw</code> ends. Since it must be used in the
first step, forwarding cannot help.</p>
</blockquote>
<p>&#x2003;&#x2003;Hence, we also need a <em>hazard detection unit</em>. It operates
during the ID stage so that it can insert the stall between the load and
the instruction depentent on it:</p>
<ul>
<li>If it&apos;s in a load process, and the being-loaded object involves in
other process.</li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-18.png"></p>
<p>&#x2003;&#x2003;If the instruction in the ID stage is stalled, then the instruction
in the IF stage must also be stalled, or we will lose the fetch of
instruction. Therefore, <strong>the instruction in the IF stage will
continue to be read using the same PC</strong>. The EX stage must also
be doing something, so we let it <strong>execute instructions that have
no effect: nops</strong>.</p>
<p>&#x2003;&#x2003;<strong>Deasserting all seven control signals(setting them to 0) in
the EX, MEM, WB stages</strong> will create a nop instruction:</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-19.png"></p>
<ul>
<li><p>The forwarding unit controls the ALU multiplexor s to replace the
value from a general-purpose register with that in the pipeline
register.</p></li>
<li><p>The hazard detection unit controls the writing of the PC and
IF/ID registers plus the multiplexor that choose between the real
control values and all 0s.</p></li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-20.png"></p>
<h3><span id="4control-hazards">4.Control hazards</span></h3>
<h4><span id="aassume-branch-not-taken">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Assume branch not taken</span></h4>
<p>&#x2003;&#x2003;We can assume the branch is not taken. If the condition branch is
taken instead, <strong>the instructions that are being fetched and
decoded must be discarded</strong>.</p>
<p>&#x2003;&#x2003;To discard instructions, we merely change the original control
values to 0s. Notice that we must also change the three instructions in
the IF, ID and EX stages when the branch reaches the MEM stage, which is
called <em>flush</em>.</p>
<p>&#x2003;&#x2003;To flush instructions in the IF, we <strong>add a control line
called IF.Flush</strong>, it zeros the instruction field of the IF/ID
pipeline register.</p>
<h4><span id="breducing-the-delay-of-branches">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Reducing the delay of branches</span></h4>
<p>&#x2003;&#x2003;One way to improve conditional branch performance is to reduce the
cost of taken branch. We have assumed that the next PC for a branch is
selected in the MEM stage, but <strong>if we move the conditional branch
execution earlier in the pipeline, then fewer instructions need be
flushed</strong>.</p>
<p>&#x2003;&#x2003;Moving the branch decision up requires two actions to occur
earlier: computing the branch target address and evaluating the branch
decision.</p>
<p>&#x2003;&#x2003;Moving up the address calculation is easy, we can <strong>move the
branch adder from EX stage to ID stage</strong>.</p>
<p>&#x2003;&#x2003;The harder part is branch decision itself. We must deal with two
complicate factors:</p>
<ol type="1">
<li><p>The introduction of equlity test unit.</p></li>
<li><p>Because <strong>the value in a branch comparison is needed during
ID but may be produced later in time</strong>, it is possible that a
data hazard can occur and a stall will be needed.</p></li>
</ol>
<h3><span id="5dynamic-branch-prediction">5.Dynamic branch prediction</span></h3>
<ul>
<li>This method looks up the address of the instruction to see
<strong>if the conditional branch was taken the last time this
instruction was executed</strong>, and, if so, to <strong>begin fetching
new instructions from the same place as the last time</strong>.</li>
</ul>
<p>&#x2003;&#x2003;One implementation of this approach is a <em>branch prediction
buffer</em> or <em>branch history table</em>. A branch prediction buffer
is a small memory indexed by the lower portion of the address of the
branch instruction. The memory contains <strong>a bit that says whether
the branch was recently taken or not</strong>.</p>
<ul>
<li>Fetching begins in the predicted direction. If the predition turns
out to be wrong, the incorrectly predicted instructions are deleted, the
predition bit is inverted and stored back, and the proper sequence is
fetched and executed.</li>
</ul>
<blockquote>
<p>&#x2003;&#x2003;To improve the accuracy, the <em>2-bit prediction schemes</em> are
often used. In a 2-bit scheme, <strong>a prediction must be wrong twive
before it is changed</strong>:</p>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-21.png"></p>
</blockquote>
<hr>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-22.png"></p>
<h3><span id="5parallelism-via-instruction">5.Parallelism via instruction</span></h3>
<h4><span id="apipelining">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Pipelining</span></h4>
<p>&#x2003;&#x2003;Exploiting the potential parallelism among instructions is called
<em>instruction-level parallelism</em>.</p>
<ul>
<li><p>The first is <strong>increasing the depth of the pipeline to
overlap more instructions</strong>.</p></li>
<li><p>We also need to <strong>reblance the remaining steps so they are
the same length</strong>.</p></li>
<li><p>Another approach is to <strong>replicate the internal components
so that it can launch multiple instruction in every pipeline
stage</strong>. The general name of this approach is <em>multiple
issue</em>.</p></li>
</ul>
<h4><span id="bmultiple-issue-processor">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Multiple issue processor</span></h4>
<p>&#x2003;&#x2003;There are two main ways to implement a multiple-issue processor,
with the major difference being <strong>the division of work between the
compiler and the hardware</strong>. One is called <em>static multiple
issue</em> and the other <em>dynamic multiple issue</em>.</p>
<p>&#x2003;&#x2003;There are two primary distinct responsibilities within a
multiple-issue pipeline:</p>
<ol type="1">
<li><p>Packaging instructions into <em>issue slots</em>. It refers to
<strong>the position from which instructions could issue in a given
clock cycle</strong>. In dynamic multiple issue, it is normally dealt
with <strong>at runtime by processor</strong>.</p></li>
<li><p>Dealing with data and control hazards. The compiler handles it
statically. In contrast, most dynamic issue processors attempt to
alleviate them <strong>using hardware techniques operation at execution
time</strong>.</p></li>
</ol>
<h4><span id="cspeculation-conceptsextracted-fromtextbook">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Speculation concepts(extracted from
textbook)</span></h4>
<p>&#x2003;&#x2003;Speculation is an approach that <strong>allows the
compilator/processor to &quot;guess&quot; about the properties of an
instruction</strong>. Any speculation mechanism must include both a
method to <strong>check if the guess was right</strong> and a method to
<strong>unroll or back out the effects of the instructions that were
executed speculatively</strong>.</p>
<p>&#x2003;&#x2003;Speculation may be done in the compiler or by the hardware. For
example,the compiler can use speculation to <strong>reorder
instructions, moving an instruction across a branch or a load across a
store</strong>. The processor hardware can perform the same
transformation at runtime using techniques we discuss later in this
section.</p>
<p>&#x2003;&#x2003;The recovery mechanisms used for incorrect speculation are rather
different. In the case of speculation in software, the compiler usually
<strong>inserts additional instructions that check the accuracy of the
speculation and provide a fix-up routine to use when the speculation is
wrong</strong>. In hardware speculation, the processor usually
<strong>buffers the speculative results until it knows they are no
longer speculative</strong>. If the speculation is correct, the
instructions are completed by <strong>allowing the contents of the
buffers to be written to the registers or memory</strong>. If the
speculation is incorrect, the hardware flushes the buffers and
re-executes the correct instruction sequence. Misspeculation typically
requires the pipeline to be flushed, or at least stalled, and thus
further reduces performance.</p>
<p>&#x2003;&#x2003;Speculation introduces one other possible problem: speculating on
certain instructions may <strong>introduce exceptions that were formerly
not present</strong>. For example, suppose a load instruction is moved
in a speculative manner, but the address it uses is not within bounds
when the speculation is incorrect. The result would be that an exception
that should not have occurred would occur. The problem is complicated by
the fact that if the load instruction were not speculative, then the
exception must occur! In compiler-based speculation, such problems are
avoided by <strong>adding special speculation support that allows such
exceptions to be ignored until it is clear that they really should
occur</strong>. In hardware-based speculation, <strong>exceptions are
simply buffered until it is clear that the instruction causing them is
no longer speculative and is ready to complete;</strong> at that point,
the exception is raised,and normal exception handling proceeds.</p>
<h4><span id="dstatic-multiple-issue">&#x2003;&#x2003;<span class="math inline">\(d.\)</span>Static multiple issue</span></h4>
<p>&#x2003;&#x2003;Static multiple-issue processors all use the compiler to assist
with packaging instructions and handling hazards. In a static issue
processor, we can think of the set of instructions issued in a given
clock cycle called <em>issue packet</em>. And it&apos;s useful to think of
the issue packet as a single instuction allowing weveral operations in
certain predefined fields.</p>
<p>&#x2003;&#x2003;When it comes to the certain instructions:</p>
<ul>
<li><p>We require that the instructions <strong>be paired and aligned on
a 64-bit boundary</strong>.</p></li>
<li><p>If on instruction of the pair cannot be used, we require that
<strong>it be replaced with nop</strong>.</p></li>
</ul>
<p>&#x2003;&#x2003;However, the overlapping of instructions <strong>increase the
relative performance loss from data and control hazards</strong>.</p>
<blockquote>
<p>For example, in our simple five-stage pipeline, loads have a use
latency of one clock cycle, which <strong>prevents one instruction from
using the result without stalling</strong>. In the two-issue, five-stage
pipeline the result of a load instruction <strong>cannot be used on the
next clock cycle</strong>. This means that the next two instructions
cannot use the load result without stalling.</p>
</blockquote>
<p>&#x2003;&#x2003;An important compiler technique to get more performance from loops
is <em>loop unrolling</em>:</p>
<ul>
<li>Say we are going to deal with this program:</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) {</span><br><span class="line">    A[i] = B[i] + C[i];</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Loop:</span><br><span class="line">    ld  x1, 0(xA)       ; Load A[i]</span><br><span class="line">    ld  x2, 0(xB)       ; Load B[i]</span><br><span class="line">    ld  x3, 0(xC)       ; Load C[i]</span><br><span class="line">    add x4, x2, x3      ; A[i] = B[i] + C[i]</span><br><span class="line">    sd  0(xA), x4       ; Store A[i]</span><br><span class="line">    addi xA, xA, 8      ; Increment A pointer</span><br><span class="line">    addi xB, xB, 8      ; Increment B pointer</span><br><span class="line">    addi xC, xC, 8      ; Increment C pointer</span><br><span class="line">    addi xI, xI, 1      ; Increment loop counter</span><br><span class="line">    blt  xI, 8, Loop    ; Branch if loop counter &lt; 8</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2003;&#x2003;We can do this iteration part for more times:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">4</span>) {</span><br><span class="line">    A[i]   = B[i]   + C[i];</span><br><span class="line">    A[i+<span class="number">1</span>] = B[i+<span class="number">1</span>] + C[i+<span class="number">1</span>];</span><br><span class="line">    A[i+<span class="number">2</span>] = B[i+<span class="number">2</span>] + C[i+<span class="number">2</span>];</span><br><span class="line">    A[i+<span class="number">3</span>] = B[i+<span class="number">3</span>] + C[i+<span class="number">3</span>];</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Loop:</span><br><span class="line">    ld  x1, 0(xA)       ; Load A[i]</span><br><span class="line">    ld  x2, 0(xB)       ; Load B[i]</span><br><span class="line">    ld  x3, 0(xC)       ; Load C[i]</span><br><span class="line">    add x4, x2, x3      ; A[i] = B[i] + C[i]</span><br><span class="line">    sd  0(xA), x4       ; Store A[i]</span><br><span class="line"></span><br><span class="line">    ld  x5, 8(xA)       ; Load A[i+1]</span><br><span class="line">    ld  x6, 8(xB)       ; Load B[i+1]</span><br><span class="line">    ld  x7, 8(xC)       ; Load C[i+1]</span><br><span class="line">    add x8, x6, x7      ; A[i+1] = B[i+1] + C[i+1]</span><br><span class="line">    sd  8(xA), x8       ; Store A[i+1]</span><br><span class="line"></span><br><span class="line">    ld  x9, 16(xA)      ; Load A[i+2]</span><br><span class="line">    ld  x10, 16(xB)     ; Load B[i+2]</span><br><span class="line">    ld  x11, 16(xC)     ; Load C[i+2]</span><br><span class="line">    add x12, x10, x11   ; A[i+2] = B[i+2] + C[i+2]</span><br><span class="line">    sd  16(xA), x12     ; Store A[i+2]</span><br><span class="line"></span><br><span class="line">    ld  x13, 24(xA)     ; Load A[i+3]</span><br><span class="line">    ld  x14, 24(xB)     ; Load B[i+3]</span><br><span class="line">    ld  x15, 24(xC)     ; Load C[i+3]</span><br><span class="line">    add x16, x14, x15   ; A[i+3] = B[i+3] + C[i+3]</span><br><span class="line">    sd  24(xA), x16     ; Store A[i+3]</span><br><span class="line"></span><br><span class="line">    addi xA, xA, 32     ; Increment A pointer by 4</span><br><span class="line">    addi xB, xB, 32     ; Increment B pointer by 4</span><br><span class="line">    addi xC, xC, 32     ; Increment C pointer by 4</span><br><span class="line">    addi xI, xI, 4      ; Increment loop counter by 4</span><br><span class="line">    blt  xI, 8, Loop    ; Branch if loop counter &lt; 8</span><br></pre></td></tr></table></figure>
<p>&#x2003;&#x2003;This operation has the following advantages:</p>
<ol type="1">
<li><p><strong>Reduce cycle control overhead</strong>: cycle control
operations are less frequent when the cycle is expanded. In the above
example, the loop control operation is reduced from one generation per
generation to one generation per four.</p></li>
<li><p><strong>Increase instruction level parallelism</strong>: the more
instructions expanded, the compiler can better schedule these
instructions, improve parallelism.</p></li>
<li><p><strong>Reduced branch prediction failure</strong>: the
probability of branch prediction failure is reduced due to the reduction
in the number of branch instructions and the frequency of loop control
operations.</p></li>
</ol>
<p>&#x2003;&#x2003;During the unrolling process, the compiler introduce additional
registers. The goal of the process, called <em>register renaming</em>,
it to <strong>eliminate dependences that are not true data
dependences</strong>, but could either lead to potential hazards or
prevent the compiler from flexibly scheduling the code.</p>
<h4><span id="edynamic-multiple-issue-processor">&#x2003;&#x2003;<span class="math inline">\(e.\)</span>Dynamic multiple-issue processor</span></h4>
<p>&#x2003;&#x2003;Dynamic multiple-issue processors are also known as <em>superscalar
processors</em>.</p>
<p>&#x2003;&#x2003;Many superscalars extend the basic framework of dynamic issue
decisions to include <em>dynamic pipeline scheduling</em>. Dynamic
pipeline scheduling <strong>chooses which instructions to execute in a
given clock cycle while trying to avoid hazards and stalls</strong>.</p>
<ul>
<li><p><em>Dynamic pipeline scheduling</em> <strong>chooses which
instructions to execute next, possibly reordering them to avoid
stalls</strong>. The pipeline is divided into three major units: an
instruction fetch and issue unit, multiple functional units, and a
commit unit.</p>
<ul>
<li><p>The first unit fetch instructions, decodes them and sends them to
corresponding function unit for execution.</p></li>
<li><p>Each function unit has <em>buffers</em> called <em>reservation
stations</em>, which <strong>hold the operands and the
operation</strong>. As soon as the buffer contains all its operands and
the functional unit is ready to execute, the result calculated. The
result is sent to <strong>any reservation stations waiting for this
particular result</strong> and <strong>the commit
unit</strong>.</p></li>
<li><p>The commit unit <strong>buffers the result until it&apos;s safe to put
the result into the register file/memory</strong>. The buffer in the
commit unit, often called the <em>reorder buffer</em>, is also used to
supply operands.</p></li>
<li><p>Once a result is committed to the register file, it can be
fetched directly from there like in a normal pipeline.</p></li>
</ul></li>
</ul>
<p><img src="/2024/06/07/3-5-Pipelined-Datapath-and-Control/image-23.png"></p>
<blockquote>
<p>If an operand is not in the register file or reorder buffer, it must
<strong>be waiting to be produced by a functional unit</strong>.
<strong>The name of the functional unit that will produce the result is
tracked</strong>. When that unit eventually produces the result,
<strong>it is copied directly into the waiting reservation
statio</strong>n from the functional unit bypassing the registers.</p>
</blockquote>
<p>&#x2003;&#x2003;We may think of a dynamically scheduled pipeline as an
<em>out-of-order execution</em>. To make programs behave as if they were
running on a simple in-order pipeline, the instruction fetch and decode
unit is required to <strong>issue instructions in order</strong>, which
allows dependences to be tracked, and the commit unit is required to
<strong>write results to registers and memory in program fetch
order</strong>. This conservative mode is called <em>in-order
commit</em>. Hence, if an exception occurs, the computer can point to
the last instruction executed.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/06/05/3-4-Building-a-Datapath/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/05/3-4-Building-a-Datapath/" class="post-title-link" itemprop="url">3.4.Building a Datapath</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-06-05 10:26:12" itemprop="dateCreated datePublished" datetime="2024-06-05T10:26:12+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-06 17:52:05" itemprop="dateModified" datetime="2024-06-06T17:52:05+08:00">2024-06-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">CS61C Great Ideas in Computer Architecture</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/Module-3-Program-Process/" itemprop="url" rel="index"><span itemprop="name">Module 3.Program Process</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>527</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="34building-a-datapath"><span class="math inline">\(3.4.\)</span>Building a Datapath</span></h1>
<h3><span id="1basic-devices">1.Basic devices</span></h3>
<ul>
<li><p><em>Registers</em>: It contains:</p>
<ul>
<li><p>Two data words from the register file, and <strong>write one data
word into the register file</strong> for each instruction.</p></li>
<li><p>An input. It <strong>specifies the register number to be
read</strong>.</p></li>
<li><p>An output. It <strong>carries the value that has been read from
the register</strong>.</p></li>
<li><p>To write a data word, we need two more inputs: one to
<strong>specify the register number to be written</strong> and one to
<strong>supply the data to be written into the
register</strong>.</p></li>
</ul></li>
</ul>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image.png"></p>
<ul>
<li><em>ALU</em></li>
</ul>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-1.png"></p>
<ul>
<li><em>Immediate generation unit</em>: In operations like
<code>addi x1 x2 10</code>, the immediate number <code>10</code> is
written in 12-bit offset in the instruction. So we need to
<strong>sign-extend the number to a 64-bit signed value</strong>. The
Imm-Gen does the job:</li>
</ul>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-4.png"></p>
<h3><span id="2basic-phases-ofinstruction-execution">2.Basic phases of
instruction execution</span></h3>
<p>&#x2003;&#x2003;The phases of instruction execution can be divided into 5
parts:</p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-2.png"></p>
<hr>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-3.png"></p>
<h3><span id="3implementation-ofdifferent-statement">3.Implementation of
different statement</span></h3>
<h4><span id="aaddinstruction">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Add
instruction</span></h4>
<p>&#x2003;&#x2003;The <code>add</code> is simple, we just get value from
<code>DataA</code> and <code>DataB</code>, and calculate the result by
ALU.</p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-7.png"></p>
<p>&#x2003;&#x2003;To perform <code>addi</code>, we get one of out input from Imm-Gen
rather than <code>DataB</code>. The source of Imm-Gen is from
<code>IMEM</code>, from which we can get the instruction, and
<code>inst[31:20]</code> is the immediate we want:</p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-8.png"></p>
<h4><span id="bload-ampsave-instruction">&#x2003;&#x2003;<span class="math inline">\(b.\)</span><code>load</code> &amp;
<code>save</code> instruction</span></h4>
<p>&#x2003;&#x2003;To implement the instructions, we can add a <code>DMEM</code> to
read or write data.</p>
<ul>
<li><code>DMEM</code>: It&apos;s input is <code>Addr</code> and outputs
<code>DataR</code>. When in &quot;read&quot; mode, it gets information from the
address. Else, it writes the information into the address:</li>
</ul>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-10.png"></p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-11.png"></p>
<h4><span id="cbranch-instruction">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Branch instruction</span></h4>
<p>&#x2003;&#x2003;The basic form of branch instruction is
<code>beq x1 x2 offset</code>. To implement this instruction, we must
compute the branch target address by <strong>adding the sign- extended
offset field of the instruction to the PC</strong>. There are two
details in the definition of branch instructions to which we must pay
attention:</p>
<ul>
<li><p>The instruction set architecture specifies that <strong>the base
for the branch address calculation is the address of the branch
instruction</strong>.</p></li>
<li><p>The architecture also states that <strong>the offset field is
shifted left 1 bit so that it is a half word offset</strong>; this shift
<strong>increases the effective range of the offset field by a factor of
2</strong>.</p></li>
</ul>
<p>&#x2003;&#x2003;If the branch condtion is true, the branch target address becomes
the new PC, and we say the branch is <strong>taken</strong>. Else, we
say the branch is <strong>not taken</strong>.</p>
<p>&#x2003;&#x2003;We first get the address of <code>PC+4</code> and branch through
this struction:</p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-5.png"></p>
<p>&#x2003;&#x2003;To select from multiple address, we use a multiplexor and control
signal</p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-6.png"></p>
<p>&#x2003;&#x2003;Combined with the previous struction, we get this design:</p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-9.png"></p>
<h4><span id="djal-ampjalr-instructions">&#x2003;&#x2003;<span class="math inline">\(d.\)</span><code>jal</code> &amp;
<code>jalr</code> instructions</span></h4>
<p>&#x2003;&#x2003;<code>jalr</code> does the following things:</p>
<ol type="1">
<li><p>Set <code>PC=Reg[rs1]+immediate</code></p>
<ul>
<li>Uses same immediate as arithmetic and loads. <strong>No multiple by
2 bytes!</strong></li>
</ul></li>
<li><p>Set <code>PC=PC+offset</code></p>
<ul>
<li>Since the offset is calculated by ALU, we <strong>connect the output
of ALU with input of PC</strong>.</li>
</ul></li>
</ol>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-12.png"></p>
<p>&#x2003;&#x2003;<code>jal</code> does the following things:</p>
<ol type="1">
<li>Save <code>PC+4</code> in <code>Reg[rd]</code>(namely
<code>DataD</code>)</li>
<li>Set <code>PC=PC+offset</code></li>
</ol>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-13.png"></p>
<h3><span id="4datapath-control">4.Datapath control</span></h3>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-14.png"></p>
<p><img src="/2024/06/05/3-4-Building-a-Datapath/image-15.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/06/05/3-3-Synchronous-Digital-Systems/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/05/3-3-Synchronous-Digital-Systems/" class="post-title-link" itemprop="url">3.3.Synchronous Digital Systems</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-06-05 08:29:11" itemprop="dateCreated datePublished" datetime="2024-06-05T08:29:11+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-06 17:48:39" itemprop="dateModified" datetime="2024-06-06T17:48:39+08:00">2024-06-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">CS61C Great Ideas in Computer Architecture</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/Module-3-Program-Process/" itemprop="url" rel="index"><span itemprop="name">Module 3.Program Process</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>419</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="33synchronous-digital-systems"><span class="math inline">\(3.3.\)</span>Synchronous Digital Systems</span></h1>
<h3><span id="1clock-concepts">1.Clock concepts</span></h3>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image.png"></p>
<h3><span id="2d-flip-flops">2.D Flip-flops</span></h3>
<h4><span id="a-dffconcept">&#x2003;&#x2003;<span class="math inline">\(a.\)</span> DFF
concept</span></h4>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-1.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-2.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-3.png"></p>
<blockquote>
<p>The <span class="math inline">\(Q\)</span> is the output of DFF, the
<span class="math inline">\(D\)</span> is the data input.</p>
</blockquote>
<blockquote>
<p>DFF only responds to the input signal on the rising edge of the clock
signal, it captures and latches the value of data input. <strong>It will
hold the value until the next rising edge of the clock
signal</strong>.</p>
</blockquote>
<ul>
<li><p><em>Clock-to-Q delay</em> is <strong>the amount of time that it
take for the input to propagate to the output after the clock
trigger</strong>.</p></li>
<li><p><em>Setup time</em> is the amount of time that the input needs to
be stable BEFORE the clock trigger</p></li>
</ul>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-4.png"></p>
<ul>
<li><em>Hold time</em> is the amount of time that the input needs to be
stable AFTER the clock trigger</li>
</ul>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-6.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-5.png"></p>
<h3><span id="3register">3.Register</span></h3>
<h4><span id="asomeconcept">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Some
concept</span></h4>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-7.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-8.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-9.png"></p>
<hr>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-10.png"></p>
<hr>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-11.png"></p>
<blockquote>
<p>Why this? Because the max hold time is to <strong>ensure that data
input D remains stable for a period of time after the rising edge of the
clock arrives</strong>. And the period of time equals to the delay of
<span class="math inline">\(A\)</span> plus the combinational delay.</p>
</blockquote>
<hr>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-12.png"></p>
<blockquote>
<p>Why this? Because the min clock cycle is to <strong>ensure that the
signal is properly transmitted during the clock cycle and captured by
the next register</strong>. So we must take the longest time into
consideration.</p>
</blockquote>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-13.png"></p>
<h3><span id="4transitor">4.Transitor</span></h3>
<h4><span id="ametal-oxide-semiconductor-field-effecttransistormosfet">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Metal-Oxide Semiconductor Field Effect
Transistor(MOSFET)</span></h4>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-14.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-15.png"></p>
<p>&#x2003;&#x2003;To know how the result comes from, we can <strong>view the value of
<span class="math inline">\(S\)</span>, <span class="math inline">\(G\)</span> and <span class="math inline">\(D\)</span> as the voltage</strong>. Take this as
an example:</p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-16.png"></p>
<ul>
<li><p>First we need to know <strong>whether the switch is
closed</strong>. <strong>If the switch is closed, then the state of
<span class="math inline">\(D\)</span> is decided by the outside
circuits</strong>.</p></li>
<li><p>When the switch is on, we then judge <strong>if the voltage of
<span class="math inline">\(S\)</span> is higher than that of <span class="math inline">\(G\)</span></strong>. If it&apos;s true, then the FET is
conducting, and vice versa.</p></li>
</ul>
<p>&#x2003;&#x2003;In this example, the voltage of <span class="math inline">\(S\)</span> is lower than <span class="math inline">\(G\)</span>, so the <span class="math inline">\(D\)</span> can&apos;t get the electronic, thus it&apos;s
0.</p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-17.png"></p>
<h4><span id="bvddand-ground">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Vdd
and Ground</span></h4>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-18.png"></p>
<h4><span id="cbuilding-an-inverter">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Building an Inverter</span></h4>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-19.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-20.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-21.png"></p>
<hr>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-22.png"></p>
<h4><span id="dbuilding-other-gates">&#x2003;&#x2003;<span class="math inline">\(d.\)</span>Building other gates</span></h4>
<p>&#x2003;&#x2003;To build a CMOS, we:</p>
<ol type="1">
<li><p>Implement the pull-up network and pull-down network separately to
fit the truth table.</p>
<ul>
<li>It&apos;s OK to get the opposite of truth table. <strong>We can simply
convert it through an invertor</strong>.</li>
</ul></li>
<li><p>Connect the pull-up with Vdd, and the pull-down with
Ground.</p></li>
</ol>
<p>&#x2003;&#x2003;We take the <code>NAND</code> gate for example:</p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-23.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-24.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-25.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-26.png"></p>
<hr>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-27.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-28.png"></p>
<hr>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-29.png"></p>
<h4><span id="ethe-use-of-demorgans-law">&#x2003;&#x2003;<span class="math inline">\(e.\)</span>The use of DeMorgan&apos;s Law</span></h4>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-30.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-31.png"></p>
<p><img src="/2024/06/05/3-3-Synchronous-Digital-Systems/image-32.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/06/04/3-2-Introduction-to-Digital-System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/04/3-2-Introduction-to-Digital-System/" class="post-title-link" itemprop="url">3.2.Introduction to Digital System</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-06-04 23:03:11" itemprop="dateCreated datePublished" datetime="2024-06-04T23:03:11+08:00">2024-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-05 08:19:08" itemprop="dateModified" datetime="2024-06-05T08:19:08+08:00">2024-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">CS61C Great Ideas in Computer Architecture</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/Module-3-Program-Process/" itemprop="url" rel="index"><span itemprop="name">Module 3.Program Process</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>208</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="32introduction-to-digital-system"><span class="math inline">\(3.2.\)</span>Introduction to Digital System</span></h1>
<h3><span id="1logic-gate-representation">1.Logic gate representation</span></h3>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-1.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-2.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-3.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-4.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-5.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-6.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-7.png"></p>
<h3><span id="2using-booleanalgebra-to-simplify-circuits">2.Using boolean
algebra to simplify circuits</span></h3>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-8.png"></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-9.png"></p>
<h3><span id="3build-an-adder">3.Build an Adder</span></h3>
<h4><span id="ahalfadder">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Half
adder</span></h4>
<p>&#x2003;&#x2003;A half adder&apos;s output consists of:</p>
<ul>
<li>The <em>sum</em>. It can be computed by <code>xor</code>
method.</li>
<li>The <em>carry</em>. It can be computed by <code>and</code>
method.</li>
</ul>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-10.png"></p>
<h4><span id="bfulladder">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Full
adder</span></h4>
<p>&#x2003;&#x2003;To implement full adder, we just need to add <code>A</code>,
<code>B</code> and the carry at the position <span class="math inline">\(C_i\)</span>.</p>
<p>&#x2003;&#x2003;The output of a full adder is the same as the half adder. Then how
can we calculate each of them?</p>
<ul>
<li><p>For <span class="math inline">\(C_0\)</span>, it&apos;s decided by the
sum of <code>A</code> and <code>B</code> &amp; the current carry in the
position. There are two cases that make the carry 1:</p>
<ol type="1">
<li><code>A + B</code> is 1, and current carry is 1.</li>
<li><code>A + B</code> is 2, and current carry can be 0 or 1.</li>
</ol></li>
</ul>
<p>&#x2003;&#x2003;So we can compute <span class="math inline">\(C_0\)</span> by this
expression:</p>
<p><span class="math display">\[
C_0 = C_i(A+B) + AB
\]</span></p>
<ul>
<li>The sum is easy, it becomes 1 when 1 or 3 of <code>A</code>,
<code>B</code> and current carry is 1:</li>
</ul>
<p><span class="math display">\[
S = A \; xor B \; xor C_i
\]</span></p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-11.png"></p>
<h4><span id="c4-bit-adder">&#x2003;&#x2003;{{c.}}4-bit Adder</span></h4>
<p>&#x2003;&#x2003;To make a multi-bit Adder, we simply <strong>connect full adder
together</strong>:</p>
<p><img src="/2024/06/04/3-2-Introduction-to-Digital-System/image-12.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/06/03/3-1-Translating-Starting-a-Program/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/03/3-1-Translating-Starting-a-Program/" class="post-title-link" itemprop="url">3.1.Translating &amp; Starting a Program</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-06-03 22:15:12" itemprop="dateCreated datePublished" datetime="2024-06-03T22:15:12+08:00">2024-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-04 08:19:21" itemprop="dateModified" datetime="2024-06-04T08:19:21+08:00">2024-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/" itemprop="url" rel="index"><span itemprop="name">CS61C Great Ideas in Computer Architecture</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61C-Great-Ideas-in-Computer-Architecture/Module-3-Program-Process/" itemprop="url" rel="index"><span itemprop="name">Module 3.Program Process</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>1k</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>4 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="31translating-amp-starting-aprogram"><span class="math inline">\(3.1.\)</span>Translating &amp; Starting a
Program</span></h1>
<h3><span id="1a-complex-example">1.A complex example</span></h3>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image.png"></p>
<p>&#x2003;&#x2003;When we are going to translate the program, we should follow the
following process:</p>
<ol type="1">
<li><p>Need to decide on what variables go in what registers</p></li>
<li><p>Need to determine which registers we need to save on function
entry (the function preamble/prolog)</p>
<ol type="1">
<li>Decrement the stack</li>
<li>Save all the callee saved registers we will use</li>
<li>Save ra or any other caller saved registers we need to live across
calls to other functions</li>
</ol></li>
<li><p>Translate the code itself</p></li>
<li><p>Restore all the registers necessary (the function
postamble/epilog)</p>
<ol type="1">
<li>Restore the callee saved registers we used</li>
<li>Restore <code>ra</code></li>
<li>Increment the stack</li>
</ol></li>
<li><p>Return using <code>jr</code></p></li>
</ol>
<p>&#x2003;&#x2003;There are some points in the process:</p>
<ul>
<li>Return <code>null</code>:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">li a0 0</span><br><span class="line">j postamble</span><br></pre></td></tr></table></figure>
<ul>
<li>When calling function, we can <strong>use the <code>call</code>
pseudo-instruction for <code>jal ra (location)</code></strong>. For
example, <code>call malloc</code>.</li>
</ul>
<h3><span id="2interpretation">2.Interpretation</span></h3>
<ul>
<li><p>Interpreter <strong>directly executes a program in the source
language</strong>.</p></li>
<li><p>Since interpreter <strong>is closer to high-level</strong>, it
can give better error messages during interpreting.</p></li>
<li><p>Because the interpreter executes intermediate representations
rather than direct machine code, <strong>the same source code can be run
from one machine to another without modification of the source
code</strong>.</p></li>
</ul>
<h3><span id="3calling-chain">3.Calling chain</span></h3>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-1.png"></p>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-2.png"></p>
<h3><span id="4compilation">4.Compilation</span></h3>
<h4><span id="aconcepts">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>Concepts</span></h4>
<p>&#x2003;&#x2003;The compiler transforms the C program into <strong>an assembly
language program</strong>, a symbolic form of what the machine
understands. High-level language programs take many fewer lines of code
than assembly language, so programmer productivity is much higher.</p>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-3.png"></p>
<h4><span id="bassembler">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>Assembler</span></h4>
<ul>
<li><p>The assembler <strong>converts the assembly language instruction
into machine language</strong>. It turns the assembly language program
into an <strong>object file, which is a combination of machine language
instructions, data, and information needed to place instructions
properly in memory.</strong></p></li>
<li><p>Assembler will also <strong>accept numbers in a variety of
bases</strong>.</p></li>
</ul>
<p>&#x2003;&#x2003;To produce the binary version of each instruction in the assembly
language program, the assembler must determine the address corresponding
to all labels. This is done by a <strong>symbol table</strong>.</p>
<ul>
<li><p>The object file for UNIX mainly consists of:</p>
<ul>
<li><p>The object file header describes <strong>the size and position of
the other pieces of the object file</strong>.</p></li>
<li><p>The text segment contains <strong>the machine language
code</strong>.</p></li>
<li><p>The static data segment contains <strong>data allocated for the
life of the program</strong>.</p></li>
<li><p>The relocation information identifies instructions and data words
that <strong>depend on absolute addresses when the program is loaded
into memory</strong>.</p></li>
<li><p>The symbol table contains <strong>the remaining labels that are
not defined</strong>, such as external references.</p>
<ul>
<li>Use <strong>dummy &quot;placeholders&quot;</strong> for unresolved absolute
and external references.</li>
</ul></li>
<li><p>The debugging information contains <strong>a concise description
of how the modules were compiled</strong>.</p></li>
</ul></li>
</ul>
<hr>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-4.png"></p>
<blockquote>
<p><span class="math inline">\(p.s.\)</span> The <code>auipc</code>
instruction <strong>adds an immediate number to the current PC
value</strong>. This means that the generated address <strong>is
relative to the current instruction</strong>. It add an offset to the PC
(upper 20 bits to the left of the instant number by 12 bits), and use
<code>addi</code> to load the lower 12 bits.</p>
<p><code>lui</code> instructions are used to generate absolute
addresses, which are fixed addresses of data in memory. This approach
works for memory addresses that do not move. It loads an instant number
to the upper 20 bits of the register.</p>
</blockquote>
<h4><span id="clinker">&#x2003;&#x2003;<span class="math inline">\(c.\)</span>Linker</span></h4>
<p>&#x2003;&#x2003;Linker is used for <strong>compiling and assembling each procedure
independently</strong>, so that a change to one line would require
resolving only one procedure. It&apos;s a system that <strong>combines
independently assembled machine language programs</strong> and
<strong>resolves all undefined labels into an executable
file</strong>.</p>
<p>&#x2003;&#x2003;There are three steps for the linker:</p>
<ol type="1">
<li>Place code and data modules symbolically in memory.</li>
<li>Determine the addresses of data and instruction labels.</li>
<li>Patch both the internal and external references.</li>
</ol>
<p>&#x2003;&#x2003;The linker uses the relocation information and symbol table in each
object module to <strong>resolve all undefined labels</strong>.</p>
<ul>
<li>For each entry in the relocation table, it replaces it with
<strong>the actual address for the symbol table of the item</strong> we
are linking to.</li>
</ul>
<p>&#x2003;&#x2003;If all external references are resolved, the linker next
<strong>determines the memory locations each module will
occupy</strong>. Since the files were assembled in isolation,
<strong>the assembler couldn&apos;t know where a module&apos;s instructions and
data would be placed relative to other modules</strong>. So when the
linker places a module in memory, all <strong>absolute references, that
is, memory addresses that are not relative to a register</strong>, must
<strong>be relocated to reflect its true location</strong>.</p>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-7.png"></p>
<h4><span id="dtype-of-addressing">&#x2003;&#x2003;<span class="math inline">\(d.\)</span>Type of addressing</span></h4>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-5.png"></p>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-6.png"></p>
<h4><span id="eloader">&#x2003;&#x2003;<span class="math inline">\(e.\)</span>Loader</span></h4>
<p><img src="/2024/06/03/3-1-Translating-Starting-a-Program/image-8.png"></p>
<h3><span id="5dynamically-linkedlibraries">5.Dynamically linked
libraries</span></h3>
<p>&#x2003;&#x2003;In tradition, before the program is run, the library has been
linked. Although this static approach is the fastest way to call library
routines,it has a few disadvantages:</p>
<ol type="1">
<li><p>The library routines become <strong>part of the executable
code</strong>. If a new version of the library is released, <strong>the
statically linked program keeps using the old version</strong>.</p></li>
<li><p>It loads <strong>all routines in the library that are called
anywhere in the executable</strong>, even if those calls are not
executed.</p></li>
</ol>
<p>&#x2003;&#x2003;A replacement of it is called <em>dynamically linked
libraries</em>, where the library routines are not linked and loaded
<strong>until the program is run</strong>.</p>
<ol type="1">
<li><p>The first time the library routine is called, the program
<strong>calls the dummy entry and follows the indirect branch</strong>,
which points to a piece of code.</p></li>
<li><p>The code <strong>puts a number in a register</strong> to
<strong>identify the desired library routine</strong>.</p></li>
<li><p>Then it branches to the dynamic linker/loader.</p></li>
<li><p>The linker/loader finds the wanted routine, <strong>remaps it
into the memory</strong>, and <strong>changes the address in the
indirect branch location to point to that routine</strong>. Then it
branches to it.</p></li>
</ol>
<blockquote>
<p>The dynamic linker loads the library function into memory on the
first call and updates the indirect branch address. In this way, if the
following call to the library function, the program can directly jump to
the correct memory address, avoid repeated symbol parsing and address
calculation, which improves the efficiency of the program.</p>
</blockquote>
<ol start="5" type="1">
<li>When the routine completes, it <strong>returns to the original
calling site</strong>.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/05/31/1.1-1.5%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%A6%82%E5%BF%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/31/1.1-1.5%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%A6%82%E5%BF%B5/" class="post-title-link" itemprop="url">1.1~1.5&#x7684;&#x4E00;&#x4E9B;&#x6982;&#x5FF5;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-05-31 17:48:59" itemprop="dateCreated datePublished" datetime="2024-05-31T17:48:59+08:00">2024-05-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-02 13:23:57" itemprop="dateModified" datetime="2024-06-02T13:23:57+08:00">2024-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP-in-python/" itemprop="url" rel="index"><span itemprop="name">SICP in python</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP-in-python/Chapter-1-Building-Abstractions-with-Functions/" itemprop="url" rel="index"><span itemprop="name">Chapter 1.Building Abstractions with Functions</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>382</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>1 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="someconceptsinfrom11to15"><span class="math inline">\(some\;concepts\;in\;from\;1.1\;to\;1.5\)</span></span></h1>
<h3><span id="1environment">1.<span class="math inline">\(Environment\)</span></span></h3>
<blockquote>
<p>&#x2003;&#x2003;An environment in which an expression is evaluated consists of a
sequence of frames, depicted as boxes. Each frame contains bindings,
each of which associates a name with its corresponding value. Assignment
and import statements add entries to the first frame of the current
environment.</p>
</blockquote>
<h3><span id="2function-as-abstractions">2.<span class="math inline">\(Function\)</span> <span class="math inline">\(as\)</span> <span class="math inline">\(abstractions\)</span></span></h3>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x4EE5;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7A0B;&#x5E8F;&#x4E3A;&#x4F8B;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add, mul</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">square</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> mul(x, x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sum_squares</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> add(square(x), square(y))</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;<strong>&#x5199;&#x51FA;&#x6C42;&#x548C;&#x5E73;&#x65B9;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x8003;&#x8651;&#x5982;&#x4F55;&#x6C42;&#x4E00;&#x4E2A;&#x6570;&#x7684;&#x5E73;&#x65B9;</strong>&#x3002;&#x5982;&#x4F55;&#x8BA1;&#x7B97;&#x5E73;&#x65B9;&#x7684;&#x7EC6;&#x8282;&#x53EF;&#x4EE5;&#x53BB;&#x6389;&#xFF0C;&#x4EE5;&#x540E;&#x518D;&#x8003;&#x8651;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5C31;<span class="math inline">\(sum\_square\)</span>&#x800C;&#x8A00;&#xFF0C;<span class="math inline">\(square\)</span>&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x51FD;&#x6570;&#x4F53;&#xFF0C;&#x800C;&#x662F;<strong>&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x5373;&#x51FD;&#x6570;&#x62BD;&#x8C61;</strong>&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;<span class="math inline">\(square\)</span>&#x770B;&#x4F5C;&#x4E00;&#x4E2A;&#x201C;&#x9ED1;&#x5323;&#x5B50;&#x201D;&#xFF0C;&#x6211;&#x4EEC;&#x653E;&#x5165;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x51FD;&#x6570;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x800C;<strong>&#x4E2D;&#x95F4;&#x7684;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#x6211;&#x4EEC;&#x5E76;&#x4E0D;&#x5173;&#x5FC3;</strong>&#x3002;</p>
<p>&#x2003;&#x2003;&#x4E3A;&#x4E86;&#x638C;&#x63E1;&#x51FD;&#x6570;&#x62BD;&#x8C61;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x8003;&#x8651;&#x5B83;&#x7684;&#x4E09;&#x4E2A;&#x6838;&#x5FC3;&#x5C5E;&#x6027;&#x901A;&#x5E38;&#x662F;&#x6709;&#x7528;&#x7684;&#xFF1A;</p>
<ul>
<li><strong>&#x51FD;&#x6570;&#x7684;&#x57DF;(domain)</strong> &#x662F;&#x5B83;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x7684;&#x4E00;&#x7EC4;&#x53C2;&#x6570;&#x3002;</li>
<li><strong>&#x51FD;&#x6570;&#x7684;&#x8303;&#x56F4;(range)</strong> &#x662F;&#x5B83;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x7684;&#x96C6;&#x5408;&#x3002;</li>
<li><strong>&#x51FD;&#x6570;&#x7684;&#x76EE;&#x7684;(intent)</strong>
&#x662F;&#x5B83;&#x8BA1;&#x7B97;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;(&#x4EE5;&#x53CA;&#x5B83;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x7684;&#x4EFB;&#x4F55;&#x526F;&#x4F5C;&#x7528;)&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;&#x8F93;&#x5165;&#x5230;&#x8F93;&#x51FA;&#x7684;&#x62BD;&#x8C61;&#x6620;&#x5C04;&#x3002;</li>
</ul>
<p>&#x2003;&#x2003;&#x4F8B;&#x5982;&#x5BF9;&#x4E8E;<span class="math inline">\(sum\_square\)</span>&#xFF0C;&#x5176;&#xFF1A;</p>
<ul>
<li><span class="math inline">\(domain\)</span>&#xFF1A;&#x4E24;&#x4E2A;&#x6570;&#x3002;</li>
<li><span class="math inline">\(range\)</span>&#xFF1A;&#x975E;&#x8D1F;&#x5B9E;&#x6570;&#x3002;</li>
<li><span class="math inline">\(intent\)</span>&#xFF1A;&#x8FD4;&#x56DE;&#x4E24;&#x4E2A;&#x6570;&#x7684;&#x5E73;&#x65B9;&#x548C;&#x3002;</li>
</ul>
<p>&#x2003;&#x2003;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x5982;&#x4F55;&#x6267;&#x884C;&#x610F;&#x56FE;&#xFF1B;<strong>&#x8FD9;&#x4E9B;&#x7EC6;&#x8282;&#x88AB;&#x62BD;&#x8C61;&#x6389;&#x4E86;</strong>&#x3002;</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/05/31/1.6.%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/31/1.6.%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">1.6.&#x9AD8;&#x9636;&#x51FD;&#x6570;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-05-31 17:48:59" itemprop="dateCreated datePublished" datetime="2024-05-31T17:48:59+08:00">2024-05-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-02 13:01:17" itemprop="dateModified" datetime="2024-06-02T13:01:17+08:00">2024-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP-in-python/" itemprop="url" rel="index"><span itemprop="name">SICP in python</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP-in-python/Chapter-1-Building-Abstractions-with-Functions/" itemprop="url" rel="index"><span itemprop="name">Chapter 1.Building Abstractions with Functions</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>3.4k</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>12 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="16&#x9AD8;&#x9636;&#x51FD;&#x6570;"><span class="math inline">\(1.6\)</span>&#x9AD8;&#x9636;&#x51FD;&#x6570;</span></h1>
<h3><span id="1&#x5F15;&#x5165;">1.&#x5F15;&#x5165;</span></h3>
<p>&#x2003;&#x2003;&#x7531;&#x524D;&#x9762;&#x7684;&#x8BB2;&#x89E3;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;<strong>&#x51FD;&#x6570;&#x662F;&#x4E00;&#x79CD;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x63CF;&#x8FF0;&#x72EC;&#x7ACB;&#x4E8E;&#x5176;&#x53C2;&#x6570;&#x7684;&#x7279;&#x5B9A;&#x503C;&#x7684;&#x590D;&#x5408;&#x64CD;&#x4F5C;&#x3002;</strong>
&#x4F8B;&#x5982;&#x5BF9;&#x51FD;&#x6570;<span class="math inline">\(square\)</span>&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">square</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x*x</span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x6211;&#x4EEC;&#x8BA8;&#x8BBA;&#x7684;&#x5E76;&#x4E0D;&#x662F;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x6570;&#x7684;&#x5E73;&#x65B9;&#xFF0C;&#x800C;&#x662F;&#x5BF9;&#x4EFB;&#x4F55;&#x6570;&#x7684;&#x5E73;&#x65B9;&#x7684;&#x666E;&#x904D;&#x89C4;&#x5F8B;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x4E2D;&#x7684;<code>*</code>&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x62BD;&#x8C61;&#x6620;&#x5C04;&#xFF0C;&#x4EE3;&#x8868;&#x4E58;&#x6CD5;&#x3002;&#x5F53;&#x62BD;&#x8C61;&#x6620;&#x5C04;&#x8F83;&#x7B80;&#x5355;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;&#x7B26;&#x53F7;&#x6765;&#x8868;&#x793A;&#xFF1B;&#x4F46;&#x5F53;&#x62BD;&#x8C61;&#x6620;&#x5C04;&#x975E;&#x5E38;&#x590D;&#x6742;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x4F1A;<strong>&#x7528;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x62BD;&#x8C61;&#x6620;&#x5C04;</strong>&#x3002;</p>
<p>&#x2003;&#x2003;&#x7136;&#x800C;&#xFF0C;&#x5728;&#x5C06;&#x76F8;&#x5E94;&#x7684;&#x62BD;&#x8C61;&#x6620;&#x5C04;&#x8F6C;&#x5316;&#x4E3A;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x8981;<strong>&#x5C06;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#x653E;&#x5165;&#x539F;&#x6709;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x6784;&#x9020;&#x51FA;&#x80FD;&#x591F;&#x63A5;&#x53D7;&#x8BE5;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x6216;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x503C;&#x7684;&#x51FD;&#x6570;</strong>&#x3002;&#x8FD9;&#x6837;&#x7684;&#x51FD;&#x6570;&#x5373;&#x88AB;&#x79F0;&#x4E3A;<strong>&#x9AD8;&#x9636;&#x51FD;&#x6570;</strong>&#x3002;</p>
<h3><span id="2&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;">2.&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;</span></h3>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x5BF9;&#x4E0B;&#x9762;&#x4E09;&#x79CD;&#x6C42;&#x548C;&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;</p>
<ul>
<li><p><span class="math inline">\(1+2+\cdots +n\)</span>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum1</span>(<span class="params">n</span>):</span><br><span class="line">    tot,k=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> k&lt;=n:</span><br><span class="line">        tot,k=tot+k,k+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tot</span><br></pre></td></tr></table></figure></p></li>
<li><p><span class="math inline">\(1^3+2^3+\cdots +n^3\)</span>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum2</span>(<span class="params">n</span>):</span><br><span class="line">    tot,k=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> k&lt;=n:</span><br><span class="line">        tot,k=tot+k,k+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tot </span><br></pre></td></tr></table></figure></p></li>
<li><p><span class="math inline">\({4\over{1&#xB7;3}}+{4\over{3&#xB7;5}}+\cdots+{4\over{(2n-1)&#xB7;(2n+1)}}\)</span>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum2</span>(<span class="params">n</span>):</span><br><span class="line">    tot,k=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> k&lt;=n:</span><br><span class="line">        tot,k=tot+<span class="number">4</span>/((<span class="number">2</span>*k-<span class="number">1</span>)*(<span class="number">2</span>*k+<span class="number">1</span>)),k+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tot</span><br></pre></td></tr></table></figure> &#x2003;&#x2003;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x4E0A;&#x8FF0;&#x6C42;&#x548C;&#x90FD;&#x53EF;&#x4EE5;&#x5F52;&#x7EB3;&#x4E3A;&#x4EE5;&#x4E0B;&#x6A21;&#x5F0F;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum</span>(<span class="params">n</span>):</span><br><span class="line">    tot,k=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> k&lt;=n:</span><br><span class="line">        tot,k=f(k),k+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tot</span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x8FD9;&#x79CD;<strong>&#x516C;&#x5171;&#x6A21;&#x5F0F;&#x7684;&#x5B58;&#x5728;&#x5F3A;&#x6709;&#x529B;&#x5730;&#x8BC1;&#x660E;&#x4E86;&#x6709;&#x4E00;&#x4E2A;&#x6709;&#x7528;&#x7684;&#x62BD;&#x8C61;&#x6B63;&#x7B49;&#x5F85;&#x7740;&#x88AB;&#x63D0;&#x51FA;&#x6765;&#x3002;</strong>&#x901A;&#x8FC7;&#x66F4;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x51FD;&#x6570;&#x5C06;&#x4E0D;&#x6B62;&#x80FD;&#x6C42;&#x89E3;&#x8FD9;&#x4E9B;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x6C42;&#x548C;&#xFF0C;&#x800C;&#x662F;&#x53EF;&#x4EE5;&#x6C42;&#x51FA;&#x6240;&#x6709;&#x666E;&#x904D;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x6C42;&#x548C;&#x3002;&#x4E8E;&#x662F;&#x6211;&#x4EEC;<strong>&#x4F7F;&#x7528;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;</strong>&#xFF0C;&#x5C06;&#x539F;&#x6765;&#x7A0B;&#x5E8F;&#x6539;&#x5199;&#x5982;&#x4E0B;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum_abstraction</span>(<span class="params">n,f</span>):</span><br><span class="line">    tot,k=<span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> k&lt;=n:</span><br><span class="line">        tot,k=tot+f(k),k+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> tot</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x4EE5;&#x7B2C;2&#x4E2A;&#x6C42;&#x548C;&#x4E3A;&#x4F8B;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f2</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">return</span> n*n*n</span><br><span class="line"><span class="comment">#&#x5219;sum2&#x53EF;&#x4EE5;&#x5199;&#x6210;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sum2</span>:</span><br><span class="line">    <span class="keyword">return</span> sum_abstraction(n,f2)</span><br></pre></td></tr></table></figure></p></li>
</ul>
<h3><span id="3&#x4F5C;&#x4E3A;&#x4E00;&#x822C;&#x65B9;&#x6CD5;&#x7684;&#x51FD;&#x6570;">3.&#x4F5C;&#x4E3A;&#x4E00;&#x822C;&#x65B9;&#x6CD5;&#x7684;&#x51FD;&#x6570;</span></h3>
<p>&#x2003;&#x2003;&#x4E0A;&#x4E00;&#x8282;&#x201C;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;&#x201D;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7528;&#x51FD;&#x6570;&#x8868;&#x793A;&#x67D0;&#x79CD;&#x62BD;&#x8C61;&#x6570;&#x503C;&#x8FD0;&#x7B97;&#x6A21;&#x5F0F;&#xFF0C;&#x5C06;&#x67D0;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x8FD0;&#x7B97;&#x62BD;&#x8C61;&#x5316;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x8282;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;<strong>&#x5C06;&#x8BBE;&#x8BA1;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x6765;&#x8868;&#x793A;&#x4E00;&#x822C;&#x7684;&#x8BA1;&#x7B97;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x4EEC;&#x72EC;&#x7ACB;&#x4E8E;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#x7684;&#x51FD;&#x6570;</strong>&#x3002;</p>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x6C42;&#x89E3;&#x9EC4;&#x91D1;&#x5206;&#x5272;&#x6BD4;<span class="math inline">\(\varphi\)</span>&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x6211;&#x4EEC;&#x91C7;&#x7528;&#x8FED;&#x4EE3;&#x7684;&#x6C42;&#x6CD5;&#x6765;&#x6C42;&#x3002;&#x51FD;&#x6570;&#x7684;&#x4E3B;&#x4F53;&#x4E3A;&#x8FED;&#x4EE3;&#x51FD;&#x6570;<span class="math inline">\(update\)</span>&#x4E0E;&#x68C0;&#x67E5;&#x51FD;&#x6570;<span class="math inline">\(close\)</span>&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x5BF9;&#x5E94;&#x7740;&#x4E00;&#x4E2A;&#x4E00;&#x822C;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x2003;&#x2003;&#x5BF9;&#x4E8E;&#x8FED;&#x4EE3;&#x51FD;&#x6570;&#xFF0C;&#x7531;&#x9EC4;&#x91D1;&#x5206;&#x5272;&#x6BD4;&#x7684;&#x6027;&#x8D28;&#xFF1A;<span class="math inline">\(\varphi=1+{1\over{1+{1\over{1+{1\over{\cdots}}}}}}\)</span>&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5982;&#x4E0B;&#x7A0B;&#x5E8F;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">guess</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> check(guess):</span><br><span class="line">        guess=<span class="number">1</span>/guess+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> guess</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x5BF9;&#x4E8E;<span class="math inline">\(check\)</span>&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x5373;<span class="math inline">\(update\)</span>&#x7684;&#x8FB9;&#x754C;&#x51FD;&#x6570;&#xFF0C;&#x7531;&#x9EC4;&#x91D1;&#x5206;&#x5272;&#x6BD4;&#x6EE1;&#x8DB3;&#x7684;&#x65B9;&#x7A0B;&#xFF1A;<span class="math inline">\(x^2=x+1\)</span>&#x53EF;&#x5F97;&#x5982;&#x4E0B;&#x7A0B;&#x5E8F;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">guess</span>):</span><br><span class="line">    <span class="keyword">return</span> close(guess*guess,guess+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">close</span>(<span class="params">a,b,tolerance=<span class="number">1e-15</span></span>):</span><br><span class="line">    <span class="keyword">return</span>(<span class="built_in">abs</span>(a-b)&lt;tolerance)</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x4ECE;&#x800C;&#x5F97;&#x5230;&#x6700;&#x7EC8;&#x7684;&#x7A0B;&#x5E8F;&#x5982;&#x4E0B;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">update,check,guess=<span class="number">1</span></span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> check(guess):</span><br><span class="line">        guess=update(guess)</span><br><span class="line">    <span class="keyword">return</span> guess</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x901A;&#x8FC7;&#x672C;&#x9898;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6A21;&#x5757;&#x5316;&#x7F16;&#x7A0B;&#x601D;&#x60F3;&#x7684;&#x91CD;&#x8981;&#x6027;&#xFF1A;&#x6211;&#x4EEC;<strong>&#x5C06;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x62C6;&#x6210;&#x51E0;&#x4E2A;&#x5C0F;&#x7684;&#x7EC4;&#x4EF6;&#xFF0C;&#x5728;&#x7F16;&#x5199;&#x5B8C;&#x6BCF;&#x4E2A;&#x7EC4;&#x4EF6;&#x540E;&#x518D;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#xFF0C;&#x5B9E;&#x73B0;&#x590D;&#x6742;&#x7684;&#x529F;&#x80FD;&#x3002;</strong>&#x540C;&#x65F6;&#x6211;&#x4EEC;&#x5728;&#x7F16;&#x5199;&#x7EC4;&#x4EF6;&#x65F6;&#xFF0C;&#x5BF9;&#x6BCF;&#x4E2A;&#x62BD;&#x8C61;&#x8FC7;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;<strong>&#x5148;&#x547D;&#x540D;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x62BD;&#x8C61;&#x5316;</strong>&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x8FC7;&#x7A0B;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x964D;&#x4F4E;&#x51FD;&#x6570;&#x7684;&#x590D;&#x6742;&#x6027;&#x3002;</p>
<h3><span id="4&#x51FD;&#x6570;&#x7684;&#x5D4C;&#x5957;&#x5B9A;&#x4E49;">4.&#x51FD;&#x6570;&#x7684;&#x5D4C;&#x5957;&#x5B9A;&#x4E49;</span></h3>
<p>&#x2003;&#x2003;&#x4E0A;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x6F14;&#x793A;&#x4E86;<strong>&#x5C06;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;</strong>&#x7684;&#x505A;&#x6CD5;&#x5982;&#x4F55;&#x5C06;<strong>&#x6BCF;&#x4E2A;&#x4E00;&#x822C;&#x6982;&#x5FF5;&#x6216;&#x65B9;&#x7A0B;&#x90FD;&#x6620;&#x5C04;&#x5230;&#x5B83;&#x81EA;&#x5DF1;&#x7684;&#x77ED;&#x51FD;&#x6570;&#x4E0A;</strong>&#x3002;&#x4F46;&#x5728;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x7531;&#x4E8E;&#x6BCF;&#x4E2A;&#x77ED;&#x51FD;&#x6570;&#x662F;&#x5728;&#x5168;&#x5C40;&#x72EC;&#x7ACB;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x5168;&#x5C40;&#x6846;&#x67B6;&#x4F1A;&#x56E0;&#x4E3A;&#x4F17;&#x591A;&#x51FD;&#x6570;&#x7684;&#x52A0;&#x5165;&#x53D8;&#x5F97;&#x6742;&#x4E71;&#x65E0;&#x7AE0;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5728;&#x67D0;&#x4E9B;&#x573A;&#x5408;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BA9;&#x51FD;&#x6570;&#x53EA;&#x4FDD;&#x6301;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5EFA;&#x7ACB;&#x5D4C;&#x5957;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x2003;&#x2003;&#x4EE5;&#x5E73;&#x65B9;&#x6839;&#x7684;&#x8BA1;&#x7B97;&#x4E3A;&#x4F8B;&#x3002;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x7A0B;&#x5E8F;&#x8FED;&#x4EE3;&#x5B9E;&#x73B0;&#x5E73;&#x65B9;&#x6839;&#x7684;&#x8BA1;&#x7B97;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">average</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> (x+y)/<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sqrt_update</span>(<span class="params">x,a</span>):</span><br><span class="line">    <span class="keyword">return</span> average(x,a/x)</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x662F;&#x53CC;&#x53C2;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x5F85;&#x5B9E;&#x73B0;&#x7684;<span class="math inline">\(sqrt\)</span>&#x662F;&#x5355;&#x53C2;&#x51FD;&#x6570;&#xFF1B;&#x5E76;&#x4E14;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x5355;&#x72EC;&#x8C03;&#x7528;&#x53EA;&#x80FD;&#x5B9E;&#x73B0;&#x4E00;&#x6B21;&#x66F4;&#x65B0;&#x3002;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x662F;<strong>&#x5C06;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x653E;&#x5728;&#x5176;&#x4ED6;&#x5B9A;&#x4E49;&#x7684;&#x4E3B;&#x4F53;&#x4E2D;&#x3002;</strong>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sqrt</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> average(x,a/x)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> close(x*x,a)</span><br><span class="line">    <span class="keyword">return</span> solve(update,close)</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x4E0E;&#x5C40;&#x90E8;&#x8D4B;&#x503C;&#x4E00;&#x6837;&#xFF0C;&#x5C40;&#x90E8;<span class="math inline">\(def\)</span>&#x8BED;&#x53E5;&#x53EA;&#x5F71;&#x54CD;&#x5F53;&#x524D;&#x7684;&#x5C40;&#x90E8;&#x5185;&#x5BB9;&#x3002;&#x5F53;<span class="math inline">\(sqrt\)</span>&#x88AB;&#x8BA1;&#x7B97;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x53EA;&#x5728;&#x4F5C;&#x7528;&#x57DF;&#x4E2D;&#x3002;&#x4E0E;&#x6211;&#x4EEC;&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;&#x4E00;&#x81F4;&#xFF0C;<strong>&#x5728;&#x8C03;&#x7528;<span class="math inline">\(sqrt\)</span>&#x4E4B;&#x524D;&#xFF0C;&#x8FD9;&#x4E9B;&#x672C;&#x5730;<span class="math inline">\(def\)</span>&#x8BED;&#x53E5;&#x751A;&#x81F3;&#x4E0D;&#x4F1A;&#x88AB;&#x8BA1;&#x7B97;</strong>&#x3002;&#x7531;&#x6B64;&#x53EF;&#x5F15;&#x51FA;&#x65B0;&#x6982;&#x5FF5;&#xFF1A;</p>
<blockquote>
<p>&#x2003;&#x2003;<strong>&#x8BCD;&#x6CD5;&#x8303;&#x56F4;</strong>&#xFF1A;&#x5728;&#x51FD;&#x6570;&#x5185;&#x90E8;&#x88AB;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x5B9A;&#x4E49;&#x5B83;&#x4EEC;&#x7684;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x3002;&#x4F8B;&#x5982;&#x672C;&#x4F8B;&#x7684;<span class="math inline">\(update\)</span>&#xFF0C;&#x5176;&#x5F15;&#x7528;&#x53C2;&#x6570;<span class="math inline">\(a\)</span>&#x5C31;&#x662F;&#x5C01;&#x95ED;&#x51FD;&#x6570;<span class="math inline">\(sqrt\)</span>&#x7684;&#x53C2;&#x6570;&#x3002;&#x5BF9;&#x4E8E;&#x5728;&#x5C01;&#x95ED;&#x51FD;&#x6570;&#x5185;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#xFF0C;<span class="math inline">\(a\)</span>&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x4EFB;&#x610F;&#x8C03;&#x7528;&#x7684;&#x5E38;&#x6570;&#x3002;</p>
</blockquote>
<p>&#x2003;&#x2003;&#x7531;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x53D8;&#x91CF;&#x73AF;&#x5883;&#x5C31;&#x5206;&#x6210;&#x4E86;&#x4E24;&#x4E2A;&#x73AF;&#x5883;&#xFF1A;</p>
<ul>
<li>&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x7236;&#x73AF;&#x5883;&#xFF1A;<strong>&#x5B9A;&#x4E49;&#x5B83;&#x7684;&#x73AF;&#x5883;</strong></li>
<li>&#x5F53;&#x8C03;&#x7528;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x65F6;&#xFF0C;<strong>&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;&#x5185;&#x90E8;&#x6269;&#x5C55;&#x51FA;&#x7684;&#x65B0;&#x73AF;&#x5883;</strong></li>
</ul>
<p>&#x2003;&#x2003;&#x4ECD;&#x7136;&#x4EE5;<span class="math inline">\(sqrt\)</span>&#x4E3A;&#x4F8B;&#x8BB2;&#x89E3;&#x5D4C;&#x5957;&#x51FD;&#x6570;&#x3002;&#x5229;&#x7528;&#x5D4C;&#x5957;&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x7684;<span class="math inline">\(sqrt\)</span>&#x8BA1;&#x7B97;&#x5982;&#x4E0B;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">average</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> (x+y)/<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">update,check,guess=<span class="number">1</span></span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> check(guess):</span><br><span class="line">        guess=update(guess)</span><br><span class="line">    <span class="keyword">return</span> guess</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eq</span>(<span class="params">x,y,tolerance=<span class="number">1e-15</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(x-y)&lt;tolerance</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sqrt</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">x,a/x</span>):</span><br><span class="line">        <span class="keyword">return</span> average(x,a/x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>:</span><br><span class="line">        <span class="keyword">return</span> eq(x*x,a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> solve(update,check)</span><br><span class="line"></span><br><span class="line">result=sqrt(<span class="number">256</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#x53CA;&#x5BF9;&#x5E94;&#x8303;&#x56F4;&#x5982;&#x4E0B;&#xFF1A; 1.
&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#xFF0C;&#x6B64;&#x65F6;&#x6240;&#x6709;&#x51FD;&#x6570;&#x5747;&#x4E3A;&#x5168;&#x5C40;&#x8303;&#x56F4; 2. &#x8C03;&#x7528;<span class="math inline">\(sqrt\)</span>&#xFF0C;&#x6B64;&#x65F6;<span class="math inline">\(def\)</span>&#x5185;&#x90E8;&#x7684;<span class="math inline">\(update\)</span>&#x3001;<span class="math inline">\(check\)</span>&#x51FD;&#x6570;&#x4E3A;&#x8BCD;&#x6CD5;&#x8303;&#x56F4;&#xFF0C;&#x540C;&#x65F6;<span class="math inline">\(update\)</span>&#x3001;<span class="math inline">\(check\)</span>&#x7EE7;&#x627F;&#x8BCD;&#x6CD5;&#x8303;&#x56F4;&#x5185;&#x7684;&#x53D8;&#x91CF;<span class="math inline">\(a\)</span> 3. &#x6267;&#x884C;<span class="math inline">\(solve\)</span>&#xFF0C;&#x901A;&#x8FC7;&#x8FED;&#x4EE3;&#x8BA1;&#x7B97;&#x51FA;<span class="math inline">\(sqrt\)</span>&#x7684;&#x503C;&#x3002;</p>
<p><img src="/2024/05/31/1.6.%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/image-1.png"></p>
<p>&#x2003;&#x2003;&#x901A;&#x8FC7;&#x672C;&#x4F8B;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x4E86;&#x89E3;&#x62D3;&#x5C55;&#x73AF;&#x5883;&#x7684;&#x6982;&#x5FF5;&#xFF1A;</p>
<blockquote>
<p>&#x2003;&#x2003;<strong>&#x62D3;&#x5C55;&#x73AF;&#x5883;</strong>&#xFF1A;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x53EF;&#x4EE5;<strong>&#x7531;&#x4EFB;&#x610F;&#x957F;&#x7684;&#x6846;&#x67B6;&#x94FE;&#x7EC4;&#x6210;&#xFF0C;&#x6846;&#x67B6;&#x94FE;&#x603B;&#x662F;&#x4EE5;&#x5168;&#x5C40;&#x6846;&#x67B6;&#x7ED3;&#x675F;</strong>&#x3002;&#x5728;<span class="math inline">\(sqrt\)</span>&#x4E4B;&#x524D;&#xFF0C;&#x73AF;&#x5883;&#x6700;&#x591A;&#x53EA;&#x6709;&#x4E24;&#x4E2A;&#x5E27;:
&#x5C40;&#x90E8;&#x5E27;&#x548C;&#x5168;&#x5C40;&#x5E27;&#x3002;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x5728;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x901A;&#x8FC7;&#x5D4C;&#x5957;&#x7684;<span class="math inline">\(def\)</span>&#x8BED;&#x53E5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x66F4;&#x957F;&#x7684;&#x94FE;&#x3002;&#x8C03;&#x7528; <span class="math inline">\(update\)</span>&#x7684;&#x73AF;&#x5883;&#x7531;&#x4E09;&#x4E2A;&#x6846;&#x67B6;&#x7EC4;&#x6210;:
<strong>&#x5C40;&#x90E8;<span class="math inline">\(update\)</span>&#x6846;&#x67B6;&#x3001;&#x5B9A;&#x4E49; <span class="math inline">\(update\)</span>&#x7684;<span class="math inline">\(sqrt\)</span>&#x6846;&#x67B6;&#x548C;&#x5168;&#x5C40;&#x6846;&#x67B6;</strong>&#x3002;</p>
</blockquote>
<p>&#x2003;&#x2003;&#x7531;&#x4E0A;&#x8FF0;&#x6846;&#x67B6;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;&#x6846;&#x67B6;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF1A;<span class="math inline">\(update\)</span>&#x5148;&#x5728;&#x672C;&#x5730;&#x6846;&#x67B6;&#x4E2D;&#x627E;<span class="math inline">\(a\)</span>&#x7684;&#x503C;&#xFF0C;&#x6CA1;&#x627E;&#x5230;&#xFF1B;&#x4E8E;&#x662F;<span class="math inline">\(update\)</span>&#x53BB;&#x5B9A;&#x4E49;<span class="math inline">\(update\)</span>&#x7684;<span class="math inline">\(sqrt\)</span>&#x6846;&#x67B6;&#x627E;&#xFF0C;&#x627E;&#x5230;<span class="math inline">\(256\)</span>&#xFF0C;&#x4E8E;&#x662F;<span class="math inline">\(a=256\)</span>&#x3002;</p>
<p>&#x2003;&#x2003;&#x7531;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x51FA;&#x4E86;&#x8BCD;&#x6CD5;&#x8303;&#x56F4;&#x7684;&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li><p>&#x5C40;&#x90E8;&#x51FD;&#x6570;&#x7684;&#x540D;&#x79F0;&#x4E0D;&#x4F1A;&#x5E72;&#x6270;&#x5B9A;&#x4E49;&#x5B83;&#x7684;&#x51FD;&#x6570;&#x7684;&#x5916;&#x90E8;&#x540D;&#x79F0;&#xFF0C;<strong>&#x56E0;&#x4E3A;&#x5C40;&#x90E8;&#x51FD;&#x6570;&#x540D;&#x79F0;&#x5C06;&#x7ED1;&#x5B9A;&#x5728;&#x5B9A;&#x4E49;&#x5B83;&#x7684;&#x5F53;&#x524D;&#x5C40;&#x90E8;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x4E2D;&#x3002;</strong></p></li>
<li><p>&#x5C40;&#x90E8;&#x51FD;&#x6570;<strong>&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5C01;&#x95ED;&#x51FD;&#x6570;&#x7684;&#x73AF;&#x5883;</strong>&#xFF0C;&#x56E0;&#x4E3A;&#x5C40;&#x90E8;&#x51FD;&#x6570;&#x4F53;&#x662F;&#x5728;&#x6269;&#x5C55;&#x5176;&#x5B9A;&#x4E49;&#x7684;&#x5C01;&#x95ED;&#x51FD;&#x6570;&#x73AF;&#x5883;&#x4E2D;&#x8FDB;&#x884C;&#x5B9A;&#x4E49;&#x7684;&#x3002;</p></li>
</ul>
<p>&#x2003;&#x2003;&#x8FD9;&#x79CD;&#x5728;&#x672C;&#x5730;&#x6846;&#x67B6;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x88AB;&#x79F0;&#x4E3A;<strong>&#x95ED;&#x5305;</strong>&#xFF0C;&#x4F8B;&#x5982;&#x672C;&#x9898;&#x4E2D;&#x7684;<span class="math inline">\(sqrt\)</span>&#x51FD;&#x6570;&#x3002;&#x5728;&#x95ED;&#x5305;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x95ED;&#x5305;&#x5185;&#x7684;&#x6570;&#x636E;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E14;&#x95ED;&#x5305;&#x5185;&#x7684;&#x4FE1;&#x606F;&#x662F;&#x5C01;&#x95ED;&#x7684;&#x3001;&#x4E0D;&#x4F1A;&#x6CC4;&#x9732;&#x5230;&#x5916;&#x90E8;&#x73AF;&#x5883;&#x4E2D;&#x3002;</p>
<h3><span id="5&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x51FD;&#x6570;">5.&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x51FD;&#x6570;</span></h3>
<p>&#x2003;&#x2003;&#x8BCD;&#x6CD5;&#x8303;&#x56F4;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7279;&#x6027;&#x662F;&#xFF1A;<strong>&#x672C;&#x5730;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x5728;&#x8FD4;&#x56DE;&#x65F6;&#x7EF4;&#x62A4;&#x5176;&#x7236;&#x73AF;&#x5883;</strong>&#x3002;&#x4E0B;&#x9762;&#x4E3E;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x8BE5;&#x7279;&#x6027;&#x7684;&#x4F8B;&#x5B50;&#x3002;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">combine</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">h</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> f(g(x))</span><br><span class="line">    <span class="keyword">return</span> h</span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x8FD9;&#x662F;&#x590D;&#x5408;&#x51FD;&#x6570;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x6B63;&#x662F;&#x901A;&#x8FC7;&#x672C;&#x5730;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x7EE7;&#x627F;&#x7236;&#x73AF;&#x5883;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x4E86;&#x591A;&#x4E2A;&#x51FD;&#x6570;&#x95F4;&#x7684;&#x590D;&#x5408;&#x3002;</p>
<p>&#x2003;&#x2003;&#x4E00;&#x822C;&#x5730;&#xFF0C;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x7684;&#x51FD;&#x6570;&#x5177;&#x6709;&#x4EE5;&#x4E0B;&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li><p><strong>&#x7075;&#x6D3B;&#x6027;&#x548C;&#x53EF;&#x590D;&#x7528;&#x6027;</strong>&#xFF1A;
&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x53EF;&#x4EE5;&#x589E;&#x52A0;&#x4EE3;&#x7801;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x3002;&#x901A;&#x8FC7;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x9009;&#x62E9;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x4F7F;&#x5F97;&#x4EE3;&#x7801;&#x66F4;&#x52A0;&#x7075;&#x6D3B;&#x548C;&#x53EF;&#x590D;&#x7528;&#x3002;</p></li>
<li><p><strong>&#x5C01;&#x88C5;&#x548C;&#x62BD;&#x8C61;</strong>&#xFF1A;
&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x6709;&#x52A9;&#x4E8E;&#x5C01;&#x88C5;&#x548C;&#x62BD;&#x8C61;&#x4EE3;&#x7801;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E9B;&#x590D;&#x6742;&#x7684;&#x903B;&#x8F91;&#x5C01;&#x88C5;&#x5728;&#x51FD;&#x6570;&#x5185;&#x90E8;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x9690;&#x85CF;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#xFF0C;&#x4F7F;&#x5F97;&#x63A5;&#x53E3;&#x66F4;&#x52A0;&#x7B80;&#x6D01;&#xFF0C;&#x63D0;&#x9AD8;&#x4EE3;&#x7801;&#x7684;&#x53EF;&#x7EF4;&#x62A4;&#x6027;&#x3002;</p></li>
<li><p><strong>&#x5EF6;&#x8FDF;&#x6267;&#x884C;</strong>&#xFF1A;
&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x5EF6;&#x8FDF;&#x6267;&#x884C;&#x7684;&#x6A21;&#x5F0F;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5BF9;&#x8C61;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x5177;&#x4F53;&#x7684;&#x903B;&#x8F91;&#x3002;&#x8FD9;&#x79CD;&#x5EF6;&#x8FDF;&#x6267;&#x884C;&#x7684;&#x65B9;&#x5F0F;&#x6709;&#x52A9;&#x4E8E;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x6D89;&#x53CA;&#x6602;&#x8D35;&#x8BA1;&#x7B97;&#x6216;&#x8005;&#x9700;&#x8981;&#x4ECE;&#x5916;&#x90E8;&#x83B7;&#x53D6;&#x8D44;&#x6E90;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x3002;</p></li>
<li><p><strong>&#x51FD;&#x6570;&#x5C01;&#x88C5;</strong>&#xFF1A;
&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x7684;&#x80FD;&#x529B;&#x4F7F;&#x5F97;&#x51FD;&#x6570;&#x6210;&#x4E3A;&#x4E00;&#x79CD;&#x51FD;&#x6570;&#x5DE5;&#x5382;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x6216;&#x8005;&#x6761;&#x4EF6;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x66F4;&#x52A0;&#x901A;&#x7528;&#x548C;&#x53EF;&#x914D;&#x7F6E;&#x7684;&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#x3002;</p></li>
</ul>
<h3><span id="6&#x9AD8;&#x9636;&#x51FD;&#x6570;&#x7684;&#x7ECF;&#x5178;&#x5E94;&#x7528;">6.&#x9AD8;&#x9636;&#x51FD;&#x6570;&#x7684;&#x7ECF;&#x5178;&#x5E94;&#x7528;</span></h3>
<h4><span id="a&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x6CD5;">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x6CD5;</span></h4>
<h5><span id="i&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x7684;&#x539F;&#x7406;">&#x2003;&#x2003;<span class="math inline">\(i.\)</span>&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x7684;&#x539F;&#x7406;</span></h5>
<p><img src="/2024/05/31/1.6.%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/image.png"></p>
<h5><span id="ii&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;">&#x2003;&#x2003;<span class="math inline">\(ii.\)</span>&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;</span></h5>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x5B9E;&#x73B0;<span class="math inline">\(\sqrt[n]{a}\)</span>&#x7684;&#x8BA1;&#x7B97;&#x3002;&#x9996;&#x5148;&#x4EE4;<span class="math inline">\(\sqrt[n]{a}=x\)</span>&#xFF0C;&#x5219;&#x95EE;&#x9898;&#x8F6C;&#x5316;&#x4E3A;&#x6C42;<span class="math inline">\(x^n=a\)</span>&#x7684;&#x5B9E;&#x6839;&#x3002;&#x6211;&#x4EEC;&#x6839;&#x636E;&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x6CD5;&#x5C06;&#x7A0B;&#x5E8F;&#x62C6;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x6A21;&#x5757;&#xFF1A;
*
&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#xFF1A;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x8981;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x91C7;&#x7528;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x7684;&#x9AD8;&#x9636;&#x51FD;&#x6570;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">newton_update</span>(<span class="params">f,df</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> x-f(x)/df(x)</span><br><span class="line">    <span class="keyword">return</span> update</span><br></pre></td></tr></table></figure> &#x2003;&#x2003;&#x6211;&#x4EEC;&#x5C06;&#x62BD;&#x8C61;&#x8FC7;&#x7A0B;<span class="math inline">\(f\)</span>&#x4E0E;<span class="math inline">\(df\)</span>&#x547D;&#x540D;&#x4E3A;&#x4E86;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4E0B;&#x9762;&#x8003;&#x8651;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x4E24;&#x8005;&#x3002;</p>
<ul>
<li><p><span class="math inline">\(f\)</span>&#xFF1A;<span class="math inline">\(f\)</span>&#x5373;&#x4E3A;<span class="math inline">\(x^n\)</span> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> power(x,n)</span><br><span class="line">```   </span><br><span class="line">&amp;emsp;&amp;emsp;&#x540C;&#x7406;&#xFF1A;</span><br><span class="line">```python</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">df</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> n*power(x,n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure> &#x2003;&#x2003;&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x5B9E;&#x73B0;<span class="math inline">\(power\)</span>&#xFF1A;</p></li>
<li><p><span class="math inline">\(power\)</span>:&#x7B80;&#x5355;&#x7684;&#x8FDE;&#x4E58;&#x5373;&#x53EF;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">power</span>(<span class="params">x,n</span>):</span><br><span class="line">    mul,cnt=<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> cnt&lt;n:</span><br><span class="line">        mul,cnt=mul*x,cnt+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> mul</span><br></pre></td></tr></table></figure></p></li>
<li><p>&#x5BFB;&#x627E;&#x96F6;&#x70B9;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#xFF1A;&#x5BFB;&#x627E;&#x96F6;&#x70B9;&#x5206;&#x4E3A;&#x4E24;&#x6B65;&#xFF1A;&#x68C0;&#x9A8C;&#x662F;&#x5426;&#x4E3A;&#x96F6;&#x70B9;&#x4E0E;&#x725B;&#x987F;&#x8FED;&#x4EE3;&#x3002;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x5B9E;&#x73B0;&#x8FD9;&#x4E24;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5B83;&#x4EEC;&#x5C01;&#x88C5;&#x4E3A;&#x5BFB;&#x627E;&#x96F6;&#x70B9;&#x51FD;&#x6570;&#xFF1A;</p>
<ul>
<li>&#x68C0;&#x9A8C;&#x662F;&#x5426;&#x4E3A;&#x96F6;&#x70B9;&#xFF1A;&#x5224;&#x65AD;<span class="math inline">\(f(x)-a\)</span>&#x662F;&#x5426;&#x5728;&#x8BEF;&#x5DEE;&#x8303;&#x56F4;&#x5373;&#x53EF;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">iszero</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> eq(f(x),<span class="number">0</span>)</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>&#x51FD;&#x6570;&#x5C01;&#x88C5;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">update, is_zero</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">iteratively_solve</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> is_approx_zero(x):</span><br><span class="line">            x = update(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    <span class="keyword">return</span> iteratively_solve</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_zero</span>(<span class="params">f,df</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_zero</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> eq(f(x),<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> solve(newton_update(f,df),is_zero)</span><br></pre></td></tr></table></figure></p></li>
<li><p>&#x6700;&#x7EC8;&#x51FD;&#x6570;&#x5C01;&#x88C5;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">nth_root_of_a</span>(<span class="params">n,a</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> power(x,n)-a</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">df</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> n*power(x,n-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> find_zero(f,df)</span><br></pre></td></tr></table></figure> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">newton_update</span>(<span class="params">f, df</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> x - f(x) / df(x)</span><br><span class="line">    <span class="keyword">return</span> update</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">improve</span>(<span class="params">update, is_approx_zero, max_iter=<span class="number">1000</span></span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">iteratively_improve</span>(<span class="params">x</span>):</span><br><span class="line">        iteration = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> is_approx_zero(x) <span class="keyword">and</span> iteration &lt; max_iter:</span><br><span class="line">            x = update(x)</span><br><span class="line">            iteration += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    <span class="keyword">return</span> iteratively_improve</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_zero</span>(<span class="params">f, df</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">near_zero</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> approx_eq(f(x), <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> improve(newton_update(f, df), near_zero)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">power</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Return x * x * x * ... * x for x repeated n times.&quot;&quot;&quot;</span></span><br><span class="line">    product, k = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> k &lt; n:</span><br><span class="line">        product, k = product * x, k + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> product</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">approx_eq</span>(<span class="params">a, b, epsilon=<span class="number">1e-6</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(a - b) &lt; epsilon</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nth_root_of_a</span>(<span class="params">n, a</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> power(x, n) - a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">df</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> n * power(x, n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> find_zero(f, df)</span><br><span class="line"></span><br></pre></td></tr></table></figure></p></li>
</ul>
<h4><span id="bcurry&#x5316;">&#x2003;&#x2003;<span class="math inline">\(b.\)</span><span class="math inline">\(Curry\)</span>&#x5316;</span></h4>
<h5><span id="i&#x4E00;&#x822C;&#x7684;curry&#x5316;">&#x2003;&#x2003;<span class="math inline">\(i.\)</span>&#x4E00;&#x822C;&#x7684;<span class="math inline">\(Curry\)</span>&#x5316;</span></h5>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x9AD8;&#x9636;&#x51FD;&#x6570;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E2A;&#x6709;&#x5F88;&#x591A;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;&#x62C6;&#x5206;&#x6210;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x94FE;&#xFF0C;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x94FE;&#x8282;&#x90FD;&#x662F;&#x5355;&#x53C2;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x2003;&#x2003;&#x4EE5;&#x53CC;&#x53C2;&#x51FD;&#x6570;<span class="math inline">\(pow(a,n)\)</span>&#x4E3A;&#x4F8B;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x4EE5;&#x4E0B;&#x7A0B;&#x5E8F;&#x5C06;<span class="math inline">\(pow(a,n)\)</span>&#x8F6C;&#x5316;&#x4E3A;<span class="math inline">\(h(a)(n)\)</span>&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">curried_pow</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">h</span>(<span class="params">y</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(x,y)</span><br><span class="line">    <span class="keyword">return</span> h</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>curried_pow(<span class="number">2</span>)(<span class="number">3</span>)</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x9664;&#x4E86;&#x6EE1;&#x8DB3;&#x5355;&#x53C2;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x7531;&#x4E8E;&#x5C06;&#x539F;&#x51FD;&#x6570;&#x62C6;&#x6210;&#x4E86;&#x591A;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;<span class="math inline">\(Curry\)</span>&#x5316;&#x7684;&#x51FD;&#x6570;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6539;&#x52A8;&#x67D0;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4F7F;<span class="math inline">\(Curry\)</span>&#x5316;&#x540E;&#x7684;&#x51FD;&#x6570;&#x80FD;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD;&#x3002;&#x4F8B;&#x5982;&#x4E0B;&#x9762;&#x8BA1;&#x7B97;<span class="math inline">\(2^1\sim 2^{10}\)</span>&#x7684;&#x7A0B;&#x5E8F;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">map_to_range</span>(<span class="params">start,end,f</span>):</span><br><span class="line">    <span class="keyword">while</span> start&lt;end:</span><br><span class="line">        <span class="built_in">print</span>(f(start))</span><br><span class="line">        start+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">map_to_range(<span class="number">1</span>,<span class="number">10</span>,<span class="built_in">pow</span>(<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x8FD9;&#x91CC;&#xFF0C;<span class="math inline">\(Curry\)</span>&#x51FD;&#x6570;<span class="math inline">\(pow(2)\)</span>&#x53EA;&#x6267;&#x884C;&#x201C;&#x4EE5;<span class="math inline">\(2\)</span>&#x4E3A;&#x5E95;&#x201D;&#x8FD9;&#x4E00;&#x6A21;&#x5757;&#x3002;&#x800C;&#x53E6;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x201C;<span class="math inline">\(n\)</span>&#x6B21;&#x5E42;&#x201D;&#x5219;&#x7531;<span class="math inline">\(map\_to\_range\)</span>&#x4F20;&#x9012;&#x3002;</p>
<h5><span id="ii&#x81EA;&#x52A8;&#x5316;">&#x2003;&#x2003;<span class="math inline">\(ii.\)</span>&#x81EA;&#x52A8;&#x5316;</span></h5>
<p>&#x2003;&#x2003;&#x4EE5;&#x4E0B;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5BF9;&#x8F93;&#x5165;&#x51FD;&#x6570;&#x7684;<span class="math inline">\(Curry\)</span>&#x5316;&#x4E0E;<span class="math inline">\(Uncurry\)</span>&#x5316;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">curry</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">g</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">h</span>(<span class="params">y</span>):</span><br><span class="line">            <span class="keyword">return</span> f(x,y)</span><br><span class="line">        <span class="keyword">return</span> h</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uncurry</span>(<span class="params">g</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x,y</span>):</span><br><span class="line">        <span class="keyword">return</span> g(x)(y)</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"><span class="comment">#&#x8C03;&#x7528;</span></span><br><span class="line">pow_curried=curry(<span class="built_in">pow</span>)</span><br><span class="line"><span class="built_in">pow</span>=uncurry(pow_curried)</span><br></pre></td></tr></table></figure></p>
<h4><span id="clambda&#x8868;&#x8FBE;&#x5F0F;">&#x2003;&#x2003;<span class="math inline">\(c.\)</span><span class="math inline">\(lambda\)</span>&#x8868;&#x8FBE;&#x5F0F;</span></h4>
<p>&#x2003;&#x2003;<span class="math inline">\(lambda\)</span>&#x8868;&#x8FBE;&#x5F0F;&#x53EF;&#x4EE5;&#x5728;&#x4E0D;&#x58F0;&#x660E;&#x51FD;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5C06;&#x53D8;&#x91CF;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5C31;&#x662F;<span class="math inline">\(lambda\)</span>&#x8868;&#x8FBE;&#x5F0F;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">composel</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> x:f(g(x))</span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x5982;&#x4E0B;&#x8868;&#x683C;&#x7406;&#x89E3;<span class="math inline">\(lambda\)</span>&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x6982;&#x5FF5;&#xFF1A;</p>
<p><img src="/2024/05/31/1.6.%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/image-2.png"></p>
<p>&#x2003;&#x2003;<span class="math inline">\(lambda\)</span>&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x79F0;&#x4F5C;
<strong><span class="math inline">\(lambda\)</span>&#x51FD;&#x6570;</strong> &#x3002;<span class="math inline">\(lambda\)</span>&#x51FD;&#x6570;&#x6CA1;&#x6709;&#x5185;&#x7F6E;&#x540D;&#x79F0;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x548C;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6570;&#x4E00;&#x6837;&#x8C03;&#x7528;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="keyword">lambda</span> x: x * x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line">&lt;function &lt;<span class="keyword">lambda</span>&gt; at <span class="number">0xf3f490</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s(<span class="number">12</span>)</span><br><span class="line"><span class="number">144</span></span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x5BF9;&#x4E8E;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5229;&#x7528;<span class="math inline">\(lambda\)</span>&#x8868;&#x8FBE;&#x5F0F;&#x53EF;&#x4EE5;&#x7B80;&#x5316;&#x4EE3;&#x7801;&#xFF1B;&#x4F46;&#x5982;&#x679C;&#x51FD;&#x6570;&#x8F83;&#x4E3A;&#x590D;&#x6742;&#xFF0C;<span class="math inline">\(lambda\)</span>&#x5C31;&#x5F88;&#x53EF;&#x80FD;&#x7ED9;&#x4EBA;&#x5E26;&#x6765;&#x7406;&#x89E3;&#x4E0A;&#x7684;&#x56F0;&#x96BE;&#x3002;&#x56E0;&#x6B64;&#x5728;&#x4EE3;&#x7801;&#x8F83;&#x590D;&#x6742;&#x3001;&#x5C42;&#x5C42;&#x5D4C;&#x5957;&#x65F6;&#xFF0C;&#x8FD8;&#x662F;&#x7528;&#x4F20;&#x7EDF;&#x7684;<code>def</code>&#x4E3A;&#x4F73;&#x3002;</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/05/31/1.7.%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/31/1.7.%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">1.7.&#x9012;&#x5F52;&#x51FD;&#x6570;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-05-31 17:48:59" itemprop="dateCreated datePublished" datetime="2024-05-31T17:48:59+08:00">2024-05-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-02 13:23:57" itemprop="dateModified" datetime="2024-06-02T13:23:57+08:00">2024-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP-in-python/" itemprop="url" rel="index"><span itemprop="name">SICP in python</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP-in-python/Chapter-1-Building-Abstractions-with-Functions/" itemprop="url" rel="index"><span itemprop="name">Chapter 1.Building Abstractions with Functions</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>5 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="17&#x9012;&#x5F52;&#x51FD;&#x6570;"><span class="math inline">\(1.7\)</span>&#x9012;&#x5F52;&#x51FD;&#x6570;</span></h1>
<h2><span id="&#x4E00;-&#x9012;&#x5F52;&#x51FD;&#x6570;&#x7684;&#x6982;&#x5FF5;&#x4E0E;&#x5206;&#x7C7B;">&#x4E00;&#x3001;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x7684;&#x6982;&#x5FF5;&#x4E0E;&#x5206;&#x7C7B;</span></h2>
<h3><span id="1&#x6982;&#x5FF5;">1.&#x6982;&#x5FF5;</span></h3>
<p>&#x2003;&#x2003;&#x5982;&#x679C;<strong>&#x51FD;&#x6570;&#x4F53;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x672C;&#x8EAB;</strong>&#xFF0C;&#x5219;&#x51FD;&#x6570;&#x79F0;&#x4E3A;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6267;&#x884C;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x4F53;&#x7684;&#x8FC7;&#x7A0B;&#x53EF;&#x80FD;&#x53CD;&#x8FC7;&#x6765;&#x53C8;&#x9700;&#x8981;&#x518D;&#x6B21;&#x5E94;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x3002;</p>
<h3><span id="2&#x9012;&#x5F52;&#x7684;&#x539F;&#x7406;">2.&#x9012;&#x5F52;&#x7684;&#x539F;&#x7406;</span></h3>
<p>&#x2003;&#x2003;&#x4E00;&#x822C;&#x7684;&#x9012;&#x5F52;&#x7531;&#x4EE5;&#x4E0B;&#x7ED3;&#x6784;&#x6784;&#x6210;&#xFF1A;</p>
<ul>
<li>&#x57FA;&#x672C;&#x60C5;&#x51B5;&#xFF1A;&#x5F53;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x9012;&#x5F52;&#x5230;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x57FA;&#x672C;&#x60C5;&#x51B5;&#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x5C06;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x67D0;&#x4E2A;&#x503C;&#xFF0C;&#x8DF3;&#x51FA;&#x9012;&#x5F52;</li>
<li>&#x9012;&#x5F52;&#x8C03;&#x7528;&#xFF1A;&#x968F;&#x7740;&#x9012;&#x5F52;&#x8C03;&#x7528;&#xFF0C;&#x95EE;&#x9898;&#x9010;&#x6E10;&#x5F97;&#x5230;&#x7B80;&#x5316;</li>
</ul>
<p>&#x2003;&#x2003;&#x4EE5;&#x9636;&#x4E58;&#x7684;&#x6C42;&#x89E3;&#x4E3A;&#x4F8B;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fact</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> n*f(n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure> &#x2003;&#x2003;&#x9012;&#x5F52;&#x51FD;&#x6570;<span class="math inline">\(fact\)</span>&#x7528;&#x4E00;&#x4E2A;&#x66F4;&#x7B80;&#x5355;&#x7684;&#x95EE;&#x9898;&#xFF1A;<span class="math inline">\(fact(n-1)\)</span>&#x8868;&#x793A;&#x4E86;<span class="math inline">\(fact(n)\)</span>&#x3002;&#x8BE5;&#x9012;&#x5F52;&#x7684;&#x57FA;&#x672C;&#x60C5;&#x51B5;&#x662F;<span class="math inline">\(1!=1,0!=1\)</span>&#x3002;</p>
<p>&#x2003;&#x2003;&#x5F53;&#x9012;&#x5F52;<strong>&#x901A;&#x8FC7;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x7684;&#x8FDE;&#x7EED;&#x8C03;&#x7528;&#x201C;&#x5C55;&#x5F00;&#x201D;&#x5230;&#x8D8A;&#x6765;&#x8D8A;&#x7B80;&#x5355;&#x7684;&#x95EE;&#x9898;&#x65F6;&#xFF0C;&#x7ED3;&#x679C;&#x6700;&#x7EC8;&#x4F1A;&#x4ECE;&#x57FA;&#x672C;&#x60C5;&#x51B5;&#x5F00;&#x59CB;&#x6784;&#x5EFA;</strong>&#x3002;&#x9012;&#x5F52;&#x7ED3;&#x675F;&#x65F6;&#x5C06;&#x53C2;&#x6570;<span class="math inline">\(1\)</span>&#x4F20;&#x9012;&#x7ED9;<span class="math inline">\(fact\)</span>;
<strong>&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x7684;&#x7ED3;&#x679C;&#x53D6;&#x51B3;&#x4E8E;&#x4E0B;&#x4E00;&#x4E2A;&#x8C03;&#x7528;&#xFF0C;&#x76F4;&#x5230;&#x8FBE;&#x5230;&#x57FA;&#x672C;&#x60C5;&#x51B5;&#x3002;</strong></p>
<p>&#x2003;&#x2003;&#x5728;&#x6211;&#x4EEC;&#x5229;&#x7528;&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x6A21;&#x578B;&#x5F97;&#x51FA;&#x9012;&#x5F52;&#x7684;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#x65F6;&#xFF0C;&#x4E5F;&#x53EF;<strong>&#x5C06;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x770B;&#x4F5C;&#x51FD;&#x6570;&#x62BD;&#x8C61;</strong>&#x3002;&#x5728;&#x9636;&#x4E58;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x5173;&#x5FC3;<span class="math inline">\(fact(n-1)\)</span>&#x662F;&#x600E;&#x4E48;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x7B80;&#x5355;&#x5730;&#x76F8;&#x4FE1;&#x5B83;&#x8BA1;&#x7B97;&#x7684;&#x662F;<span class="math inline">\(n-1\)</span>&#x7684;&#x9636;&#x4E58;&#x3002;&#x8FD9;&#x79CD;&#x5BF9;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x7684;&#x770B;&#x6CD5;&#x88AB;&#x79F0;&#x4F5C;<span class="math inline">\(recursive\;leap\;of\;faith\)</span>&#xFF0C;&#x5373;<strong>&#x6211;&#x4EEC;&#x76F8;&#x4FE1;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x7B80;&#x5355;&#x60C5;&#x51B5;&#x65F6;&#x51FD;&#x6570;&#x4F1A;&#x5F97;&#x51FA;&#x6B63;&#x786E;&#x7ED3;&#x679C;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x8BA4;&#x77E5;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x53BB;&#x8BA1;&#x7B97;&#x590D;&#x6742;&#x60C5;&#x51B5;</strong>&#x3002;&#x4F8B;&#x5982;&#x8BA1;&#x7B97;&#x9636;&#x4E58;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x76F8;&#x4FE1;<span class="math inline">\(fact(n-1)\)</span>&#x80FD;&#x6B63;&#x786E;&#x8BA1;&#x7B97;&#x51FA;<span class="math inline">\((n-1)!\)</span>&#xFF0C;<strong>&#x53EA;&#x9700;&#x68C0;&#x67E5;<span class="math inline">\(n!\)</span>&#x5728;&#x8FD9;&#x4E2A;&#x5047;&#x8BBE;&#x6210;&#x7ACB;&#x4E0B;&#x662F;&#x5426;&#x80FD;&#x5F97;&#x5230;&#x6B63;&#x786E;&#x8BA1;&#x7B97;</strong>&#x3002;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x9A8C;&#x8BC1;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x7684;&#x6B63;&#x786E;&#x6027;&#x662F;&#x4E00;&#x79CD;<strong>&#x6570;&#x5B66;&#x5F52;&#x7EB3;&#x6CD5;</strong>&#x3002;</p>
<h3><span id="3&#x9012;&#x5F52;&#x4E0E;&#x5FAA;&#x73AF;&#x51FD;&#x6570;&#x7684;&#x533A;&#x522B;">3.&#x9012;&#x5F52;&#x4E0E;&#x5FAA;&#x73AF;&#x51FD;&#x6570;&#x7684;&#x533A;&#x522B;</span></h3>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x4EE5;&#x9636;&#x4E58;&#x51FD;&#x6570;&#x7684;&#x5FAA;&#x73AF;&#x5199;&#x6CD5;&#x4E3A;&#x4F8B;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fact_iter</span>(<span class="params">n</span>):</span><br><span class="line">        total, k = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> k &lt;= n:</span><br><span class="line">            total, k = total * k, k + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> total</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x4ECE;&#x4E24;&#x4E2A;&#x89D2;&#x5EA6;&#x770B;&#x5F85;&#x5B83;&#x4EEC;&#x7684;&#x533A;&#x522B;&#xFF1A;</p>
<h4><span id="a&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;">&#x2003;&#x2003;<span class="math inline">\(a.\)</span>&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#xFF1A;</span></h4>
<p>&#x2003;&#x2003;&#x9636;&#x4E58;&#x7684;&#x5FAA;&#x73AF;&#x5199;&#x6CD5;&#x662F;&#x901A;&#x8FC7;&#x9010;&#x9879;&#x76F8;&#x4E58;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x800C;&#x9636;&#x4E58;&#x7684;&#x9012;&#x5F52;&#x5199;&#x6CD5;&#x662F;&#x901A;&#x8FC7;&#x5F53;&#x524D;&#x9879;<span class="math inline">\(fact(n)\)</span>&#x4E0E;&#x524D;&#x4E00;&#x9879;<span class="math inline">\(fact(n-1)\)</span>&#x7684;&#x5173;&#x7CFB;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p>
<h4><span id="b&#x8C03;&#x7528;&#x53C2;&#x6570;">&#x2003;&#x2003;<span class="math inline">\(b.\)</span>&#x8C03;&#x7528;&#x53C2;&#x6570;</span></h4>
<p>&#x2003;&#x2003;&#x9636;&#x4E58;&#x7684;&#x5FAA;&#x73AF;&#x5199;&#x6CD5;&#x9700;&#x8981;&#x8C03;&#x7528;&#x4E24;&#x4E2A;&#x989D;&#x5916;&#x53C2;&#x6570;<span class="math inline">\(total,k\)</span>&#xFF0C;&#x800C;&#x9012;&#x5F52;&#x5219;&#x6CA1;&#x6709;&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x3002;&#x5728;&#x9012;&#x5F52;&#x4E2D;&#xFF0C;<span class="math inline">\(fact(n)\)</span>&#x672C;&#x8EAB;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x53CA;&#x76F8;&#x5F53;&#x4E8E;&#x5FAA;&#x73AF;&#x4E2D;&#x7684;<span class="math inline">\(total\)</span>&#xFF0C;&#x800C;<span class="math inline">\(n\)</span>&#x5219;&#x7528;&#x6765;&#x9690;&#x5F0F;&#x5730;&#x8DDF;&#x8E2A;<span class="math inline">\(n!\)</span>&#x8BA1;&#x7B97;&#x5230;&#x54EA;&#x4E00;&#x6B65;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x5FAA;&#x73AF;&#x4E2D;&#x7684;<span class="math inline">\(k\)</span>&#x3002;</p>
<h2><span id="&#x4E8C;-&#x76F8;&#x4E92;&#x9012;&#x5F52;&#x8C03;&#x7528;">&#x4E8C;&#x3001;&#x76F8;&#x4E92;&#x9012;&#x5F52;&#x8C03;&#x7528;</span></h2>
<h3><span id="1&#x6982;&#x5FF5;">1.&#x6982;&#x5FF5;</span></h3>
<p>&#x2003;&#x2003;&#x5F53;&#x4E00;&#x4E2A;&#x9012;&#x5F52;&#x8FC7;&#x7A0B;&#x5206;&#x4E3A;<strong>&#x4E24;&#x4E2A;&#x76F8;&#x4E92;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;</strong>&#x65F6;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x88AB;&#x79F0;&#x4E3A;&#x76F8;&#x4E92;&#x9012;&#x5F52;&#x7684;&#x3002;</p>
<p>&#x2003;&#x2003;&#x5BF9;&#x4E8E;<strong>&#x591A;&#x4E3B;&#x4F53;</strong>&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5229;&#x7528;&#x76F8;&#x4E92;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5F88;&#x5B8C;&#x7F8E;&#x7684;&#x89E3;&#x51B3;&#x3002;</p>
<h3><span id="2&#x5B9E;&#x4F8B;&#x8BB2;&#x89E3;">2.&#x5B9E;&#x4F8B;&#x8BB2;&#x89E3;</span></h3>
<p>&#x2003;&#x2003;<span class="math inline">\(e.g.1.\)</span>&#x8003;&#x8651;&#x5982;&#x4E0B;&#x6240;&#x8FF0;&#x5BF9;&#x4E8E;&#x5947;&#x5076;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p>
<ul>
<li><span class="math inline">\(0\)</span>&#x4E3A;&#x5076;&#x6570;</li>
<li>&#x82E5;<span class="math inline">\(n-1\)</span>&#x4E3A;&#x5076;&#x6570;&#xFF0C;&#x5219;<span class="math inline">\(n\)</span>&#x4E3A;&#x5947;&#x6570;</li>
<li>&#x82E5;<span class="math inline">\(n-1\)</span>&#x4E3A;&#x5947;&#x6570;&#xFF0C;&#x5219;<span class="math inline">\(n\)</span>&#x4E3A;&#x5076;&#x6570; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_even</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> is_odd(n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_odd</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> is_even(n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>&#x2003;&#x2003;<span class="math inline">\(p.s.\)</span>&#x901A;&#x8FC7;<strong>&#x6253;&#x7834;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x4E4B;&#x95F4;&#x7684;&#x62BD;&#x8C61;&#x8FB9;&#x754C;</strong>&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x76F8;&#x4E92;&#x9012;&#x5F52;&#x7684;&#x51FD;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x5355;&#x4E2A;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x3002;&#x5982;&#x4E0A;&#x8FF0;&#x51FD;&#x6570;&#x53EF;&#x5982;&#x4E0B;&#x6539;&#x5199;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_even</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> (n-<span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> is_even((n-<span class="number">1</span>)-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;<span class="math inline">\(e.g.2.\)</span>&#x8003;&#x8651;&#x4E00;&#x4E2A;&#x4E24;&#x4EBA;&#x535A;&#x5F08;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x535A;&#x5F08;&#x4E2D;&#xFF0C;&#x4E00;&#x5F20;&#x684C;&#x5B50;&#x4E0A;&#x6709;
<span class="math inline">\(n\)</span>&#x4E2A;&#x521D;&#x59CB;&#x5375;&#x77F3;&#x3002;&#x73A9;&#x5BB6;&#x8F6E;&#x6D41;&#x4ECE;&#x684C;&#x5B50;&#x4E0A;&#x79FB;&#x8D70;&#x4E00;&#x4E2A;&#x6216;&#x4E24;&#x4E2A;&#x9E45;&#x5375;&#x77F3;&#xFF0C;&#x79FB;&#x8D70;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x9E45;&#x5375;&#x77F3;&#x7684;&#x73A9;&#x5BB6;&#x83B7;&#x80DC;&#x3002;&#x5047;&#x8BBE;&#x7231;&#x4E3D;&#x4E1D;&#x548C;&#x9C8D;&#x52C3;&#x73A9;&#x8FD9;&#x4E2A;&#x6E38;&#x620F;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EBA;&#x90FD;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7B56;&#x7565;:</p>
<ul>
<li>&#x7231;&#x4E3D;&#x4E1D;&#x603B;&#x662F;&#x62FF;&#x8D70;&#x4E00;&#x5757;&#x9E45;&#x5375;&#x77F3;</li>
<li>&#x5982;&#x679C;&#x684C;&#x5B50;&#x4E0A;&#x7684;&#x9E45;&#x5375;&#x77F3;&#x6570;&#x91CF;&#x662F;&#x5076;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x9C8D;&#x52C3;&#x5C31;&#x4F1A;&#x79FB;&#x9664;&#x4E24;&#x4E2A;&#x9E45;&#x5375;&#x77F3;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;&#x5076;&#x6570;</li>
</ul>
<p>&#x2003;&#x2003;&#x7ED9;&#x5B9A;<span class="math inline">\(n\)</span>&#x4E2A;&#x6700;&#x521D;&#x7684;&#x5375;&#x77F3;&#x548C;&#x7231;&#x4E3D;&#x4E1D;&#x5F00;&#x59CB;&#xFF0C;&#x8C01;&#x8D62;&#x5F97;&#x4E86;&#x6BD4;&#x8D5B;&#xFF1F;</p>
<p>&#x2003;&#x2003;<span class="math inline">\(solve\)</span>&#xFF1A;&#x8FD9;&#x91CC;&#x7231;&#x4E3D;&#x4E1D;&#x4E0E;&#x9C8D;&#x52C3;&#x662F;&#x4E0D;&#x540C;&#x4E3B;&#x4F53;&#xFF0C;&#x5206;&#x8BBE;&#x4E3A;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x5373;&#x53EF;&#xFF1A;
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">alice</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Bob wins&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> bob(n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bob</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Alice wins&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> alice(n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<h2><span id="&#x4E09;-&#x6811;&#x5F62;&#x9012;&#x5F52;">&#x4E09;&#x3001;&#x6811;&#x5F62;&#x9012;&#x5F52;</span></h2>
<h3><span id="1&#x6811;&#x5F62;&#x9012;&#x5F52;&#x7684;&#x6982;&#x5FF5;">1.&#x6811;&#x5F62;&#x9012;&#x5F52;&#x7684;&#x6982;&#x5FF5;</span></h3>
<p>&#x2003;&#x2003;&#x6811;&#x5F62;&#x9012;&#x5F52;&#x662F;&#x4E00;&#x79CD;&#x5E38;&#x7528;&#x7684;&#x9012;&#x5F52;&#xFF0C;&#x5728;&#x6811;&#x5F62;&#x9012;&#x5F52;&#x4E2D;&#xFF0C;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x4E0D;&#x6B62;&#x4E00;&#x6B21;&#x3002;</p>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x4EE5;&#x6590;&#x6CE2;&#x90A3;&#x5951;&#x6570;&#x5217;&#x7684;&#x9012;&#x5F52;&#x6C42;&#x89E3;&#x4E3A;&#x4F8B;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">n</span>):</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">	    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">2</span>:</span><br><span class="line">	    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> fib(n-<span class="number">2</span>) + fib(n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x2003;&#x2003;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x9012;&#x5F52;&#x7684;&#x5199;&#x6CD5;&#x4E0E;&#x6590;&#x6CE2;&#x90A3;&#x5951;&#x7684;&#x5B9A;&#x4E49;<span class="math inline">\(Fib_n=Fib_{n-1}+Fib_{n-2}\)</span>&#x662F;&#x5B8C;&#x5168;&#x5951;&#x5408;&#x7684;&#x3002;</p>
<h3><span id="2&#x5B9E;&#x4F8B;&#x8BB2;&#x89E3;">2.&#x5B9E;&#x4F8B;&#x8BB2;&#x89E3;</span></h3>
<p>&#x2003;&#x2003;<span class="math inline">\(e.g.1.\)</span>&#x5C06;<span class="math inline">\(n\)</span>&#x5206;&#x89E3;&#x4E3A;&#x67D0;&#x4E2A;&#x5355;&#x8C03;&#x9012;&#x589E;&#x7684;&#x5E8F;&#x5217;&#xFF0C;&#x4E14;&#x5E8F;&#x5217;&#x4E2D;&#x6570;&#x7684;&#x6700;&#x5927;&#x503C;&#x4E0D;&#x8D85;&#x8FC7;<span class="math inline">\(m\)</span>&#x3002;&#x7ED9;&#x51FA;<span class="math inline">\(n,m\)</span>&#xFF0C;&#x6C42;&#x51FA;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x5E8F;&#x5217;&#x7684;&#x6570;&#x91CF;&#x3002;</p>
<p>&#x2003;&#x2003;<span class="math inline">\(solve\)</span>&#xFF1A;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x4E0B;&#x9762;&#x4E24;&#x4EF6;&#x4E8B;&#xFF1A;</p>
<ol type="1">
<li><p>&#x5206;&#x7EC4;&#x65B9;&#x6CD5;&#xFF1A;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x4E0D;&#x91CD;&#x4E0D;&#x6F0F;&#xFF0C;&#x6211;&#x4EEC;&#x4ECE;&#x5E8F;&#x5217;&#x4E2D;&#x6700;&#x5927;&#x503C;<span class="math inline">\(m\)</span>&#x5165;&#x624B;&#xFF0C;&#x53EF;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x60C5;&#x51B5;&#xFF1A;</p>
<ul>
<li>&#x9009;&#x4E00;&#x4E2A;<span class="math inline">\(m\)</span>&#xFF0C;&#x7136;&#x540E;&#x5BF9;<span class="math inline">\(n-m\)</span>&#x6267;&#x884C;&#x76F8;&#x540C;&#x64CD;&#x4F5C;</li>
<li>&#x4E0D;&#x9009;<span class="math inline">\(m\)</span>&#xFF0C;&#x6B64;&#x65F6;&#x5E8F;&#x5217;&#x4E2D;&#x6700;&#x5927;&#x503C;&#x53D8;&#x4E3A;<span class="math inline">\(m-1\)</span>&#xFF0C;&#x7136;&#x540E;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x76F8;&#x540C;&#x64CD;&#x4F5C;</li>
</ul></li>
<li><p>&#x57FA;&#x672C;&#x60C5;&#x51B5;&#xFF1A;</p>
<ul>
<li><code>n==0</code>&#xFF1A;<span class="math inline">\(return
1\)</span></li>
<li><code>n&lt;0</code>&#xFF1A;<span class="math inline">\(return
0\)</span></li>
<li><code>m==0</code>&#xFF1A;<span class="math inline">\(return
0\)</span></li>
</ul></li>
</ol>
<p>&#x2003;&#x2003;&#x4E8E;&#x662F;&#x53EF;&#x5199;&#x51FA;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A; <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">n,m</span>):</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n&lt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> m==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> div(n-m,m)+div(n,m-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
&#x2003;&#x2003;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;&#x4E00;&#x4E2A;&#x6811;&#x5F62;&#x9012;&#x5F52;&#x51FD;&#x6570;&#x770B;&#x4F5C;&#x662F;&#x5728;<strong>&#x63A2;&#x7D22;&#x4E0D;&#x540C;&#x7684;&#x53EF;&#x80FD;&#x6027;</strong>&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x63A2;&#x7D22;&#x4E86;&#x4F7F;&#x7528;<span class="math inline">\(m\)</span>&#x7684;&#x53EF;&#x80FD;&#x6027;&#x4EE5;&#x53CA;&#x4E0D;&#x4F7F;&#x7528;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x548C;&#x7B2C;&#x4E8C;&#x4E2A;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x4E8E;&#x8FD9;&#x4E9B;&#x53EF;&#x80FD;&#x6027;&#x3002;</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang>
    <link itemprop="mainEntityOfPage" href="https://fyerfyer.github.io.com/2024/05/31/10.1.Binary%20Search%20Trees/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="fyerfyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fyerfyer">
      <meta itemprop="description" content="fyerfyer&apos;s blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | fyerfyer">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/31/10.1.Binary%20Search%20Trees/" class="post-title-link" itemprop="url">10.1.&#x4E8C;&#x53C9;&#x641C;&#x7D22;&#x6811;</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">&#x53D1;&#x8868;&#x4E8E;</span>

      <time title="&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#xFF1A;2024-05-31 17:48:59" itemprop="dateCreated datePublished" datetime="2024-05-31T17:48:59+08:00">2024-05-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">&#x66F4;&#x65B0;&#x4E8E;</span>
      <time title="&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;2024-06-02 18:06:20" itemprop="dateModified" datetime="2024-06-02T18:06:20+08:00">2024-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">&#x5206;&#x7C7B;&#x4E8E;</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61B-DataStructure/" itemprop="url" rel="index"><span itemprop="name">CS61B DataStructure</span></a>
        </span>
          &#xFF0C;
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CS61B-DataStructure/10-Trees/" itemprop="url" rel="index"><span itemprop="name">10.Trees</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="&#x672C;&#x6587;&#x5B57;&#x6570;">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">&#x672C;&#x6587;&#x5B57;&#x6570;&#xFF1A;</span>
      <span>670</span>
    </span>
    <span class="post-meta-item" title="&#x9605;&#x8BFB;&#x65F6;&#x957F;">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
      <span>2 &#x5206;&#x949F;</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1><span id="101&#x4E8C;&#x53C9;&#x641C;&#x7D22;&#x6811;"><span class="math inline">\(10.1\)</span>&#x4E8C;&#x53C9;&#x641C;&#x7D22;&#x6811;</span></h1>
<h3><span id="1bst&#x76F8;&#x5173;&#x6982;&#x5FF5;">1.<span class="math inline">\(BST\)</span>&#x76F8;&#x5173;&#x6982;&#x5FF5;</span></h3>
<ul>
<li>The tree is made up of <span class="math inline">\(nodes\)</span>
that contain <span class="math inline">\(links\)</span> that are either
<span class="math inline">\(null\)</span> or references to other
nodes.</li>
<li>Every node is pointed to by just one other node, which is called its
<span class="math inline">\(parent\)</span> (except for one node, the
<span class="math inline">\(root\)</span>, which has no nodes pointing
to it).</li>
<li>Each node has exactly two links, which are called its <span class="math inline">\(left\)</span> and <span class="math inline">\(right\)</span> links, that point to nodes called
its <span class="math inline">\(left child\)</span> and <span class="math inline">\(right child\)</span>.</li>
<li>we can define a binary tree as a either a null link or a node with a
left link and a right link, each references to (disjoint) subtrees that
are themselves <span class="math inline">\(binary trees\)</span>. In a
binary search tree, each node also has a key and a value, with an
ordering restriction to support efficient search</li>
</ul>
<p><img src="/2024/05/31/10.1.Binary%20Search%20Trees/image.png"></p>
<p>&#x2003;&#x2003;<span class="math inline">\(BST\)</span>&#x4E5F;&#x9075;&#x5FAA;&#x5982;&#x4E0B;&#x7684;&#x6027;&#x8D28;&#xFF1A;</p>
<p><img src="/2024/05/31/10.1.Binary%20Search%20Trees/image-1.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">BST</span>&lt;Key&gt; {</span><br><span class="line">    <span class="keyword">private</span> Key key;</span><br><span class="line">    <span class="keyword">private</span> BST left;</span><br><span class="line">    <span class="keyword">private</span> BST right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BST</span><span class="params">(Key key, BST lf, BST rt)</span> {</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">        <span class="built_in">this</span>.left = lf;</span><br><span class="line">        <span class="built_in">this</span>.right = rt;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BST</span><span class="params">(Key key)</span> {</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3><span id="2bst&#x64CD;&#x4F5C;">2.<span class="math inline">\(BST\)</span>&#x64CD;&#x4F5C;</span></h3>
<h4><span id="afind">&#x2003;&#x2003;<span class="math inline">\(a.\)</span><code>find</code></span></h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> BST <span class="title function_">find</span><span class="params">(BST T, Key sk)</span> {</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (sk.equals(T.key)) {</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (sk &lt; T.key) {</span><br><span class="line">        <span class="keyword">return</span> find(T.left, sk);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> find(T.right, sk);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4><span id="binsert">&#x2003;&#x2003;<span class="math inline">\(b.\)</span><code>insert</code></span></h4>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x6C38;&#x8FDC;&#x53EA;&#x63D2;&#x5165;&#x5DE6;&#x8282;&#x70B9;&#xFF01; <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> BST <span class="title function_">insert</span><span class="params">(BST T, Key sk)</span> {</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BST</span>(sk);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (sk &lt; T.key) {</span><br><span class="line">        T.left = insert(T.left, sk);</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (sk &gt; T.key) {</span><br><span class="line">        T.right = insert(T.right, sk);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4><span id="cdelete">&#x2003;&#x2003;<span class="math inline">\(c.\)</span><code>delete</code></span></h4>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x66FF;&#x4EE3;&#x4E3A;&#x5B83;&#x7684;&#x540E;&#x7EE7;&#x8282;&#x70B9;&#xFF0C;&#x6765;&#x5B9E;&#x73B0;&#x8BE5;&#x8282;&#x70B9;&#x7684;&#x5220;&#x9664;&#x3002;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x540E;&#x7EE7;&#x8282;&#x70B9;(<span class="math inline">\(successor\)</span>)&#x662F;&#x5B83;&#x53F3;&#x5B50;&#x6811;&#x7684;&#x6700;&#x5C0F;&#x8282;&#x70B9;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x6B65;&#x9AA4;&#x5B9E;&#x73B0;<code>delete</code>&#xFF1A;</p>
<ol type="1">
<li>&#x4FDD;&#x5B58;&#x5F85;&#x5220;&#x9664;&#x8282;&#x70B9;(<span class="math inline">\(x\)</span>)&#x7684;&#x94FE;&#x63A5;(<span class="math inline">\(link\)</span>)&#x3002;</li>
<li>&#x8BA9;<span class="math inline">\(x\)</span>&#x6307;&#x5411;&#x540E;&#x7EE7;&#x8282;&#x70B9;(<span class="math inline">\(y\)</span>)&#x3002;</li>
<li>&#x5C06;<span class="math inline">\(x\)</span>&#x7684;&#x53F3;&#x94FE;&#x63A5;&#x6307;&#x5411;<code>deleteMin(t.right)</code>&#xFF0C;&#x5176;&#x4E2D;<code>deleteMin</code>&#x4F1A;&#x8FD4;&#x56DE;&#x6307;&#x5411;&#x53F3;&#x5B50;&#x6811;&#x7684;&#x94FE;&#x63A5;&#xFF0C;&#x800C;&#x53F3;&#x5B50;&#x6811;&#x4E2D;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x5927;&#x4E8E;(<span class="math inline">\(x\)</span>)&#x3002;</li>
<li>&#x8BA9;&#x540E;&#x7EE7;&#x8282;&#x70B9;&#x7684;&#x5DE6;&#x94FE;&#x63A5;&#x6307;&#x5411;<span class="math inline">\(x\)</span>&#x7684;&#x5DE6;&#x5B50;&#x6811;&#x3002;</li>
</ol>
<p>&#x2003;&#x2003;&#x4E0B;&#x9762;&#x662F;&#x8BE5;&#x8FC7;&#x7A0B;&#x7684;&#x56FE;&#x793A;&#xFF1A;</p>
<p><img src="/2024/05/31/10.1.Binary%20Search%20Trees/image-2.png"></p>
<p>&#x2003;&#x2003;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x5206;&#x90E8;&#x5B9E;&#x73B0;<code>delete</code>&#x64CD;&#x4F5C;&#x3002;</p>
<h5><span id="ideletemin">&#x2003;&#x2003;<span class="math inline">\(i.\)</span><code>deleteMin</code></span></h5>
<p>&#x2003;&#x2003;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5982;&#x4E0B;&#x65B9;&#x5F0F;&#x9012;&#x5F52;&#x5B9E;&#x73B0;<code>deleteMin</code>&#xFF1A;</p>
<ol type="1">
<li>&#x627E;&#x5230;&#x6700;&#x5C0F;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x5B83;&#x7684;&#x7236;&#x4EB2;&#x7684;&#x53F3;&#x513F;&#x5B50;(&#x628A;&#x6307;&#x5411;&#x5B83;&#x7684;&#x94FE;&#x63A5;&#x7ED9;&#x5FFD;&#x7565;&#x6389;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x5220;&#x6389;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x4E86;)&#x3002;</li>
<li>&#x628A;&#x7236;&#x8282;&#x70B9;&#x7684;&#x5DE6;&#x94FE;&#x63A5;&#x6307;&#x5411;&#x8FD4;&#x56DE;&#x7684;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x66F4;&#x65B0;&#x5B50;&#x6811;&#x7684;&#x5927;&#x5C0F;&#x3002; <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteMin</span><span class="params">()</span> {</span><br><span class="line">    root = deleteMin(root);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">deleteMin</span><span class="params">(Node p)</span> {</span><br><span class="line">    <span class="keyword">if</span> (p.left == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">return</span> p.right;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    p.left = deleteMin(p.left);</span><br><span class="line">    p.size = p.left.size + p.right.size + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></li>
</ol>
<h5><span id="ii&#x6700;&#x5C0F;&#x8282;&#x70B9;">&#x2003;&#x2003;<span class="math inline">\(ii.\)</span>&#x6700;&#x5C0F;&#x8282;&#x70B9;</span></h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Node <span class="title function_">min</span><span class="params">(Node p)</span> {</span><br><span class="line">    <span class="keyword">if</span> (p.left == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> min(p.left);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h5><span id="iiidelete&#x64CD;&#x4F5C;">&#x2003;&#x2003;<span class="math inline">\(iii\)</span><code>delete</code>&#x64CD;&#x4F5C;</span></h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Key key)</span> {</span><br><span class="line">    root = delete(root, key);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Node <span class="title function_">delete</span><span class="params">(Node p, Key key)</span> {</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> key.compareTo(p.key);</span><br><span class="line">    <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>) {</span><br><span class="line">        p.right = delete(p.right, key);</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>) {</span><br><span class="line">        p.left = delete(p.left, key);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="comment">// solve the one-node condition.</span></span><br><span class="line">        <span class="keyword">if</span> (p.right == <span class="literal">null</span>) <span class="keyword">return</span> p.left;</span><br><span class="line">        <span class="keyword">if</span> (p.left == <span class="literal">null</span>) <span class="keyword">return</span> p.right;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//store the to-delete node, so that we can connect its subtree.</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">t</span> <span class="operator">=</span> p;</span><br><span class="line">        p = min(t.right);</span><br><span class="line">        p.right = deleteMin(t.right);</span><br><span class="line">        p.left = t.left;</span><br><span class="line">    }</span><br><span class="line">    p.size = p.left.size + p.right.size + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&#x2026;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" title="&#x4E0B;&#x4E00;&#x9875;" aria-label="&#x4E0B;&#x4E00;&#x9875;" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">



  <div class="copyright">
    &#xA9; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">fyerfyer</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>&#x7AD9;&#x70B9;&#x603B;&#x5B57;&#x6570;&#xFF1A;</span>
    <span title="&#x7AD9;&#x70B9;&#x603B;&#x5B57;&#x6570;">93k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>&#x7AD9;&#x70B9;&#x9605;&#x8BFB;&#x65F6;&#x957F; &#x2248;</span>
    <span title="&#x7AD9;&#x70B9;&#x9605;&#x8BFB;&#x65F6;&#x957F;">5:39</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="&#x603B;&#x8BBF;&#x5BA2;&#x91CF;">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="&#x603B;&#x8BBF;&#x95EE;&#x91CF;">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">&#x7531; <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> &amp; <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> &#x5F3A;&#x529B;&#x9A71;&#x52A8;
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
